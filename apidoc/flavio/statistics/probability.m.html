<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>flavio.statistics.probability API documentation</title>
    <meta name="description" content="Probability distributions and auxiliary functions to deal with them." />

  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Noto+Sans:400' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/public/plugins/katex/katex.min.css">
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

    .katex {
      font-size:1em;
    }
    .katex .mathit, .katex .mathrm {
      font-family: 'Noto Sans';
    }
  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Noto Sans", "Helvetica Neue", Helvetica, sans;
    font-weight: 400;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  }

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; }

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;

      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  pre { line-height: 125%; margin: 0; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
.codehilite .hll { background-color: #ffffcc }
.codehilite { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
    <script src="/public/plugins/katex/katex.min.js"></script>
    <script src="/public/plugins/katex/auto-render.min.js"></script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">
    <li class="set"><h3><a href="#header-variables">Module variables</a></h3>
      
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.class_from_string">class_from_string</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>
      
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.combine_distributions">combine_distributions</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.convolve_distributions">convolve_distributions</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.dict2dist">dict2dist</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.string_to_class">string_to_class</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.weighted_average">weighted_average</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#flavio.statistics.probability.AsymmetricNormalDistribution">AsymmetricNormalDistribution</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.AsymmetricNormalDistribution.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.AsymmetricNormalDistribution.delta_logpdf">delta_logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.AsymmetricNormalDistribution.get_central">get_central</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.AsymmetricNormalDistribution.get_dict">get_dict</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.AsymmetricNormalDistribution.get_error_left">get_error_left</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.AsymmetricNormalDistribution.get_error_right">get_error_right</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.AsymmetricNormalDistribution.get_random">get_random</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.AsymmetricNormalDistribution.get_yaml">get_yaml</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.AsymmetricNormalDistribution.logpdf">logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.AsymmetricNormalDistribution.class_to_string">class_to_string</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.AsymmetricNormalDistribution.get_subclasses">get_subclasses</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#flavio.statistics.probability.DeltaDistribution">DeltaDistribution</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.DeltaDistribution.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.DeltaDistribution.delta_logpdf">delta_logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.DeltaDistribution.get_central">get_central</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.DeltaDistribution.get_dict">get_dict</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.DeltaDistribution.get_error_left">get_error_left</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.DeltaDistribution.get_error_right">get_error_right</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.DeltaDistribution.get_random">get_random</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.DeltaDistribution.get_yaml">get_yaml</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.DeltaDistribution.logpdf">logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.DeltaDistribution.class_to_string">class_to_string</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.DeltaDistribution.get_subclasses">get_subclasses</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#flavio.statistics.probability.GammaDistribution">GammaDistribution</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistribution.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistribution.cdf">cdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistribution.delta_logpdf">delta_logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistribution.get_central">get_central</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistribution.get_dict">get_dict</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistribution.get_error_left">get_error_left</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistribution.get_error_right">get_error_right</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistribution.get_random">get_random</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistribution.get_yaml">get_yaml</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistribution.logpdf">logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistribution.ppf">ppf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistribution.class_to_string">class_to_string</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistribution.get_subclasses">get_subclasses</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#flavio.statistics.probability.GammaDistributionPositive">GammaDistributionPositive</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistributionPositive.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistributionPositive.cdf">cdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistributionPositive.delta_logpdf">delta_logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistributionPositive.get_central">get_central</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistributionPositive.get_dict">get_dict</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistributionPositive.get_error_left">get_error_left</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistributionPositive.get_error_right">get_error_right</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistributionPositive.get_random">get_random</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistributionPositive.get_yaml">get_yaml</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistributionPositive.logpdf">logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistributionPositive.ppf">ppf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistributionPositive.class_to_string">class_to_string</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaDistributionPositive.get_subclasses">get_subclasses</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#flavio.statistics.probability.GammaUpperLimit">GammaUpperLimit</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.GammaUpperLimit.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaUpperLimit.cdf">cdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaUpperLimit.delta_logpdf">delta_logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaUpperLimit.get_central">get_central</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaUpperLimit.get_dict">get_dict</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaUpperLimit.get_error_left">get_error_left</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaUpperLimit.get_error_right">get_error_right</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaUpperLimit.get_random">get_random</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaUpperLimit.get_yaml">get_yaml</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaUpperLimit.logpdf">logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaUpperLimit.ppf">ppf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaUpperLimit.class_to_string">class_to_string</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GammaUpperLimit.get_subclasses">get_subclasses</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#flavio.statistics.probability.GaussianKDE">GaussianKDE</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianKDE.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianKDE.cdf">cdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianKDE.delta_logpdf">delta_logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianKDE.get_central">get_central</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianKDE.get_dict">get_dict</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianKDE.get_error_left">get_error_left</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianKDE.get_error_right">get_error_right</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianKDE.get_random">get_random</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianKDE.get_yaml">get_yaml</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianKDE.logpdf">logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianKDE.pdf">pdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianKDE.ppf">ppf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianKDE.class_to_string">class_to_string</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianKDE.from_pd">from_pd</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianKDE.get_subclasses">get_subclasses</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#flavio.statistics.probability.GaussianUpperLimit">GaussianUpperLimit</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianUpperLimit.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianUpperLimit.cdf">cdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianUpperLimit.delta_logpdf">delta_logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianUpperLimit.get_central">get_central</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianUpperLimit.get_dict">get_dict</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianUpperLimit.get_error_left">get_error_left</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianUpperLimit.get_error_right">get_error_right</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianUpperLimit.get_random">get_random</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianUpperLimit.get_standard_deviation">get_standard_deviation</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianUpperLimit.get_yaml">get_yaml</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianUpperLimit.logpdf">logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianUpperLimit.ppf">ppf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianUpperLimit.class_to_string">class_to_string</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GaussianUpperLimit.get_subclasses">get_subclasses</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#flavio.statistics.probability.GeneralGammaDistributionPositive">GeneralGammaDistributionPositive</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaDistributionPositive.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaDistributionPositive.cdf">cdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaDistributionPositive.delta_logpdf">delta_logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaDistributionPositive.get_central">get_central</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaDistributionPositive.get_dict">get_dict</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaDistributionPositive.get_error_left">get_error_left</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaDistributionPositive.get_error_right">get_error_right</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaDistributionPositive.get_random">get_random</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaDistributionPositive.get_yaml">get_yaml</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaDistributionPositive.logpdf">logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaDistributionPositive.pdf">pdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaDistributionPositive.ppf">ppf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaDistributionPositive.class_to_string">class_to_string</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaDistributionPositive.from_pd">from_pd</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaDistributionPositive.get_subclasses">get_subclasses</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#flavio.statistics.probability.GeneralGammaUpperLimit">GeneralGammaUpperLimit</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaUpperLimit.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaUpperLimit.cdf">cdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaUpperLimit.delta_logpdf">delta_logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaUpperLimit.get_central">get_central</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaUpperLimit.get_dict">get_dict</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaUpperLimit.get_error_left">get_error_left</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaUpperLimit.get_error_right">get_error_right</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaUpperLimit.get_random">get_random</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaUpperLimit.get_yaml">get_yaml</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaUpperLimit.logpdf">logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaUpperLimit.pdf">pdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaUpperLimit.ppf">ppf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaUpperLimit.class_to_string">class_to_string</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaUpperLimit.from_pd">from_pd</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.GeneralGammaUpperLimit.get_subclasses">get_subclasses</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#flavio.statistics.probability.HalfNormalDistribution">HalfNormalDistribution</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.HalfNormalDistribution.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.HalfNormalDistribution.cdf">cdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.HalfNormalDistribution.delta_logpdf">delta_logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.HalfNormalDistribution.get_central">get_central</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.HalfNormalDistribution.get_dict">get_dict</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.HalfNormalDistribution.get_error_left">get_error_left</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.HalfNormalDistribution.get_error_right">get_error_right</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.HalfNormalDistribution.get_random">get_random</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.HalfNormalDistribution.get_yaml">get_yaml</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.HalfNormalDistribution.logpdf">logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.HalfNormalDistribution.ppf">ppf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.HalfNormalDistribution.class_to_string">class_to_string</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.HalfNormalDistribution.get_subclasses">get_subclasses</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#flavio.statistics.probability.KernelDensityEstimate">KernelDensityEstimate</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.KernelDensityEstimate.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.KernelDensityEstimate.cdf">cdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.KernelDensityEstimate.delta_logpdf">delta_logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.KernelDensityEstimate.get_central">get_central</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.KernelDensityEstimate.get_dict">get_dict</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.KernelDensityEstimate.get_error_left">get_error_left</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.KernelDensityEstimate.get_error_right">get_error_right</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.KernelDensityEstimate.get_random">get_random</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.KernelDensityEstimate.get_yaml">get_yaml</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.KernelDensityEstimate.logpdf">logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.KernelDensityEstimate.pdf">pdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.KernelDensityEstimate.ppf">ppf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.KernelDensityEstimate.class_to_string">class_to_string</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.KernelDensityEstimate.from_pd">from_pd</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.KernelDensityEstimate.get_subclasses">get_subclasses</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#flavio.statistics.probability.LogNormalDistribution">LogNormalDistribution</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.LogNormalDistribution.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.LogNormalDistribution.cdf">cdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.LogNormalDistribution.delta_logpdf">delta_logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.LogNormalDistribution.get_central">get_central</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.LogNormalDistribution.get_dict">get_dict</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.LogNormalDistribution.get_error_left">get_error_left</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.LogNormalDistribution.get_error_right">get_error_right</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.LogNormalDistribution.get_random">get_random</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.LogNormalDistribution.get_yaml">get_yaml</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.LogNormalDistribution.logpdf">logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.LogNormalDistribution.pdf">pdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.LogNormalDistribution.ppf">ppf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.LogNormalDistribution.class_to_string">class_to_string</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.LogNormalDistribution.get_subclasses">get_subclasses</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#flavio.statistics.probability.MultivariateNormalDistribution">MultivariateNormalDistribution</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNormalDistribution.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNormalDistribution.delta_logpdf">delta_logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNormalDistribution.get_central">get_central</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNormalDistribution.get_dict">get_dict</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNormalDistribution.get_error_left">get_error_left</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNormalDistribution.get_error_right">get_error_right</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNormalDistribution.get_random">get_random</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNormalDistribution.get_yaml">get_yaml</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNormalDistribution.logpdf">logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNormalDistribution.reduce_dimension">reduce_dimension</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNormalDistribution.class_to_string">class_to_string</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNormalDistribution.get_subclasses">get_subclasses</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#flavio.statistics.probability.MultivariateNumericalDistribution">MultivariateNumericalDistribution</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNumericalDistribution.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNumericalDistribution.delta_logpdf">delta_logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNumericalDistribution.get_central">get_central</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNumericalDistribution.get_dict">get_dict</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNumericalDistribution.get_error_left">get_error_left</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNumericalDistribution.get_error_right">get_error_right</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNumericalDistribution.get_random">get_random</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNumericalDistribution.get_yaml">get_yaml</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNumericalDistribution.logpdf">logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNumericalDistribution.reduce_dimension">reduce_dimension</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNumericalDistribution.class_to_string">class_to_string</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNumericalDistribution.from_pd">from_pd</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.MultivariateNumericalDistribution.get_subclasses">get_subclasses</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#flavio.statistics.probability.NormalDistribution">NormalDistribution</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.NormalDistribution.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NormalDistribution.cdf">cdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NormalDistribution.delta_logpdf">delta_logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NormalDistribution.get_central">get_central</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NormalDistribution.get_dict">get_dict</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NormalDistribution.get_error_left">get_error_left</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NormalDistribution.get_error_right">get_error_right</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NormalDistribution.get_random">get_random</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NormalDistribution.get_yaml">get_yaml</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NormalDistribution.logpdf">logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NormalDistribution.pdf">pdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NormalDistribution.ppf">ppf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NormalDistribution.class_to_string">class_to_string</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NormalDistribution.get_subclasses">get_subclasses</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#flavio.statistics.probability.NumericalDistribution">NumericalDistribution</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.NumericalDistribution.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NumericalDistribution.cdf">cdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NumericalDistribution.delta_logpdf">delta_logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NumericalDistribution.get_central">get_central</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NumericalDistribution.get_dict">get_dict</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NumericalDistribution.get_error_left">get_error_left</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NumericalDistribution.get_error_right">get_error_right</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NumericalDistribution.get_random">get_random</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NumericalDistribution.get_yaml">get_yaml</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NumericalDistribution.logpdf">logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NumericalDistribution.pdf">pdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NumericalDistribution.ppf">ppf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NumericalDistribution.class_to_string">class_to_string</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NumericalDistribution.from_pd">from_pd</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.NumericalDistribution.get_subclasses">get_subclasses</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.ProbabilityDistribution.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.ProbabilityDistribution.delta_logpdf">delta_logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.ProbabilityDistribution.get_central">get_central</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.ProbabilityDistribution.get_dict">get_dict</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.ProbabilityDistribution.get_yaml">get_yaml</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.ProbabilityDistribution.class_to_string">class_to_string</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.ProbabilityDistribution.get_subclasses">get_subclasses</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#flavio.statistics.probability.UniformDistribution">UniformDistribution</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.statistics.probability.UniformDistribution.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.UniformDistribution.delta_logpdf">delta_logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.UniformDistribution.get_central">get_central</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.UniformDistribution.get_dict">get_dict</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.UniformDistribution.get_error_left">get_error_left</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.UniformDistribution.get_error_right">get_error_right</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.UniformDistribution.get_random">get_random</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.UniformDistribution.get_yaml">get_yaml</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.UniformDistribution.logpdf">logpdf</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.UniformDistribution.class_to_string">class_to_string</a></li>
    <li class="mono"><a href="#flavio.statistics.probability.UniformDistribution.get_subclasses">get_subclasses</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">flavio.statistics.probability</span> module</h1>
  <p>Probability distributions and auxiliary functions to deal with them.</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability" class="source">
    <div class="codehilite"><pre><span></span><span class="sd">&quot;&quot;&quot;Probability distributions and auxiliary functions to deal with them.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span><span class="p">,</span> <span class="n">RegularGridInterpolator</span>
<span class="kn">import</span> <span class="nn">scipy.signal</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">flavio.math.functions</span> <span class="kn">import</span> <span class="n">normal_logpdf</span><span class="p">,</span> <span class="n">normal_pdf</span>
<span class="kn">from</span> <span class="nn">flavio.statistics.functions</span> <span class="kn">import</span> <span class="n">confidence_level</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span> <span class="nn">yaml</span>
<span class="kn">import</span> <span class="nn">re</span>


<span class="k">def</span> <span class="nf">_camel_to_underscore</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;(.)([A-Z][a-z]+)&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\1_\2&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;([a-z0-9])([A-Z])&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\1_\2&#39;</span><span class="p">,</span> <span class="n">s1</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">string_to_class</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a ProbabilityDistribution subclass from a string. This can</span>
<span class="sd">    either be the class name itself or a string in underscore format</span>
<span class="sd">    as returned from `class_to_string`.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">eval</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ProbabilityDistribution</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span> <span class="o">==</span> <span class="n">string</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">c</span>
    <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;Distribution &quot;</span> <span class="o">+</span> <span class="n">string</span> <span class="o">+</span> <span class="s2">&quot; not found.&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ProbabilityDistribution</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Common base class for all probability distributions&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">support</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">=</span> <span class="n">central_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">support</span> <span class="o">=</span> <span class="n">support</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
            <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
            <span class="k">yield</span> <span class="n">subclass</span>

    <span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_error_left</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_error_right</span><span class="p">()</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>

<span class="sd">        This converts camel case to underscore and removes the word</span>
<span class="sd">        &#39;distribution&#39;.</span>

<span class="sd">        Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">        &#39;asymmetric_normal&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">        the instantiate the distribution.</span>

<span class="sd">        Optional arguments (default to False):</span>

<span class="sd">        - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">        value being the string representation of the distribution&#39;s name</span>
<span class="sd">        (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">        - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">        arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">        get_dict instead of the instance as value.</span>
<span class="sd">        - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
            <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
        <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">od</span>

    <span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">        get_dict method.</span>

<span class="sd">        Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
        <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
            <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">UniformDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Distribution with constant PDF in a range and zero otherwise.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">half_range</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - central_value: arithmetic mean of the upper and lower range boundaries</span>
<span class="sd">        - half_range: half the difference of upper and lower range boundaries</span>

<span class="sd">        Example:</span>

<span class="sd">        central_value = 5 and half_range = 3 leads to the range [2, 8].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">half_range</span> <span class="o">=</span> <span class="n">half_range</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">range</span> <span class="o">=</span> <span class="p">(</span><span class="n">central_value</span> <span class="o">-</span> <span class="n">half_range</span><span class="p">,</span>
                      <span class="n">central_value</span> <span class="o">+</span> <span class="n">half_range</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.UniformDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_range</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_range</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">_lpvect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_lpvect</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_range</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_range</span>



<span class="k">class</span> <span class="nc">DeltaDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Delta Distrubution that is non-vanishing only at a single point.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - central_value: point where the PDF does not vanish.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span> <span class="n">central_value</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.DeltaDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">0.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">y</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">y</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>


<span class="k">class</span> <span class="nc">NormalDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Univariate normal or Gaussian distribution.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">standard_deviation</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - central_value: location (mode and mean)</span>
<span class="sd">        - standard_deviation: standard deviation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span>
                         <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">central_value</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">standard_deviation</span><span class="p">,</span>
                                  <span class="n">central_value</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">standard_deviation</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">standard_deviation</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Standard deviation must be positive number&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">=</span> <span class="n">standard_deviation</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.NormalDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">normal_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">normal_pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span>


<span class="k">class</span> <span class="nc">LogNormalDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Univariate log-normal distribution.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - central_value: median of the distribution (neither mode nor mean!).</span>
<span class="sd">          Can be positive or negative, but must be nonzero.</span>
<span class="sd">        - factor: must be larger than 1. 68% of the probability will be between</span>
<span class="sd">          `central_value * factor` and `central_value / factor`.</span>

<span class="sd">        The mean and standard deviation of the underlying normal distribution</span>
<span class="sd">        correspond to `log(abs(central_value))` and `log(factor)`, respectively.</span>

<span class="sd">        Example:</span>

<span class="sd">        `LogNormalDistribution(central_value=3, factor=2)`</span>

<span class="sd">        corresponds to the distribution of the exponential of a normally</span>
<span class="sd">        distributed variable with mean ln(3) and standard deviation ln(2).</span>
<span class="sd">        68% of the probability is within 6=3*2 and 1.5=4/2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">central_value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Central value must not be zero&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">factor</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Factor must be bigger than 1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">=</span> <span class="n">factor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">central_value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">central_value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">slim</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">central_value</span><span class="p">))</span>
                            <span class="o">-</span> <span class="mi">6</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span>
                             <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">slim</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span> <span class="o">=</span> <span class="o">+</span><span class="mi">1</span>
            <span class="n">slim</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">central_value</span><span class="p">))</span>
                            <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span>
                             <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">slim</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.LogNormalDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span>
        <span class="k">return</span> <span class="n">s</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">s</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">s</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
        <span class="n">cl</span> <span class="o">=</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">cl</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
        <span class="n">cl</span> <span class="o">=</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">cl</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>


<span class="k">class</span> <span class="nc">AsymmetricNormalDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An asymmetric normal distribution obtained by gluing together two</span>
<span class="sd">    half-Gaussians and demanding the PDF to be continuous.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">right_deviation</span><span class="p">,</span> <span class="n">left_deviation</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - central_value: mode of the distribution (not equal to its mean!)</span>
<span class="sd">        - right_deviation: standard deviation of the upper half-Gaussian</span>
<span class="sd">        - left_deviation: standard deviation of the lower half-Gaussian</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span>
                         <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">central_value</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">left_deviation</span><span class="p">,</span>
                                  <span class="n">central_value</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">right_deviation</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">right_deviation</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">left_deviation</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Left and right standard deviations must be positive numbers&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_deviation</span> <span class="o">=</span> <span class="n">right_deviation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_deviation</span> <span class="o">=</span> <span class="n">left_deviation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_right</span> <span class="o">=</span> <span class="n">normal_pdf</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_deviation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_left</span> <span class="o">=</span> <span class="n">normal_pdf</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.AsymmetricNormalDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">right_deviation</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">left_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)])</span>

    <span class="k">def</span> <span class="nf">_get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">()</span>
        <span class="n">a</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left_deviation</span> <span class="o">/</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">right_deviation</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_deviation</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_deviation</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_deviation</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="n">x</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># values of the PDF at the central value</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">:</span>
            <span class="c1"># left-hand side: scale factor</span>
            <span class="n">r</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_right</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_left</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_right</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">+</span> <span class="n">normal_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_deviation</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># left-hand side: scale factor</span>
            <span class="n">r</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_left</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_left</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_right</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">+</span> <span class="n">normal_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">_lpvect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_lpvect</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_deviation</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_deviation</span>


<span class="k">class</span> <span class="nc">HalfNormalDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Half-normal distribution with zero PDF above or below the mode.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">standard_deviation</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - central_value: mode of the distribution.</span>
<span class="sd">        - standard_deviation:</span>
<span class="sd">          If positive, the PDF is zero below central_value and (twice) that of</span>
<span class="sd">          a Gaussian with this standard deviation above.</span>
<span class="sd">          If negative, the PDF is zero above central_value and (twice) that of</span>
<span class="sd">          a Gaussian with standard deviation equal to abs(standard_deviation)</span>
<span class="sd">          below.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span>
                         <span class="n">support</span><span class="o">=</span><span class="nb">sorted</span><span class="p">((</span><span class="n">central_value</span><span class="p">,</span>
                                         <span class="n">central_value</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">standard_deviation</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">standard_deviation</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Standard deviation must be non-zero number&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">=</span> <span class="n">standard_deviation</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.HalfNormalDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">),</span> <span class="n">size</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">normal_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">_lpvect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_lpvect</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">halfnorm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span>
                                                <span class="n">loc</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span>
                                                <span class="n">scale</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">halfnorm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
                                            <span class="n">loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span>
                                            <span class="n">scale</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">halfnorm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span>
                                            <span class="n">loc</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span>
                                            <span class="n">scale</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">halfnorm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
                                            <span class="n">loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span>
                                            <span class="n">scale</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>  <span class="c1"># return a positive value!</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span>


<span class="k">class</span> <span class="nc">GaussianUpperLimit</span><span class="p">(</span><span class="n">HalfNormalDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Upper limit defined as a half-normal distribution.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - limit: value of the upper limit</span>
<span class="sd">        - confidence_level: confidence_level of the upper limit. Float between</span>
<span class="sd">          0 and 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">confidence_level</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">confidence_level</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Confidence level should be between 0 und 1&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">limit</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The upper limit should be a positive number&quot;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                         <span class="n">standard_deviation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_standard_deviation</span><span class="p">(</span><span class="n">limit</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="n">limit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span> <span class="o">=</span> <span class="n">confidence_level</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.GaussianUpperLimit&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">limit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_standard_deviation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert the confidence level into a Gaussian standard deviation&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">limit</span> <span class="o">/</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">confidence_level</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">GammaDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;A Gamma distribution defined like the `gamma` distribution in</span>
<span class="sd">    `scipy.stats` (with parameters `a`, `loc`, `scale`).</span>

<span class="sd">    The `central_value` attribute returns the location of the mode.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">loc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;loc must be negative or zero&quot;</span><span class="p">)</span>
        <span class="c1"># &quot;frozen&quot; scipy distribution object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="n">loc</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">scale</span>
        <span class="c1"># support extends until the CDF is roughly &quot;6 sigma&quot;</span>
        <span class="n">support_limit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">2e-9</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="c1"># the mode</span>
                         <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">support_limit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="n">loc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.GammaDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_find_error_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">):</span>
        <span class="c1"># find the value of the CDF at the position of the left boundary</span>
        <span class="c1"># of the `confidence_level`% CL range by demanding that the value</span>
        <span class="c1"># of the PDF is the same at the two boundaries</span>
        <span class="k">def</span> <span class="nf">x_left</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">x_right</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">diff_logpdf</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="n">logpdf_x_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x_left</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
            <span class="n">logpdf_x_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x_right</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">logpdf_x_left</span> <span class="o">-</span> <span class="n">logpdf_x_right</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="n">diff_logpdf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="o">-</span><span class="mf">1e-6</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>

<span class="k">class</span> <span class="nc">GammaDistributionPositive</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;A Gamma distribution defined like the `gamma` distribution in</span>
<span class="sd">    `scipy.stats` (with parameters `a`, `loc`, `scale`), but restricted to</span>
<span class="sd">    positive values for x and correspondingly rescaled PDF.</span>

<span class="sd">    The `central_value` attribute returns the location of the mode.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">loc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;loc must be negative or zero&quot;</span><span class="p">)</span>
        <span class="c1"># &quot;frozen&quot; scipy distribution object (without restricting x&gt;0!)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="n">loc</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">scale</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># support extends until the CDF is roughly &quot;6 sigma&quot;, assuming x&gt;0</span>
        <span class="n">support_limit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">2e-9</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="c1"># the mode</span>
                         <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">support_limit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="n">loc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>
        <span class="c1"># scale factor for PDF to account for x&gt;0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pdf_scale</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.GammaDistributionPositive&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># some iteration necessary as discarding negative values</span>
            <span class="c1"># might lead to too small size</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">size</span><span class="p">)))</span>
            <span class="k">return</span> <span class="n">r</span><span class="p">[:</span><span class="n">size</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">[(</span><span class="n">r</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">cdf0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">cdf</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">cdf0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">cdf0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">piecewise</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span>
                    <span class="p">[</span><span class="n">x</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">cdf</span><span class="p">])</span> <span class="c1"># return 0 for negative x</span>

    <span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">cdf0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">cdf0</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span>  <span class="n">cdf0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># return -inf for negative x values</span>
        <span class="n">inf0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">piecewise</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span> <span class="p">[</span><span class="n">x</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">inf0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pdf_scale</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_find_error_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">):</span>
        <span class="c1"># find the value of the CDF at the position of the left boundary</span>
        <span class="c1"># of the `confidence_level`% CL range by demanding that the value</span>
        <span class="c1"># of the PDF is the same at the two boundaries</span>
        <span class="k">def</span> <span class="nf">x_left</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">x_right</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">diff_logpdf</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="n">logpdf_x_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x_left</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
            <span class="n">logpdf_x_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x_right</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">logpdf_x_left</span> <span class="o">-</span> <span class="n">logpdf_x_right</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="n">diff_logpdf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="o">-</span><span class="mf">1e-6</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))):</span>
            <span class="c1"># look at a one-sided 1 sigma range. If the PDF at 0</span>
            <span class="c1"># is smaller than the PDF at the boundary of this range, it means</span>
            <span class="c1"># that the left-hand error is not meaningful to define.</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
        <span class="n">one_sided_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">one_sided_error</span><span class="p">):</span>
            <span class="c1"># look at a one-sided 1 sigma range. If the PDF at 0</span>
            <span class="c1"># is smaller than the PDF at the boundary of this range, return the</span>
            <span class="c1"># boundary of the range as the right-hand error</span>
            <span class="k">return</span> <span class="n">one_sided_error</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>

<span class="k">class</span> <span class="nc">GammaUpperLimit</span><span class="p">(</span><span class="n">GammaDistributionPositive</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Gamma distribution with x restricted to be positive appropriate for</span>
<span class="sd">    a positive quantitity obtained from a low-statistics counting experiment,</span>
<span class="sd">    e.g. a rare decay rate, given an upper limit on x.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">counts_total</span><span class="p">,</span> <span class="n">counts_background</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - counts_total: observed total number (signal and background) of counts.</span>
<span class="sd">        - counts_background: number of expected background counts, assumed to be</span>
<span class="sd">          known.</span>
<span class="sd">        - limit: upper limit on x, which is proportional (with a positive</span>
<span class="sd">          proportionality factor) to the number of signal events.</span>
<span class="sd">        - confidence_level: confidence level of the upper limit, i.e. the value</span>
<span class="sd">          of the CDF at the limit. Float between 0 and 1. Frequently used values</span>
<span class="sd">          are 0.90 and 0.95.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">confidence_level</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">confidence_level</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Confidence level should be between 0 und 1&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">limit</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The upper limit should be a positive number&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">counts_total</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;counts_total should be a positive number or zero&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">counts_background</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;counts_background should be a positive number or zero&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="n">limit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span> <span class="o">=</span> <span class="n">confidence_level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">=</span> <span class="n">counts_total</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counts_background</span> <span class="o">=</span> <span class="n">counts_background</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_a_loc_scale</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.GammaUpperLimit&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">counts_background</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">limit</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_a_loc_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert the counts and limit to the input parameters needed for</span>
<span class="sd">        GammaDistributionPositive&quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">loc_unscaled</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">counts_background</span>
        <span class="n">dist_unscaled</span> <span class="o">=</span> <span class="n">GammaDistributionPositive</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc_unscaled</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">limit_unscaled</span> <span class="o">=</span> <span class="n">dist_unscaled</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span><span class="p">)</span>
        <span class="c1"># rescale</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limit</span><span class="o">/</span><span class="n">limit_unscaled</span>
        <span class="n">loc</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">counts_background</span><span class="o">*</span><span class="n">scale</span>
        <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span>

<span class="k">class</span> <span class="nc">NumericalDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Univariate distribution defined in terms of numerical values for the</span>
<span class="sd">    PDF.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">central_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize a 1D numerical distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - `x`: x-axis values. Must be a 1D array of real values in strictly</span>
<span class="sd">          ascending order (but not necessarily evenly spaced)</span>
<span class="sd">        - `y`: PDF values. Must be a 1D array of real positive values with the</span>
<span class="sd">          same length as `x`</span>
<span class="sd">        - central_value: if None (default), will be set to the mode of the</span>
<span class="sd">          distribution, i.e. the x-value where y is largest (by looking up</span>
<span class="sd">          the input arrays, i.e. without interpolation!)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="k">if</span> <span class="n">central_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">central_value</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">central_value</span><span class="p">,</span>
                                 <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Central value must be within range provided&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span>  <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># normalize PDF to 1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span><span class="p">,</span>
                                        <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">_cdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">_cdf</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">_cdf</span> <span class="o">=</span> <span class="n">_cdf</span><span class="o">/</span><span class="n">_cdf</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># normalize CDF to 1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ppf_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">_cdf</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cdf_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">_cdf</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.NumericalDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Draw a random number from the distribution.</span>

<span class="sd">        If size is not None but an integer N, return an array of N numbers.&quot;&quot;&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_interp</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># ignore warning from log(0)=-np.inf</span>
        <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_find_error_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">):</span>
        <span class="c1"># find the value of the CDF at the position of the left boundary</span>
        <span class="c1"># of the `confidence_level`% CL range by demanding that the value</span>
        <span class="c1"># of the PDF is the same at the two boundaries</span>
        <span class="k">def</span> <span class="nf">x_left</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">x_right</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">diff_logpdf</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="n">logpdf_x_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x_left</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
            <span class="n">logpdf_x_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x_right</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">logpdf_x_left</span> <span class="o">-</span> <span class="n">logpdf_x_right</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="n">diff_logpdf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="o">-</span><span class="mf">1e-6</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower error.</span>

<span class="sd">        &#39;method&#39; should be one of:</span>

<span class="sd">        - &#39;central&#39; for a central interval (same probability on both sides of</span>
<span class="sd">          the central value)</span>
<span class="sd">        - &#39;hpd&#39; for highest posterior density, i.e. probability is larger inside</span>
<span class="sd">          the interval than outside</span>
<span class="sd">        - &#39;limit&#39; for a one-sided error, i.e. a lower limit&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;limit&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="n">cdf_central</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">err_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">cdf_central</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;central&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">err_left</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;hpd&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_error_right</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="n">err_left</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">err_left</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Method &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">method</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; unknown&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper error</span>

<span class="sd">        &#39;method&#39; should be one of:</span>

<span class="sd">        - &#39;central&#39; for a central interval (same probability on both sides of</span>
<span class="sd">          the central value)</span>
<span class="sd">        - &#39;hpd&#39; for highest posterior density, i.e. probability is larger inside</span>
<span class="sd">          the interval than outside</span>
<span class="sd">        - &#39;limit&#39; for a one-sided error, i.e. an upper limit&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;limit&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
        <span class="n">cdf_central</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">err_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">cdf_central</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cdf_central</span><span class="p">)</span> <span class="o">*</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;central&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">err_right</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;hpd&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_error_left</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="n">err_right</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">err_right</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Method &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">method</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; unknown&quot;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_pd</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pd</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pd</span><span class="p">,</span> <span class="n">NumericalDistribution</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pd</span>
        <span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">nsteps</span><span class="p">)</span>
        <span class="n">_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">_x</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">_y</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">GeneralGammaDistributionPositive</span><span class="p">(</span><span class="n">NumericalDistribution</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Distribution appropriate for</span>
<span class="sd">    a positive quantitity obtained from a low-statistics counting experiment,</span>
<span class="sd">    e.g. a rare decay rate.</span>
<span class="sd">    The difference to `GammaUpperLimit` is that this class also allows to</span>
<span class="sd">    specify an uncertainty on the number of background events. The result</span>
<span class="sd">    is a numerical distribution obtained from the convolution of a normal</span>
<span class="sd">    distribution (for the background uncertainty) and a gamma distribution,</span>
<span class="sd">    restricted to positive values.</span>
<span class="sd">    In contrast to `GammaUpperLimit`, the scale factor (the relational between</span>
<span class="sd">    the observable of interest and the raw number of counts) is not determined</span>
<span class="sd">    from a limit and a confidence level, but specified explicitly.</span>
<span class="sd">    For the case of a limit, see `GeneralGammaUpperLimit`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">scale_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">counts_total</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">counts_background</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">counts_signal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">background_variance</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - `scale_factor`: scale factor by which the number of counts is multiplied</span>
<span class="sd">          to get the observable of interest.</span>
<span class="sd">        - `counts_total`: observed total number (signal and background) of counts.</span>
<span class="sd">        - `counts_background`: expected mean number of expected background counts</span>
<span class="sd">        - `counts_signal`: mean obseved number of signal events</span>
<span class="sd">        - `background_variance`: standard deviation of the expected number of</span>
<span class="sd">          background events</span>

<span class="sd">        Of the three parameters `counts_total`, `counts_background`, and</span>
<span class="sd">        `counts_signal`, only two must be specified. The third one will</span>
<span class="sd">        be determined from the relation</span>

<span class="sd">        `counts_total = counts_signal + counts_background`</span>

<span class="sd">        Note that if `background_variance=0`, it makes more sense to use</span>
<span class="sd">        `GammaUpperLimit`, which is equivalent but analytical rather than</span>
<span class="sd">        numerical.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">scale_factor</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Scale factor should be positive&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">=</span> <span class="n">scale_factor</span>
        <span class="k">if</span> <span class="n">counts_total</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">counts_total</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;counts_total should be a positive number, zero, or None&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">counts_background</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">counts_background</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;counts_background should be a positive number or None&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">background_variance</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;background_variance should be a positive number&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">[</span><span class="n">counts_total</span><span class="p">,</span> <span class="n">counts_signal</span><span class="p">,</span> <span class="n">counts_background</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># if all three are specified, check the relation holds!</span>
            <span class="k">if</span> <span class="n">counts_background</span> <span class="o">!=</span> <span class="n">counts_total</span> <span class="o">-</span> <span class="n">counts_signal</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The relation `counts_total = counts_signal + counts_background` is not satisfied&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">counts_background</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">counts_background</span> <span class="o">=</span> <span class="n">counts_total</span> <span class="o">-</span> <span class="n">counts_signal</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">counts_background</span> <span class="o">=</span> <span class="n">counts_background</span>
        <span class="k">if</span> <span class="n">counts_signal</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">counts_signal</span> <span class="o">=</span> <span class="n">counts_total</span> <span class="o">-</span> <span class="n">counts_background</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">counts_signal</span> <span class="o">=</span> <span class="n">counts_signal</span>
        <span class="k">if</span> <span class="n">counts_total</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">=</span> <span class="n">counts_signal</span> <span class="o">+</span> <span class="n">counts_background</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">=</span> <span class="n">counts_total</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">background_variance</span> <span class="o">=</span> <span class="n">background_variance</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">background_variance</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">100.</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;For vanishing or very small background variance, &quot;</span>
                          <span class="s2">&quot;it is safer to use GammaUpperLimit instead of &quot;</span>
                          <span class="s2">&quot;GeneralGammaUpperLimit to avoid numerical &quot;</span>
                          <span class="s2">&quot;instability.&quot;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;flavio.statistics.probability.GeneralGammaDistributionPositive&#39;</span>
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, counts_total=</span><span class="si">{}</span><span class="s1">, counts_signal=</span><span class="si">{}</span><span class="s1">, &#39;</span>
               <span class="s1">&#39;background_variance=</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">counts_signal</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">background_variance</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">background_variance</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># this is a bit pointless as in this case it makes more</span>
            <span class="c1"># sense to use GammaUpperLimit itself</span>
            <span class="n">gamma_unscaled</span> <span class="o">=</span> <span class="n">GammaDistributionPositive</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                                       <span class="n">loc</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">counts_background</span><span class="p">,</span>
                                                       <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">num_unscaled</span> <span class="o">=</span> <span class="n">NumericalDistribution</span><span class="o">.</span><span class="n">from_pd</span><span class="p">(</span><span class="n">gamma_unscaled</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># define a gamma distribution (with x&gt;loc, not x&gt;0!) and convolve</span>
            <span class="c1"># it with a Gaussian</span>
            <span class="n">gamma_unscaled</span> <span class="o">=</span> <span class="n">GammaDistribution</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                               <span class="n">loc</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">counts_background</span><span class="p">,</span>
                                               <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">norm_bg</span> <span class="o">=</span> <span class="n">NormalDistribution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">background_variance</span><span class="p">)</span>
            <span class="n">num_unscaled</span> <span class="o">=</span> <span class="n">convolve_distributions</span><span class="p">([</span><span class="n">gamma_unscaled</span><span class="p">,</span> <span class="n">norm_bg</span><span class="p">],</span> <span class="n">central_values</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>
        <span class="c1"># now that we have convolved, cut off anything below x=0</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">num_unscaled</span><span class="o">.</span><span class="n">x</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">num_unscaled</span><span class="o">.</span><span class="n">y_norm</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1">#  make sure the PDF at 0 exists</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>  <span class="c1"># add 0 as first element</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># copy first element</span>
        <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">num_unscaled</span> <span class="o">=</span> <span class="n">NumericalDistribution</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>


<span class="k">class</span> <span class="nc">GeneralGammaUpperLimit</span><span class="p">(</span><span class="n">GeneralGammaDistributionPositive</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Distribution appropriate for</span>
<span class="sd">    a positive quantitity obtained from a low-statistics counting experiment,</span>
<span class="sd">    e.g. a rare decay rate, given an upper limit on x.</span>
<span class="sd">    The difference to `GammaUpperLimit` is that this class also allows to</span>
<span class="sd">    specify an uncertainty on the number of background events. The result</span>
<span class="sd">    is a numerical distribution obtained from the convolution of a normal</span>
<span class="sd">    distribution (for the background uncertainty) and a gamma distribution,</span>
<span class="sd">    restricted to positive values.</span>
<span class="sd">    The only difference to `GeneralGammaDistributionPositive` is that the scale</span>
<span class="sd">    factor is determined from the limit and confidence level.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">limit</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">,</span>
                 <span class="n">counts_total</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">counts_background</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">counts_signal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">background_variance</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - `limit`: upper limit on x, which is proportional (with a positive</span>
<span class="sd">          proportionality factor) to the number of signal events.</span>
<span class="sd">        - `confidence_level`: confidence level of the upper limit, i.e. the value</span>
<span class="sd">          of the CDF at the limit. Float between 0 and 1. Frequently used values</span>
<span class="sd">          are 0.90 and 0.95.</span>
<span class="sd">        - `counts_total`: observed total number (signal and background) of counts.</span>
<span class="sd">        - `counts_background`: expected mean number of expected background counts</span>
<span class="sd">        - `counts_signal`: mean obseved number of signal events</span>
<span class="sd">        - `background_variance`: standard deviation of the expected number of</span>
<span class="sd">          background events</span>

<span class="sd">        Of the three parameters `counts_total`, `counts_background`, and</span>
<span class="sd">        `counts_signal`, only two must be specified. The third one will</span>
<span class="sd">        be determined from the relation</span>

<span class="sd">        `counts_total = counts_signal + counts_background`</span>

<span class="sd">        Note that if `background_variance=0`, it makes more sense to use</span>
<span class="sd">        `GammaUpperLimit`, which is equivalent but analytical rather than</span>
<span class="sd">        numerical.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="n">limit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span> <span class="o">=</span> <span class="n">confidence_level</span>
        <span class="n">_d_unscaled</span> <span class="o">=</span> <span class="n">GeneralGammaDistributionPositive</span><span class="p">(</span>
            <span class="n">scale_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">counts_total</span><span class="o">=</span><span class="n">counts_total</span><span class="p">,</span>
            <span class="n">counts_background</span><span class="o">=</span><span class="n">counts_background</span><span class="p">,</span>
            <span class="n">counts_signal</span><span class="o">=</span><span class="n">counts_signal</span><span class="p">,</span>
            <span class="n">background_variance</span><span class="o">=</span><span class="n">background_variance</span><span class="p">)</span>
        <span class="n">limit_unscaled</span> <span class="o">=</span> <span class="n">_d_unscaled</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span><span class="p">)</span>
        <span class="c1"># use the value of the limit to determine the scale factor</span>
        <span class="n">scale_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limit</span> <span class="o">/</span> <span class="n">limit_unscaled</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">scale_factor</span><span class="o">=</span><span class="n">scale_factor</span><span class="p">,</span>
            <span class="n">counts_total</span><span class="o">=</span><span class="n">counts_total</span><span class="p">,</span>
            <span class="n">counts_background</span><span class="o">=</span><span class="n">counts_background</span><span class="p">,</span>
            <span class="n">counts_signal</span><span class="o">=</span><span class="n">counts_signal</span><span class="p">,</span>
            <span class="n">background_variance</span><span class="o">=</span><span class="n">background_variance</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;flavio.statistics.probability.GeneralGammaUpperLimit&#39;</span>
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, counts_total=</span><span class="si">{}</span><span class="s1">, counts_signal=</span><span class="si">{}</span><span class="s1">, &#39;</span>
               <span class="s1">&#39;background_variance=</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">limit</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">counts_signal</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">background_variance</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">KernelDensityEstimate</span><span class="p">(</span><span class="n">NumericalDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Univariate kernel density estimate.</span>

<span class="sd">    Parameters:</span>

<span class="sd">    - `data`: 1D array</span>
<span class="sd">    - `kernel`: instance of `ProbabilityDistribution` used as smoothing kernel</span>
<span class="sd">    - `n_bins` (optional): number of bins used in the intermediate step. This normally</span>
<span class="sd">      does not have to be changed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">n_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">assert</span> <span class="n">kernel</span><span class="o">.</span><span class="n">central_value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Kernel density must have zero central value&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span> <span class="o">=</span> <span class="n">kernel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n_bins</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span> <span class="o">=</span> <span class="n">n_bins</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">x_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="mf">2.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_raw</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw_dist</span> <span class="o">=</span> <span class="n">NumericalDistribution</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">cdist</span> <span class="o">=</span> <span class="n">convolve_distributions</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_dist</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">],</span> <span class="s1">&#39;sum&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cdist</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">cdist</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.KernelDensityEstimate&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">GaussianKDE</span><span class="p">(</span><span class="n">KernelDensityEstimate</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Univariate Gaussian kernel density estimate.</span>

<span class="sd">    Parameters:</span>

<span class="sd">    - `data`: 1D array</span>
<span class="sd">    - `bandwidth` (optional): standard deviation of the Gaussian smoothing kernel.</span>
<span class="sd">       If not provided, Scott&#39;s rule is used to estimate it.</span>
<span class="sd">    - `n_bins` (optional): number of bins used in the intermediate step. This normally</span>
<span class="sd">      does not have to be changed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">bandwidth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bandwidth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bandwidth</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mf">5.</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bandwidth</span> <span class="o">=</span> <span class="n">bandwidth</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                         <span class="n">kernel</span> <span class="o">=</span> <span class="n">NormalDistribution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bandwidth</span><span class="p">),</span>
                         <span class="n">n_bins</span><span class="o">=</span><span class="n">n_bins</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.GaussianKDE&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bandwidth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MultivariateNormalDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A multivariate normal distribution.</span>

<span class="sd">    Parameters:</span>

<span class="sd">    - central_value: the location vector</span>
<span class="sd">    - covariance: the covariance matrix</span>
<span class="sd">    - standard_deviation: the square root of the variance vector</span>
<span class="sd">    - correlation: the correlation matrix</span>

<span class="sd">    If the covariance matrix is not specified, standard_deviation and the</span>
<span class="sd">    correlation matrix have to be specified.</span>

<span class="sd">    Methods:</span>

<span class="sd">    - get_random(size=None): get `size` random numbers (default: a single one)</span>
<span class="sd">    - logpdf(x, exclude=None): get the logarithm of the probability density</span>
<span class="sd">      function. If an iterable of integers is given for `exclude`, the parameters</span>
<span class="sd">      at these positions will be removed from the covariance before evaluating</span>
<span class="sd">      the PDF, effectively ignoring certain dimensions.</span>

<span class="sd">    Properties:</span>

<span class="sd">    - error_left, error_right: both return the vector of standard deviations</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">covariance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">standard_deviation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">correlation</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize PDF instance.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - central_value: vector of means, shape (n)</span>
<span class="sd">        - covariance: covariance matrix, shape (n,n)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">covariance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="n">covariance</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">correlation</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">standard_deviation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You must specify either covariance or standard_deviation&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">standard_deviation</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">correlation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">correlation</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                    <span class="c1"># if it&#39;s a number, return delta_ij + (1-delta_ij)*x</span>
                    <span class="n">n_dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">central_value</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n_dim</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n_dim</span><span class="p">,</span> <span class="n">n_dim</span><span class="p">))</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n_dim</span><span class="p">))</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">correlation</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">correlation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">correlation</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">central_value</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">,</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">central_value</span><span class="p">)</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span>
                    <span class="p">]))</span>
        <span class="c1"># to avoid ill-conditioned covariance matrices, all data are rescaled</span>
        <span class="c1"># by the inverse variances</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaled_covariance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">err</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">err</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled_covariance</span><span class="p">)</span> <span class="o">&gt;</span>
                      <span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;The covariance matrix is not positive definite!&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">covariance</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.MultivariateNormalDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get `size` random numbers (default: a single one)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">reduce_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a different instance where certain dimensions, specified by</span>
<span class="sd">        the iterable of integers `exclude`, are removed from the covariance.</span>

<span class="sd">        If `exclude` contains all indices but one, an instance of</span>
<span class="sd">        `NormalDistribution` will be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">exclude</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="c1"># if parameters are to be excluded, construct a</span>
        <span class="c1"># distribution with reduced mean vector and covariance matrix</span>
        <span class="n">_cent_ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="n">exclude</span><span class="p">)</span>
        <span class="n">_cov_ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">,</span> <span class="n">exclude</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">exclude</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_cent_ex</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># if only 1 dimension remains, can use a univariate Gaussian</span>
            <span class="n">_dist_ex</span> <span class="o">=</span> <span class="n">NormalDistribution</span><span class="p">(</span>
                <span class="n">central_value</span><span class="o">=</span><span class="n">_cent_ex</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">standard_deviation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">_cov_ex</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if more than 1 dimension remains, use a (smaller)</span>
            <span class="c1"># multivariate Gaussian</span>
            <span class="n">_dist_ex</span> <span class="o">=</span> <span class="n">MultivariateNormalDistribution</span><span class="p">(</span>
                <span class="n">central_value</span><span class="o">=</span><span class="n">_cent_ex</span><span class="p">,</span> <span class="n">covariance</span><span class="o">=</span><span class="n">_cov_ex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_dist_ex</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the logarithm of the probability density function.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - x: vector; position at which PDF should be evaluated</span>
<span class="sd">        - exclude: optional; if an iterable of integers is given, the parameters</span>
<span class="sd">          at these positions will be removed from the covariance before</span>
<span class="sd">          evaluating the PDF, effectively ignoring certain dimensions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># if parameters are to be excluded, construct a temporary</span>
            <span class="c1"># distribution with reduced mean vector and covariance matrix</span>
            <span class="c1"># and call its logpdf method</span>
            <span class="n">_dist_ex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce_dimension</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">_dist_ex</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="c1"># undoing the rescaling of the covariance</span>
        <span class="n">pdf_scaled</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span>
            <span class="n">x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">err</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">err</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaled_covariance</span><span class="p">)</span>
        <span class="n">sign</span><span class="p">,</span> <span class="n">logdet</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pdf_scaled</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled_covariance</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower errors&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">err</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper errors&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">err</span>


<span class="k">class</span> <span class="nc">MultivariateNumericalDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A multivariate distribution with PDF specified numerically.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">central_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize a multivariate numerical distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - `xi`: for an N-dimensional distribution, a list of N 1D arrays</span>
<span class="sd">          specifiying the grid in N dimensions. The 1D arrays must contain</span>
<span class="sd">          real, evenly spaced values in strictly ascending order (but the</span>
<span class="sd">          spacing can be different for different dimensions). Any of the 1D</span>
<span class="sd">          arrays can also be given alternatively as a list of two numbers, which</span>
<span class="sd">          will be assumed to be the upper and lower boundaries, while the</span>
<span class="sd">          spacing will be determined from the shape of `y`.</span>
<span class="sd">        - `y`: PDF values on the grid defined by the `xi`. If the N `xi` have</span>
<span class="sd">          length M1, ..., MN, `y` has dimension (M1, ..., MN). This is the same</span>
<span class="sd">          shape as the grid obtained from `numpy.meshgrid(*xi, indexing=&#39;ij&#39;)`.</span>
<span class="sd">        - central_value: if None (default), will be set to the mode of the</span>
<span class="sd">          distribution, i.e. the N-dimensional xi-vector where y is largest</span>
<span class="sd">          (by looking up the input arrays, i.e. without interpolation!)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">:</span>
            <span class="c1"># check that grid spacings are even up to per mille precision</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-3</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Grid must be evenly spaced per dimension&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">xi</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">central_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">central_value</span><span class="p">,</span>
                             <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if no central value is specified, set it to the mode</span>
            <span class="n">mode_index</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">argmax</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">))[</span><span class="n">mode_index</span><span class="p">]</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">_bin_volume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="n">_bin_volume</span>  <span class="c1"># normalize PDF to 1</span>
        <span class="c1"># ignore warning from log(0)=-np.inf</span>
        <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
            <span class="c1"># logy = np.nan_to_num(np.log(self.y_norm))</span>
            <span class="n">logy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span><span class="p">)</span>
            <span class="n">logy</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isneginf</span><span class="p">(</span><span class="n">logy</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1e100</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logpdf_interp</span> <span class="o">=</span> <span class="n">RegularGridInterpolator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">,</span> <span class="n">logy</span><span class="p">,</span>
                                        <span class="n">fill_value</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># the following is needed for get_random: initialize to None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y_flat</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cdf_flat</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.MultivariateNumericalDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Draw a random number from the distribution.</span>

<span class="sd">        If size is not None but an integer N, return an array of N numbers.</span>

<span class="sd">        For the MultivariateNumericalDistribution, the PDF from which the</span>
<span class="sd">        random numbers are drawn is approximated to be piecewise constant in</span>
<span class="sd">        hypercubes around the points of the lattice spanned by the `xi`. A finer</span>
<span class="sd">        lattice spacing will lead to a smoother distribution of random numbers</span>
<span class="sd">        (but will also be slower).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)])</span>

    <span class="k">def</span> <span class="nf">_get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># if these have not been initialized, do it (once)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y_flat</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># get a flattened array of the PDF</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_y_flat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cdf_flat</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># get the (discrete) 1D CDF</span>
            <span class="n">_cdf_flat</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_y_flat</span><span class="p">)</span>
            <span class="c1"># normalize to 1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cdf_flat</span> <span class="o">=</span> <span class="n">_cdf_flat</span><span class="o">/</span><span class="n">_cdf_flat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># draw a number between 0 and 1</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">()</span>
        <span class="c1"># find the index of the CDF-value closest to r</span>
        <span class="n">i_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cdf_flat</span><span class="o">-</span><span class="n">r</span><span class="p">))</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y_flat</span><span class="p">[</span><span class="n">i_r</span><span class="p">])</span>
        <span class="n">i_bla</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">index</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">a</span><span class="p">[</span><span class="n">i_bla</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">])</span>
        <span class="n">xi_r</span> <span class="o">=</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">))</span> <span class="p">]</span>
        <span class="n">xi_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">X</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="p">])</span>
        <span class="k">return</span> <span class="n">xi_r</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">))</span> <span class="o">*</span> <span class="n">xi_diff</span>

    <span class="k">def</span> <span class="nf">reduce_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a different instance where certain dimensions, specified by</span>
<span class="sd">        the iterable of integers `exclude`, are removed from the covariance.</span>

<span class="sd">        If `exclude` contains all indices but one, an instance of</span>
<span class="sd">        `NumericalDistribution` will be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">exclude</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="c1"># if parameters are to be excluded, construct a</span>
        <span class="c1"># distribution with reduced mean vector and covariance matrix</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">exclude</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">exclude</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">exclude</span> <span class="o">=</span> <span class="p">(</span><span class="n">exclude</span><span class="p">,)</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">exclude</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">exclude</span><span class="p">))</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">exclude</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># if there is just 1 dimension left, use univariate</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">NumericalDistribution</span><span class="p">(</span><span class="n">xi</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">MultivariateNumericalDistribution</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dist</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the logarithm of the probability density function.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - x: vector; position at which PDF should be evaluated</span>
<span class="sd">        - exclude: optional; if an iterable of integers is given, the parameters</span>
<span class="sd">          at these positions will be ignored by maximizing the likelihood</span>
<span class="sd">          along the remaining directions, i.e., they will be &quot;profiled out&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># if parameters are to be excluded, construct a temporary</span>
            <span class="c1"># distribution with reduced mean vector and covariance matrix</span>
            <span class="c1"># and call its logpdf method</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce_dimension</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">dist</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">),):</span>
            <span class="c1"># return a scalar</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;1D errors not implemented for multivariate numerical distributions&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;1D errors not implemented for multivariate numerical distributions&quot;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_pd</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pd</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
        <span class="k">if</span>  <span class="nb">isinstance</span><span class="p">(</span><span class="n">pd</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
            <span class="c1"># nothing to do</span>
            <span class="k">return</span> <span class="n">pd</span>
        <span class="n">_xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">nsteps</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">central_value</span><span class="p">))])</span>
        <span class="n">ndim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">_xi</span><span class="p">)</span>
        <span class="n">_xlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="o">*</span><span class="n">_xi</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ndim</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">**</span><span class="n">ndim</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="n">_ylist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">_xlist</span><span class="p">))</span>
        <span class="n">_y</span> <span class="o">=</span> <span class="n">_ylist</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">nsteps</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="n">xi</span><span class="o">=</span><span class="n">_xi</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">_y</span><span class="p">)</span>


<span class="c1"># Auxiliary functions</span>

<span class="k">def</span> <span class="nf">convolve_distributions</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">,</span> <span class="n">central_values</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Combine a set of probability distributions by convoluting the PDFs.</span>

<span class="sd">    This function can be used in two different ways:</span>

<span class="sd">    - for `central_values=&#39;same&#39;`, it can be used to combine uncertainties on a</span>
<span class="sd">    single parameter/observable expressed in terms of probability distributions</span>
<span class="sd">    with the same central value.</span>
<span class="sd">    - for `central_values=&#39;sum&#39;`, it can be used to determine the probability</span>
<span class="sd">    distribution of a sum of random variables.</span>

<span class="sd">    The only difference between the two cases is a shift: for &#39;same&#39;, the</span>
<span class="sd">    central value of the convolution is the same as the original central value,</span>
<span class="sd">    for &#39;sum&#39;, it is the sum of the individual central values.</span>

<span class="sd">    `probability_distributions` must be a list of instances of descendants of</span>
<span class="sd">    `ProbabilityDistribution`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">central_values</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;central_values must be either &#39;same&#39; or &#39;sum&#39;&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">dim</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="c1"># 1 for floats and length for arrays</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="n">dim</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">d</span> <span class="o">==</span> <span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dims</span><span class="p">]),</span> <span class="s2">&quot;All distributions must have the same number of dimensions&quot;</span>
    <span class="k">if</span> <span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_convolve_distributions_univariate</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">,</span> <span class="n">central_values</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_convolve_distributions_multivariate</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">,</span> <span class="n">central_values</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_convolve_distributions_univariate</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">,</span> <span class="n">central_values</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Combine a set of univariate probability distributions.&quot;&quot;&quot;</span>
    <span class="c1"># if there&#39;s just one: return it immediately</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">probability_distributions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">central_values</span> <span class="o">==</span> <span class="s1">&#39;same&#39;</span><span class="p">:</span>
        <span class="n">central_value</span> <span class="o">=</span> <span class="n">probability_distributions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">central_value</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">central_value</span> <span class="o">==</span> <span class="n">central_value</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">),</span> \
            <span class="s2">&quot;Distributions must all have the same central value&quot;</span>

    <span class="c1"># all delta dists</span>
    <span class="n">deltas</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">DeltaDistribution</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">central_values</span> <span class="o">==</span> <span class="s1">&#39;sum&#39;</span> <span class="ow">and</span> <span class="n">deltas</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Convolution of DeltaDistributions only implemented for equal central values&quot;</span><span class="p">)</span>
    <span class="c1"># central_values is &#39;same&#39;, we can instead just ignore the delta distributions!</span>

    <span class="c1"># all normal dists</span>
    <span class="n">gaussians</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">NormalDistribution</span><span class="p">)]</span>

    <span class="c1"># all other univariate dists</span>
    <span class="n">others</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span>
              <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">NormalDistribution</span><span class="p">)</span>
              <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">DeltaDistribution</span><span class="p">)]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">others</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">gaussians</span><span class="p">:</span>
        <span class="c1"># if there is only a delta (or more than one), just return it</span>
        <span class="k">if</span> <span class="n">central_values</span> <span class="o">==</span> <span class="s1">&#39;same&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">deltas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">central_values</span> <span class="o">==</span> <span class="s1">&#39;same&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DeltaDistribution</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">central_value</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">deltas</span><span class="p">]))</span>

    <span class="c1"># let&#39;s combine the normal distributions into 1</span>
    <span class="k">if</span> <span class="n">gaussians</span><span class="p">:</span>
        <span class="n">gaussian</span> <span class="o">=</span> <span class="n">_convolve_gaussians</span><span class="p">(</span><span class="n">gaussians</span><span class="p">,</span> <span class="n">central_values</span><span class="o">=</span><span class="n">central_values</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">gaussians</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">others</span><span class="p">:</span>
        <span class="c1"># if there are only the gaussians, we are done.</span>
        <span class="k">return</span> <span class="n">gaussian</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># otherwise, we need to combine the (combined) gaussian with the others</span>
        <span class="k">if</span> <span class="n">gaussians</span><span class="p">:</span>
            <span class="n">to_be_combined</span> <span class="o">=</span> <span class="n">others</span> <span class="o">+</span> <span class="p">[</span><span class="n">gaussian</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">to_be_combined</span> <span class="o">=</span> <span class="n">others</span>
        <span class="c1"># turn all distributions into numerical distributions!</span>
        <span class="n">numerical</span> <span class="o">=</span> <span class="p">[</span><span class="n">NumericalDistribution</span><span class="o">.</span><span class="n">from_pd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">to_be_combined</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">_convolve_numerical</span><span class="p">(</span><span class="n">numerical</span><span class="p">,</span> <span class="n">central_values</span><span class="o">=</span><span class="n">central_values</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_convolve_distributions_multivariate</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">,</span> <span class="n">central_values</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Combine a set of multivariate probability distributions.&quot;&quot;&quot;</span>
    <span class="c1"># if there&#39;s just one: return it immediately</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">probability_distributions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">central_values</span> <span class="o">==</span> <span class="s1">&#39;same&#39;</span><span class="p">:</span>
        <span class="n">central_value</span> <span class="o">=</span> <span class="n">probability_distributions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">central_value</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">central_value</span><span class="p">))),</span> \
            <span class="s2">&quot;Distributions must all have the same central value&quot;</span>

    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">MultivariateNormalDistribution</span><span class="p">)</span>
                 <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">MultivariateNumericalDistribution</span><span class="p">)</span> <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Multivariate convolution only implemented &quot;</span>
                             <span class="s2">&quot;for normal and numerical distributions&quot;</span><span class="p">)</span>

    <span class="c1"># all normal dists</span>
    <span class="n">gaussians</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">MultivariateNormalDistribution</span><span class="p">)]</span>

    <span class="c1"># all numerical dists</span>
    <span class="n">others</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">MultivariateNumericalDistribution</span><span class="p">)]</span>

    <span class="c1"># let&#39;s combine the normal distributions into 1</span>
    <span class="k">if</span> <span class="n">gaussians</span><span class="p">:</span>
        <span class="n">gaussian</span> <span class="o">=</span> <span class="n">_convolve_multivariate_gaussians</span><span class="p">(</span><span class="n">gaussians</span><span class="p">,</span>
                                                  <span class="n">central_values</span><span class="o">=</span><span class="n">central_values</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">gaussians</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">others</span><span class="p">:</span>
        <span class="c1"># if there are only the gaussians, we are done.</span>
        <span class="k">return</span> <span class="n">gaussian</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># otherwise, we need to combine the (combined) gaussian with the others</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">others</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Combining multivariate numerical distributions not implemented&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">num</span> <span class="o">=</span> <span class="n">_convolve_multivariate_gaussian_numerical</span><span class="p">(</span><span class="n">gaussian</span><span class="p">,</span> <span class="n">others</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                  <span class="n">central_values</span><span class="o">=</span><span class="n">central_values</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">num</span>


<span class="k">def</span> <span class="nf">_convolve_gaussians</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">,</span> <span class="n">central_values</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">):</span>
    <span class="c1"># if there&#39;s just one: return it immediately</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">probability_distributions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">NormalDistribution</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">),</span> \
        <span class="s2">&quot;Distributions should all be instances of NormalDistribution&quot;</span>
    <span class="k">if</span> <span class="n">central_values</span> <span class="o">==</span> <span class="s1">&#39;same&#39;</span><span class="p">:</span>
        <span class="n">central_value</span> <span class="o">=</span> <span class="n">probability_distributions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">central_value</span>  <span class="c1"># central value of the first dist</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">central_value</span> <span class="o">==</span> <span class="n">central_value</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">),</span> \
            <span class="s2">&quot;Distrubtions must all have the same central value&quot;</span>
    <span class="k">elif</span> <span class="n">central_values</span> <span class="o">==</span> <span class="s1">&#39;sum&#39;</span><span class="p">:</span>
        <span class="n">central_value</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">central_value</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">])</span>
    <span class="n">sigmas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">])</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sigmas</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">NormalDistribution</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">central_value</span><span class="p">,</span> <span class="n">standard_deviation</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_convolve_multivariate_gaussians</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">,</span> <span class="n">central_values</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">):</span>
    <span class="c1"># if there&#39;s just one: return it immediately</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">probability_distributions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">MultivariateNormalDistribution</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">),</span> \
        <span class="s2">&quot;Distributions should all be instances of MultivariateNormalDistribution&quot;</span>
    <span class="k">if</span> <span class="n">central_values</span> <span class="o">==</span> <span class="s1">&#39;same&#39;</span><span class="p">:</span>
        <span class="n">central_value</span> <span class="o">=</span> <span class="n">probability_distributions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">central_value</span>  <span class="c1"># central value of the first dist</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">central_value</span> <span class="o">==</span> <span class="n">central_value</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">),</span> \
            <span class="s2">&quot;Distrubtions must all have the same central value&quot;</span>
    <span class="k">elif</span> <span class="n">central_values</span> <span class="o">==</span> <span class="s1">&#39;sum&#39;</span><span class="p">:</span>
        <span class="n">central_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">central_value</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">cov</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">covariance</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">MultivariateNormalDistribution</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">central_value</span><span class="p">,</span> <span class="n">covariance</span><span class="o">=</span><span class="n">cov</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_convolve_numerical</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">central_values</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">):</span>
    <span class="c1"># if there&#39;s just one: return it immediately</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">probability_distributions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">NumericalDistribution</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">),</span> \
        <span class="s2">&quot;Distributions should all be instances of NumericalDistribution&quot;</span>
    <span class="k">if</span> <span class="n">central_values</span> <span class="o">==</span> <span class="s1">&#39;same&#39;</span><span class="p">:</span>
        <span class="n">central_value</span> <span class="o">=</span> <span class="n">probability_distributions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">central_value</span>  <span class="c1"># central value of the first dist</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">central_value</span> <span class="o">==</span> <span class="n">central_value</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">),</span> \
            <span class="s2">&quot;Distrubtions must all have the same central value&quot;</span>
    <span class="k">elif</span> <span class="n">central_values</span> <span class="o">==</span> <span class="s1">&#39;sum&#39;</span><span class="p">:</span>
        <span class="n">central_value</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">central_value</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">])</span>
    <span class="c1"># differences of individual central values from combined central value</span>
    <span class="n">central_diffs</span> <span class="o">=</span> <span class="p">[</span><span class="n">central_value</span> <span class="o">-</span> <span class="n">p</span><span class="o">.</span><span class="n">central_value</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">]</span>

    <span class="c1"># (shifted appropriately)</span>
    <span class="n">supports</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">support</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">])</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">central_diffs</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">support</span> <span class="o">=</span> <span class="p">(</span><span class="n">central_value</span> <span class="o">-</span> <span class="p">(</span><span class="n">central_value</span> <span class="o">-</span> <span class="n">supports</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
               <span class="n">central_value</span> <span class="o">-</span> <span class="p">(</span><span class="n">central_value</span> <span class="o">-</span> <span class="n">supports</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="p">(</span><span class="n">support</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">support</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">nsteps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">support</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">support</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nsteps</span><span class="p">)</span>
    <span class="c1"># position of the central value</span>
    <span class="n">n_x_central</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">central_value</span> <span class="o">-</span> <span class="n">support</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">delta</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pd</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">):</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">central_diffs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">*</span> <span class="n">delta</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># first step</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">y1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># convolution</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;full&#39;</span><span class="p">)</span>
            <span class="c1"># cut out the convolved signal at the right place</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">n_x_central</span><span class="p">:</span><span class="n">nsteps</span> <span class="o">+</span> <span class="n">n_x_central</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">NumericalDistribution</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">central_value</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_convolve_multivariate_gaussian_numerical</span><span class="p">(</span><span class="n">mvgaussian</span><span class="p">,</span>
                                              <span class="n">mvnumerical</span><span class="p">,</span>
                                              <span class="n">central_values</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mvgaussian</span><span class="p">,</span> <span class="n">MultivariateNormalDistribution</span><span class="p">),</span> \
        <span class="s2">&quot;mvgaussian must be a single instance of MultivariateNormalDistribution&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mvnumerical</span><span class="p">,</span> <span class="n">MultivariateNumericalDistribution</span><span class="p">),</span> \
        <span class="s2">&quot;mvgaussian must be a single instance of MultivariateNumericalDistribution&quot;</span>
    <span class="n">nsteps</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="o">*</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mvnumerical</span><span class="o">.</span><span class="n">xi</span><span class="p">])</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">mvnumerical</span><span class="o">.</span><span class="n">xi</span><span class="p">),</span> <span class="n">nsteps</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mvnumerical</span><span class="o">.</span><span class="n">xi</span><span class="p">):</span>
        <span class="c1"># enlarge the support</span>
        <span class="n">cvn</span> <span class="o">=</span> <span class="n">mvnumerical</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">cvg</span> <span class="o">=</span> <span class="n">mvgaussian</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">supp</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">mvgaussian</span><span class="o">.</span><span class="n">support</span><span class="p">]</span>
        <span class="n">x_max</span> <span class="o">=</span> <span class="n">cvn</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">cvn</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">supp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">cvn</span><span class="p">)</span> <span class="o">+</span>  <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">cvg</span>
        <span class="n">x_min</span> <span class="o">=</span> <span class="n">cvn</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">cvn</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">supp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">cvn</span><span class="p">)</span> <span class="o">+</span>  <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">cvg</span>
        <span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">nsteps</span><span class="p">)</span>
    <span class="n">xi_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="o">*</span><span class="n">xi</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">))</span>
    <span class="c1"># this will transpose from shape (0, 1, 2, ...) to (1, 2, ..., 0)</span>
    <span class="n">xi_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">xi_grid</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">xi_grid</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
    <span class="n">y_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">mvnumerical</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">xi_grid</span><span class="p">))</span>
    <span class="c1"># shift Gaussian to the mean of the support</span>
    <span class="n">xi_grid</span> <span class="o">=</span> <span class="n">xi_grid</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mvgaussian</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
    <span class="n">y_gauss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">mvgaussian</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">xi_grid</span><span class="p">))</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">y_num</span><span class="p">,</span> <span class="n">y_gauss</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
    <span class="n">f</span><span class="p">[</span><span class="n">f</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">/</span><span class="n">f</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">central_values</span> <span class="o">==</span> <span class="s1">&#39;sum&#39;</span><span class="p">:</span>
        <span class="c1"># shift back</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="p">(</span><span class="n">xi</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mvgaussian</span><span class="o">.</span><span class="n">central_value</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
    <span class="k">return</span> <span class="n">MultivariateNumericalDistribution</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">combine_distributions</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Combine a set of probability distributions by multiplying the PDFs.</span>

<span class="sd">    `probability_distributions` must be a list of instances of descendants of</span>
<span class="sd">    `ProbabilityDistribution`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">dim</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="c1"># 1 for floats and length for arrays</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="n">dim</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">d</span> <span class="o">==</span> <span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dims</span><span class="p">]),</span> <span class="s2">&quot;All distributions must have the same number of dimensions&quot;</span>
    <span class="k">if</span> <span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_combine_distributions_univariate</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_combine_distributions_multivariate</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_combine_distributions_univariate</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">):</span>
    <span class="c1"># if there&#39;s just one: return it immediately</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">probability_distributions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># all delta dists</span>
    <span class="n">deltas</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">DeltaDistribution</span><span class="p">)]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">deltas</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># for multiple delta dists, check if central values are the same</span>
        <span class="n">cvs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">central_value</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">deltas</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cvs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Combining multiple delta distributions with different central values yields zero PDF&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">deltas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">deltas</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># for single delta dist, nothing to combine: delta always wins!</span>
        <span class="k">return</span> <span class="n">deltas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># all normal dists</span>
    <span class="n">gaussians</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">NormalDistribution</span><span class="p">)]</span>

    <span class="c1"># all other univariate dists</span>
    <span class="n">others</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span>
              <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">NormalDistribution</span><span class="p">)</span>
              <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">DeltaDistribution</span><span class="p">)]</span>

    <span class="c1"># let&#39;s combine the normal distributions into 1</span>
    <span class="k">if</span> <span class="n">gaussians</span><span class="p">:</span>
        <span class="n">gaussian</span> <span class="o">=</span> <span class="n">_combine_gaussians</span><span class="p">(</span><span class="n">gaussians</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">gaussians</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">others</span><span class="p">:</span>
        <span class="c1"># if there are only the gaussians, we are done.</span>
        <span class="k">return</span> <span class="n">gaussian</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># otherwise, we need to combine the (combined) gaussian with the others</span>
        <span class="k">if</span> <span class="n">gaussians</span><span class="p">:</span>
            <span class="n">to_be_combined</span> <span class="o">=</span> <span class="n">others</span> <span class="o">+</span> <span class="p">[</span><span class="n">gaussian</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">to_be_combined</span> <span class="o">=</span> <span class="n">others</span>
        <span class="c1"># turn all distributions into numerical distributions!</span>
        <span class="n">numerical</span> <span class="o">=</span> <span class="p">[</span><span class="n">NumericalDistribution</span><span class="o">.</span><span class="n">from_pd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">to_be_combined</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">_combine_numerical</span><span class="p">(</span><span class="n">numerical</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">weighted_average</span><span class="p">(</span><span class="n">central_values</span><span class="p">,</span> <span class="n">standard_deviations</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the central value and standard deviation of the weighted average</span>
<span class="sd">    if a set of normal distributions specified by a list of central values</span>
<span class="sd">    and standard deviations&quot;&quot;&quot;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">central_values</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">standard_deviations</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">standard_deviations</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">c</span><span class="p">,</span> <span class="n">u</span>


<span class="k">def</span> <span class="nf">_combine_gaussians</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">):</span>
    <span class="c1"># if there&#39;s just one: return it immediately</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">probability_distributions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">NormalDistribution</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">),</span> \
        <span class="s2">&quot;Distributions should all be instances of NormalDistribution&quot;</span>
    <span class="n">central_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">central_value</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">]</span>
    <span class="n">standard_deviations</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">]</span>
    <span class="n">c</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">weighted_average</span><span class="p">(</span><span class="n">central_values</span><span class="p">,</span> <span class="n">standard_deviations</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">NormalDistribution</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">standard_deviation</span><span class="o">=</span><span class="n">u</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_combine_numerical</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">probability_distributions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">NumericalDistribution</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">),</span> \
        <span class="s2">&quot;Distributions should all be instances of NumericalDistribution&quot;</span>
    <span class="n">supports</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">support</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">])</span>
    <span class="n">support</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">supports</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">supports</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">support</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">support</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Numerical distributions to not have overlapping support&quot;</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">support</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">support</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nsteps</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">pd</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">NumericalDistribution</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_combine_distributions_multivariate</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">):</span>
    <span class="c1"># if there&#39;s just one: return it immediately</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">probability_distributions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># all normal dists</span>
    <span class="n">gaussians</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">MultivariateNormalDistribution</span><span class="p">)]</span>

    <span class="c1"># all other univariate dists</span>
    <span class="n">others</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span>
              <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">MultivariateNormalDistribution</span><span class="p">)]</span>

    <span class="c1"># let&#39;s combine the normal distributions into 1</span>
    <span class="k">if</span> <span class="n">gaussians</span><span class="p">:</span>
        <span class="n">gaussian</span> <span class="o">=</span> <span class="n">_combine_multivariate_gaussians</span><span class="p">(</span><span class="n">gaussians</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">gaussians</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">others</span><span class="p">:</span>
        <span class="c1"># if there are only the gaussians, we are done.</span>
        <span class="k">return</span> <span class="n">gaussian</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># otherwise, we need to combine the (combined) gaussian with the others</span>
        <span class="k">if</span> <span class="n">gaussians</span><span class="p">:</span>
            <span class="n">to_be_combined</span> <span class="o">=</span> <span class="n">others</span> <span class="o">+</span> <span class="p">[</span><span class="n">gaussian</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">to_be_combined</span> <span class="o">=</span> <span class="n">others</span>
        <span class="c1"># turn all distributions into numerical distributions!</span>
        <span class="n">numerical</span> <span class="o">=</span> <span class="p">[</span><span class="n">MultivariateNumericalDistribution</span><span class="o">.</span><span class="n">from_pd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">to_be_combined</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">_combine_multivariate_numerical</span><span class="p">(</span><span class="n">numerical</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_combine_multivariate_gaussians</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">MultivariateNormalDistribution</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">),</span> \
        <span class="s2">&quot;Distributions should all be instances of MultivariateNormalDistribution&quot;</span>
    <span class="c1"># covariances: [Sigma_1, Sigma_2, ...]</span>
    <span class="c1"># means: [x_1, x_2, ...]</span>
    <span class="c1"># weights_ [W_1, W_2, ...] where W_i = (Sigma_i)^(-1)</span>
    <span class="c1"># weighted covariance is  (W_1 + W_2 + ...)^(-1) = Sigma</span>
    <span class="c1"># weigted mean is  Sigma.(W_1.x_1 + W_2.x_2 + ...) = x</span>
    <span class="n">covariances</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">covariance</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">]</span>
    <span class="n">means</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">central_value</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">]</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">covariances</span><span class="p">]</span>
    <span class="n">weighted_covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">weighted_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">weighted_covariance</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
        <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">means</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">means</span><span class="p">))],</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">MultivariateNormalDistribution</span><span class="p">(</span><span class="n">weighted_mean</span><span class="p">,</span>
                                          <span class="n">covariance</span><span class="o">=</span><span class="n">weighted_covariance</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_combine_multivariate_numerical</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">=</span><span class="mi">200</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">MultivariateNumericalDistribution</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">),</span> \
        <span class="s2">&quot;Distributions should all be instances of MultivariateNumericalDistribution&quot;</span>
    <span class="n">supports</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">d</span><span class="o">.</span><span class="n">support</span> <span class="k">for</span> <span class="n">d</span>  <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">])</span>
    <span class="n">xi_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">supports</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">xi_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">supports</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">xi_min</span> <span class="o">&lt;</span> <span class="n">xi_max</span><span class="p">),</span> \
        <span class="sd">&quot;&quot;&quot;Support of the multivariate distributions vanishes.&quot;&quot;&quot;</span>
    <span class="n">ndim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
    <span class="n">_xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xi_min</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xi_max</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nsteps</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">)])</span>
    <span class="n">_xlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="o">*</span><span class="n">_xi</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ndim</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">**</span><span class="n">ndim</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>
    <span class="kn">import</span> <span class="nn">operator</span>
    <span class="n">_ylist</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">mul</span><span class="p">,</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">_xlist</span><span class="p">))</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">_y</span> <span class="o">=</span> <span class="n">_ylist</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">nsteps</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">MultivariateNumericalDistribution</span><span class="p">(</span><span class="n">_xi</span><span class="p">,</span> <span class="n">_y</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">dict2dist</span><span class="p">(</span><span class="n">constraint_dict</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get a list of probability distributions from a list of dictionaries</span>
<span class="sd">    (or a single dictionary) specifying the distributions.</span>

<span class="sd">    Arguments:</span>

<span class="sd">    - constraint_dict: dictionary or list of several dictionaries of the</span>
<span class="sd">      form `{&#39;distribution&#39;: &#39;distribution_name&#39;, &#39;arg1&#39;: val1, ...}`, where</span>
<span class="sd">      &#39;distribution_name&#39; is a string name associated to each probability</span>
<span class="sd">      distribution (see `class_from_string`)</span>
<span class="sd">      and `&#39;arg1&#39;`, `val1` are argument/value pairs of the arguments of</span>
<span class="sd">      the distribution class&#39;s constructor (e.g.`central_value`,</span>
<span class="sd">      `standard_deviation` for a normal distribution).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">constraint_dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">dict_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">constraint_dict</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dict_list</span> <span class="o">=</span> <span class="n">constraint_dict</span>
    <span class="n">pds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span> <span class="nf">convertv</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
        <span class="c1"># convert v to float if possible</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dict_list</span><span class="p">:</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">class_from_string</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]]</span>
        <span class="n">pds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dist</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">convertv</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span><span class="o">!=</span><span class="s1">&#39;distribution&#39;</span><span class="p">}))</span>
    <span class="k">return</span> <span class="n">pds</span>


<span class="c1"># this dictionary is used for parsing low-level distribution definitions</span>
<span class="c1"># in YAML files. A string name is associated to every (relevant) distribution.</span>
<span class="n">class_from_string</span> <span class="o">=</span> <span class="p">{</span> <span class="n">c</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">():</span> <span class="n">c</span>
                      <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ProbabilityDistribution</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span> <span class="p">}</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">
    <h2 class="section-title" id="header-variables">Module variables</h2>
      <div class="item">
      <p id="flavio.statistics.probability.class_from_string" class="name">var <span class="ident">class_from_string</span></p>
      
  
  <div class="source_cont">
</div>

      </div>

    <h2 class="section-title" id="header-functions">Functions</h2>
      
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.combine_distributions">
    <p>def <span class="ident">combine_distributions</span>(</p><p>probability_distributions)</p>
    </div>
    

    
  
    <div class="desc"><p>Combine a set of probability distributions by multiplying the PDFs.</p>
<p><code>probability_distributions</code> must be a list of instances of descendants of
<code>ProbabilityDistribution</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.combine_distributions', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.combine_distributions" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">combine_distributions</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Combine a set of probability distributions by multiplying the PDFs.</span>

<span class="sd">    `probability_distributions` must be a list of instances of descendants of</span>
<span class="sd">    `ProbabilityDistribution`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">dim</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="c1"># 1 for floats and length for arrays</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="n">dim</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">d</span> <span class="o">==</span> <span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dims</span><span class="p">]),</span> <span class="s2">&quot;All distributions must have the same number of dimensions&quot;</span>
    <span class="k">if</span> <span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_combine_distributions_univariate</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_combine_distributions_multivariate</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.convolve_distributions">
    <p>def <span class="ident">convolve_distributions</span>(</p><p>probability_distributions, central_values=&#39;same&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Combine a set of probability distributions by convoluting the PDFs.</p>
<p>This function can be used in two different ways:</p>
<ul>
<li>for <code>central_values='same'</code>, it can be used to combine uncertainties on a
single parameter/observable expressed in terms of probability distributions
with the same central value.</li>
<li>for <code>central_values='sum'</code>, it can be used to determine the probability
distribution of a sum of random variables.</li>
</ul>
<p>The only difference between the two cases is a shift: for 'same', the
central value of the convolution is the same as the original central value,
for 'sum', it is the sum of the individual central values.</p>
<p><code>probability_distributions</code> must be a list of instances of descendants of
<code>ProbabilityDistribution</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.convolve_distributions', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.convolve_distributions" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">convolve_distributions</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">,</span> <span class="n">central_values</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Combine a set of probability distributions by convoluting the PDFs.</span>

<span class="sd">    This function can be used in two different ways:</span>

<span class="sd">    - for `central_values=&#39;same&#39;`, it can be used to combine uncertainties on a</span>
<span class="sd">    single parameter/observable expressed in terms of probability distributions</span>
<span class="sd">    with the same central value.</span>
<span class="sd">    - for `central_values=&#39;sum&#39;`, it can be used to determine the probability</span>
<span class="sd">    distribution of a sum of random variables.</span>

<span class="sd">    The only difference between the two cases is a shift: for &#39;same&#39;, the</span>
<span class="sd">    central value of the convolution is the same as the original central value,</span>
<span class="sd">    for &#39;sum&#39;, it is the sum of the individual central values.</span>

<span class="sd">    `probability_distributions` must be a list of instances of descendants of</span>
<span class="sd">    `ProbabilityDistribution`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">central_values</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;central_values must be either &#39;same&#39; or &#39;sum&#39;&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">dim</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="c1"># 1 for floats and length for arrays</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="n">dim</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probability_distributions</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">d</span> <span class="o">==</span> <span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dims</span><span class="p">]),</span> <span class="s2">&quot;All distributions must have the same number of dimensions&quot;</span>
    <span class="k">if</span> <span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_convolve_distributions_univariate</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">,</span> <span class="n">central_values</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_convolve_distributions_multivariate</span><span class="p">(</span><span class="n">probability_distributions</span><span class="p">,</span> <span class="n">central_values</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.dict2dist">
    <p>def <span class="ident">dict2dist</span>(</p><p>constraint_dict)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a list of probability distributions from a list of dictionaries
(or a single dictionary) specifying the distributions.</p>
<p>Arguments:</p>
<ul>
<li>constraint_dict: dictionary or list of several dictionaries of the
  form <code>{'distribution': 'distribution_name', 'arg1': val1, ...}</code>, where
  'distribution_name' is a string name associated to each probability
  distribution (see <code>class_from_string</code>)
  and <code>'arg1'</code>, <code>val1</code> are argument/value pairs of the arguments of
  the distribution class's constructor (e.g.<code>central_value</code>,
  <code>standard_deviation</code> for a normal distribution).</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.dict2dist', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.dict2dist" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dict2dist</span><span class="p">(</span><span class="n">constraint_dict</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get a list of probability distributions from a list of dictionaries</span>
<span class="sd">    (or a single dictionary) specifying the distributions.</span>

<span class="sd">    Arguments:</span>

<span class="sd">    - constraint_dict: dictionary or list of several dictionaries of the</span>
<span class="sd">      form `{&#39;distribution&#39;: &#39;distribution_name&#39;, &#39;arg1&#39;: val1, ...}`, where</span>
<span class="sd">      &#39;distribution_name&#39; is a string name associated to each probability</span>
<span class="sd">      distribution (see `class_from_string`)</span>
<span class="sd">      and `&#39;arg1&#39;`, `val1` are argument/value pairs of the arguments of</span>
<span class="sd">      the distribution class&#39;s constructor (e.g.`central_value`,</span>
<span class="sd">      `standard_deviation` for a normal distribution).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">constraint_dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">dict_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">constraint_dict</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dict_list</span> <span class="o">=</span> <span class="n">constraint_dict</span>
    <span class="n">pds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span> <span class="nf">convertv</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
        <span class="c1"># convert v to float if possible</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dict_list</span><span class="p">:</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">class_from_string</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]]</span>
        <span class="n">pds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dist</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">convertv</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span><span class="o">!=</span><span class="s1">&#39;distribution&#39;</span><span class="p">}))</span>
    <span class="k">return</span> <span class="n">pds</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.string_to_class">
    <p>def <span class="ident">string_to_class</span>(</p><p>string)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a ProbabilityDistribution subclass from a string. This can
either be the class name itself or a string in underscore format
as returned from <code>class_to_string</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.string_to_class', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.string_to_class" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">string_to_class</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a ProbabilityDistribution subclass from a string. This can</span>
<span class="sd">    either be the class name itself or a string in underscore format</span>
<span class="sd">    as returned from `class_to_string`.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">eval</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ProbabilityDistribution</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span> <span class="o">==</span> <span class="n">string</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">c</span>
    <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;Distribution &quot;</span> <span class="o">+</span> <span class="n">string</span> <span class="o">+</span> <span class="s2">&quot; not found.&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.weighted_average">
    <p>def <span class="ident">weighted_average</span>(</p><p>central_values, standard_deviations)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the central value and standard deviation of the weighted average
if a set of normal distributions specified by a list of central values
and standard deviations</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.weighted_average', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.weighted_average" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">weighted_average</span><span class="p">(</span><span class="n">central_values</span><span class="p">,</span> <span class="n">standard_deviations</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the central value and standard deviation of the weighted average</span>
<span class="sd">    if a set of normal distributions specified by a list of central values</span>
<span class="sd">    and standard deviations&quot;&quot;&quot;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">central_values</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">standard_deviations</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">standard_deviations</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">c</span><span class="p">,</span> <span class="n">u</span>
</pre></div>

  </div>
</div>

  </div>
  

    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="flavio.statistics.probability.AsymmetricNormalDistribution" class="name">class <span class="ident">AsymmetricNormalDistribution</span></p>
      
  
    <div class="desc"><p>An asymmetric normal distribution obtained by gluing together two
half-Gaussians and demanding the PDF to be continuous.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.AsymmetricNormalDistribution', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.AsymmetricNormalDistribution" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">AsymmetricNormalDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An asymmetric normal distribution obtained by gluing together two</span>
<span class="sd">    half-Gaussians and demanding the PDF to be continuous.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">right_deviation</span><span class="p">,</span> <span class="n">left_deviation</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - central_value: mode of the distribution (not equal to its mean!)</span>
<span class="sd">        - right_deviation: standard deviation of the upper half-Gaussian</span>
<span class="sd">        - left_deviation: standard deviation of the lower half-Gaussian</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span>
                         <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">central_value</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">left_deviation</span><span class="p">,</span>
                                  <span class="n">central_value</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">right_deviation</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">right_deviation</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">left_deviation</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Left and right standard deviations must be positive numbers&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_deviation</span> <span class="o">=</span> <span class="n">right_deviation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_deviation</span> <span class="o">=</span> <span class="n">left_deviation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_right</span> <span class="o">=</span> <span class="n">normal_pdf</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_deviation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_left</span> <span class="o">=</span> <span class="n">normal_pdf</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.AsymmetricNormalDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">right_deviation</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">left_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)])</span>

    <span class="k">def</span> <span class="nf">_get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">()</span>
        <span class="n">a</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left_deviation</span> <span class="o">/</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">right_deviation</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_deviation</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_deviation</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_deviation</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="n">x</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># values of the PDF at the central value</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">:</span>
            <span class="c1"># left-hand side: scale factor</span>
            <span class="n">r</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_right</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_left</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_right</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">+</span> <span class="n">normal_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_deviation</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># left-hand side: scale factor</span>
            <span class="n">r</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_left</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_left</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_right</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">+</span> <span class="n">normal_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">_lpvect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_lpvect</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_deviation</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_deviation</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.statistics.probability.AsymmetricNormalDistribution">AsymmetricNormalDistribution</a></li>
          <li><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.AsymmetricNormalDistribution.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, central_value, right_deviation, left_deviation)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize the distribution.</p>
<p>Parameters:</p>
<ul>
<li>central_value: mode of the distribution (not equal to its mean!)</li>
<li>right_deviation: standard deviation of the upper half-Gaussian</li>
<li>left_deviation: standard deviation of the lower half-Gaussian</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.AsymmetricNormalDistribution.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.AsymmetricNormalDistribution.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">right_deviation</span><span class="p">,</span> <span class="n">left_deviation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - central_value: mode of the distribution (not equal to its mean!)</span>
<span class="sd">    - right_deviation: standard deviation of the upper half-Gaussian</span>
<span class="sd">    - left_deviation: standard deviation of the lower half-Gaussian</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span>
                     <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">central_value</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">left_deviation</span><span class="p">,</span>
                              <span class="n">central_value</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">right_deviation</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">right_deviation</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">left_deviation</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Left and right standard deviations must be positive numbers&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">right_deviation</span> <span class="o">=</span> <span class="n">right_deviation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">left_deviation</span> <span class="o">=</span> <span class="n">left_deviation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p_right</span> <span class="o">=</span> <span class="n">normal_pdf</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_deviation</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p_left</span> <span class="o">=</span> <span class="n">normal_pdf</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_deviation</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.AsymmetricNormalDistribution.delta_logpdf">
    <p>def <span class="ident">delta_logpdf</span>(</p><p>self, x, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.AsymmetricNormalDistribution.delta_logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.AsymmetricNormalDistribution.delta_logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.AsymmetricNormalDistribution.get_central">
    <p>def <span class="ident">get_central</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.AsymmetricNormalDistribution.get_central', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.AsymmetricNormalDistribution.get_central" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.AsymmetricNormalDistribution.get_dict">
    <p>def <span class="ident">get_dict</span>(</p><p>self, distribution=False, iterate=False, arraytolist=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get an ordered dictionary with arguments and values needed to
the instantiate the distribution.</p>
<p>Optional arguments (default to False):</p>
<ul>
<li><code>distribution</code>: add a 'distribution' key to the dictionary with the
value being the string representation of the distribution's name
(e.g. 'asymmetric_normal').</li>
<li><code>iterate</code>: If ProbabilityDistribution instances are among the
arguments (e.g. for KernelDensityEstimate), return the instance's
get_dict instead of the instance as value.</li>
<li><code>arraytolist</code>: convert numpy arrays to lists</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.AsymmetricNormalDistribution.get_dict', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.AsymmetricNormalDistribution.get_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">    the instantiate the distribution.</span>
<span class="sd">    Optional arguments (default to False):</span>
<span class="sd">    - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">    value being the string representation of the distribution&#39;s name</span>
<span class="sd">    (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">    - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">    arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">    get_dict instead of the instance as value.</span>
<span class="sd">    - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
    <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
        <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
    <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">od</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.AsymmetricNormalDistribution.get_error_left">
    <p>def <span class="ident">get_error_left</span>(</p><p>self, nsigma=1, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.AsymmetricNormalDistribution.get_error_left', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.AsymmetricNormalDistribution.get_error_left" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_deviation</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.AsymmetricNormalDistribution.get_error_right">
    <p>def <span class="ident">get_error_right</span>(</p><p>self, nsigma=1, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.AsymmetricNormalDistribution.get_error_right', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.AsymmetricNormalDistribution.get_error_right" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">right_deviation</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.AsymmetricNormalDistribution.get_random">
    <p>def <span class="ident">get_random</span>(</p><p>self, size=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.AsymmetricNormalDistribution.get_random', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.AsymmetricNormalDistribution.get_random" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)])</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.AsymmetricNormalDistribution.get_yaml">
    <p>def <span class="ident">get_yaml</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a YAML string representing the dictionary returned by the
get_dict method.</p>
<p>Arguments will be passed to <code>yaml.dump</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.AsymmetricNormalDistribution.get_yaml', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.AsymmetricNormalDistribution.get_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">    get_dict method.</span>
<span class="sd">    Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
    <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.AsymmetricNormalDistribution.logpdf">
    <p>def <span class="ident">logpdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.AsymmetricNormalDistribution.logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.AsymmetricNormalDistribution.logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">_lpvect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_lpvect</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.statistics.probability.AsymmetricNormalDistribution.error_left" class="name">var <span class="ident">error_left</span></p>
            

            
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.AsymmetricNormalDistribution.error_right" class="name">var <span class="ident">error_right</span></p>
            

            
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.AsymmetricNormalDistribution.left_deviation" class="name">var <span class="ident">left_deviation</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.AsymmetricNormalDistribution.p_left" class="name">var <span class="ident">p_left</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.AsymmetricNormalDistribution.p_right" class="name">var <span class="ident">p_right</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.AsymmetricNormalDistribution.right_deviation" class="name">var <span class="ident">right_deviation</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.AsymmetricNormalDistribution.class_to_string">
    <p>def <span class="ident">class_to_string</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a string name for a given ProbabilityDistribution subclass.</p>
<p>This converts camel case to underscore and removes the word
'distribution'.</p>
<p>Example: class_to_string(AsymmetricNormalDistribution) returns
'asymmetric_normal'.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.AsymmetricNormalDistribution.class_to_string', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.AsymmetricNormalDistribution.class_to_string" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>
<span class="sd">    This converts camel case to underscore and removes the word</span>
<span class="sd">    &#39;distribution&#39;.</span>
<span class="sd">    Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">    &#39;asymmetric_normal&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.AsymmetricNormalDistribution.get_subclasses">
    <p>def <span class="ident">get_subclasses</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Return all subclasses (including subclasses of subclasses).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.AsymmetricNormalDistribution.get_subclasses', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.AsymmetricNormalDistribution.get_subclasses" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">subclass</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="flavio.statistics.probability.DeltaDistribution" class="name">class <span class="ident">DeltaDistribution</span></p>
      
  
    <div class="desc"><p>Delta Distrubution that is non-vanishing only at a single point.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.DeltaDistribution', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.DeltaDistribution" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">DeltaDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Delta Distrubution that is non-vanishing only at a single point.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - central_value: point where the PDF does not vanish.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span> <span class="n">central_value</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.DeltaDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">0.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">y</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">y</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.statistics.probability.DeltaDistribution">DeltaDistribution</a></li>
          <li><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.DeltaDistribution.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, central_value)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize the distribution.</p>
<p>Parameters:</p>
<ul>
<li>central_value: point where the PDF does not vanish.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.DeltaDistribution.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.DeltaDistribution.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - central_value: point where the PDF does not vanish.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span> <span class="n">central_value</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.DeltaDistribution.delta_logpdf">
    <p>def <span class="ident">delta_logpdf</span>(</p><p>self, x, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.DeltaDistribution.delta_logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.DeltaDistribution.delta_logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.DeltaDistribution.get_central">
    <p>def <span class="ident">get_central</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.DeltaDistribution.get_central', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.DeltaDistribution.get_central" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.DeltaDistribution.get_dict">
    <p>def <span class="ident">get_dict</span>(</p><p>self, distribution=False, iterate=False, arraytolist=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get an ordered dictionary with arguments and values needed to
the instantiate the distribution.</p>
<p>Optional arguments (default to False):</p>
<ul>
<li><code>distribution</code>: add a 'distribution' key to the dictionary with the
value being the string representation of the distribution's name
(e.g. 'asymmetric_normal').</li>
<li><code>iterate</code>: If ProbabilityDistribution instances are among the
arguments (e.g. for KernelDensityEstimate), return the instance's
get_dict instead of the instance as value.</li>
<li><code>arraytolist</code>: convert numpy arrays to lists</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.DeltaDistribution.get_dict', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.DeltaDistribution.get_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">    the instantiate the distribution.</span>
<span class="sd">    Optional arguments (default to False):</span>
<span class="sd">    - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">    value being the string representation of the distribution&#39;s name</span>
<span class="sd">    (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">    - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">    arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">    get_dict instead of the instance as value.</span>
<span class="sd">    - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
    <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
        <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
    <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">od</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.DeltaDistribution.get_error_left">
    <p>def <span class="ident">get_error_left</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.DeltaDistribution.get_error_left', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.DeltaDistribution.get_error_left" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">0</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.DeltaDistribution.get_error_right">
    <p>def <span class="ident">get_error_right</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.DeltaDistribution.get_error_right', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.DeltaDistribution.get_error_right" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">0</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.DeltaDistribution.get_random">
    <p>def <span class="ident">get_random</span>(</p><p>self, size=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.DeltaDistribution.get_random', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.DeltaDistribution.get_random" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.DeltaDistribution.get_yaml">
    <p>def <span class="ident">get_yaml</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a YAML string representing the dictionary returned by the
get_dict method.</p>
<p>Arguments will be passed to <code>yaml.dump</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.DeltaDistribution.get_yaml', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.DeltaDistribution.get_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">    get_dict method.</span>
<span class="sd">    Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
    <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.DeltaDistribution.logpdf">
    <p>def <span class="ident">logpdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.DeltaDistribution.logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.DeltaDistribution.logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">y</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">y</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.statistics.probability.DeltaDistribution.error_left" class="name">var <span class="ident">error_left</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></code>.<code><a href="#flavio.statistics.probability.ProbabilityDistribution.error_left">error_left</a></code>
    </p>

            
  
    <div class="desc inherited"><p>Return the lower error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.DeltaDistribution.error_right" class="name">var <span class="ident">error_right</span></p>
            

            
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.DeltaDistribution.class_to_string">
    <p>def <span class="ident">class_to_string</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a string name for a given ProbabilityDistribution subclass.</p>
<p>This converts camel case to underscore and removes the word
'distribution'.</p>
<p>Example: class_to_string(AsymmetricNormalDistribution) returns
'asymmetric_normal'.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.DeltaDistribution.class_to_string', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.DeltaDistribution.class_to_string" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>
<span class="sd">    This converts camel case to underscore and removes the word</span>
<span class="sd">    &#39;distribution&#39;.</span>
<span class="sd">    Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">    &#39;asymmetric_normal&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.DeltaDistribution.get_subclasses">
    <p>def <span class="ident">get_subclasses</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Return all subclasses (including subclasses of subclasses).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.DeltaDistribution.get_subclasses', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.DeltaDistribution.get_subclasses" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">subclass</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="flavio.statistics.probability.GammaDistribution" class="name">class <span class="ident">GammaDistribution</span></p>
      
  
    <div class="desc"><p>A Gamma distribution defined like the <code>gamma</code> distribution in
<code>scipy.stats</code> (with parameters <code>a</code>, <code>loc</code>, <code>scale</code>).</p>
<p>The <code>central_value</code> attribute returns the location of the mode.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistribution', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistribution" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">GammaDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;A Gamma distribution defined like the `gamma` distribution in</span>
<span class="sd">    `scipy.stats` (with parameters `a`, `loc`, `scale`).</span>

<span class="sd">    The `central_value` attribute returns the location of the mode.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">loc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;loc must be negative or zero&quot;</span><span class="p">)</span>
        <span class="c1"># &quot;frozen&quot; scipy distribution object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="n">loc</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">scale</span>
        <span class="c1"># support extends until the CDF is roughly &quot;6 sigma&quot;</span>
        <span class="n">support_limit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">2e-9</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="c1"># the mode</span>
                         <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">support_limit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="n">loc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.GammaDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_find_error_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">):</span>
        <span class="c1"># find the value of the CDF at the position of the left boundary</span>
        <span class="c1"># of the `confidence_level`% CL range by demanding that the value</span>
        <span class="c1"># of the PDF is the same at the two boundaries</span>
        <span class="k">def</span> <span class="nf">x_left</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">x_right</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">diff_logpdf</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="n">logpdf_x_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x_left</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
            <span class="n">logpdf_x_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x_right</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">logpdf_x_left</span> <span class="o">-</span> <span class="n">logpdf_x_right</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="n">diff_logpdf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="o">-</span><span class="mf">1e-6</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.statistics.probability.GammaDistribution">GammaDistribution</a></li>
          <li><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistribution.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, a, loc, scale)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistribution.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistribution.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">loc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;loc must be negative or zero&quot;</span><span class="p">)</span>
    <span class="c1"># &quot;frozen&quot; scipy distribution object</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="n">loc</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">scale</span>
    <span class="c1"># support extends until the CDF is roughly &quot;6 sigma&quot;</span>
    <span class="n">support_limit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">2e-9</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="c1"># the mode</span>
                     <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">support_limit</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="n">loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistribution.cdf">
    <p>def <span class="ident">cdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistribution.cdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistribution.cdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistribution.delta_logpdf">
    <p>def <span class="ident">delta_logpdf</span>(</p><p>self, x, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistribution.delta_logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistribution.delta_logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistribution.get_central">
    <p>def <span class="ident">get_central</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistribution.get_central', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistribution.get_central" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistribution.get_dict">
    <p>def <span class="ident">get_dict</span>(</p><p>self, distribution=False, iterate=False, arraytolist=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get an ordered dictionary with arguments and values needed to
the instantiate the distribution.</p>
<p>Optional arguments (default to False):</p>
<ul>
<li><code>distribution</code>: add a 'distribution' key to the dictionary with the
value being the string representation of the distribution's name
(e.g. 'asymmetric_normal').</li>
<li><code>iterate</code>: If ProbabilityDistribution instances are among the
arguments (e.g. for KernelDensityEstimate), return the instance's
get_dict instead of the instance as value.</li>
<li><code>arraytolist</code>: convert numpy arrays to lists</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistribution.get_dict', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistribution.get_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">    the instantiate the distribution.</span>
<span class="sd">    Optional arguments (default to False):</span>
<span class="sd">    - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">    value being the string representation of the distribution&#39;s name</span>
<span class="sd">    (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">    - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">    arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">    get_dict instead of the instance as value.</span>
<span class="sd">    - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
    <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
        <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
    <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">od</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistribution.get_error_left">
    <p>def <span class="ident">get_error_left</span>(</p><p>self, nsigma=1, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistribution.get_error_left', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistribution.get_error_left" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistribution.get_error_right">
    <p>def <span class="ident">get_error_right</span>(</p><p>self, nsigma=1, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistribution.get_error_right', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistribution.get_error_right" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistribution.get_random">
    <p>def <span class="ident">get_random</span>(</p><p>self, size)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistribution.get_random', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistribution.get_random" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistribution.get_yaml">
    <p>def <span class="ident">get_yaml</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a YAML string representing the dictionary returned by the
get_dict method.</p>
<p>Arguments will be passed to <code>yaml.dump</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistribution.get_yaml', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistribution.get_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">    get_dict method.</span>
<span class="sd">    Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
    <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistribution.logpdf">
    <p>def <span class="ident">logpdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistribution.logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistribution.logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistribution.ppf">
    <p>def <span class="ident">ppf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistribution.ppf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistribution.ppf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.statistics.probability.GammaDistribution.a" class="name">var <span class="ident">a</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GammaDistribution.error_left" class="name">var <span class="ident">error_left</span></p>
            

            
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GammaDistribution.error_right" class="name">var <span class="ident">error_right</span></p>
            

            
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GammaDistribution.loc" class="name">var <span class="ident">loc</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GammaDistribution.scale" class="name">var <span class="ident">scale</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GammaDistribution.scipy_dist" class="name">var <span class="ident">scipy_dist</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistribution.class_to_string">
    <p>def <span class="ident">class_to_string</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a string name for a given ProbabilityDistribution subclass.</p>
<p>This converts camel case to underscore and removes the word
'distribution'.</p>
<p>Example: class_to_string(AsymmetricNormalDistribution) returns
'asymmetric_normal'.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistribution.class_to_string', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistribution.class_to_string" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>
<span class="sd">    This converts camel case to underscore and removes the word</span>
<span class="sd">    &#39;distribution&#39;.</span>
<span class="sd">    Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">    &#39;asymmetric_normal&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistribution.get_subclasses">
    <p>def <span class="ident">get_subclasses</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Return all subclasses (including subclasses of subclasses).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistribution.get_subclasses', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistribution.get_subclasses" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">subclass</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="flavio.statistics.probability.GammaDistributionPositive" class="name">class <span class="ident">GammaDistributionPositive</span></p>
      
  
    <div class="desc"><p>A Gamma distribution defined like the <code>gamma</code> distribution in
<code>scipy.stats</code> (with parameters <code>a</code>, <code>loc</code>, <code>scale</code>), but restricted to
positive values for x and correspondingly rescaled PDF.</p>
<p>The <code>central_value</code> attribute returns the location of the mode.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistributionPositive', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistributionPositive" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">GammaDistributionPositive</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;A Gamma distribution defined like the `gamma` distribution in</span>
<span class="sd">    `scipy.stats` (with parameters `a`, `loc`, `scale`), but restricted to</span>
<span class="sd">    positive values for x and correspondingly rescaled PDF.</span>

<span class="sd">    The `central_value` attribute returns the location of the mode.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">loc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;loc must be negative or zero&quot;</span><span class="p">)</span>
        <span class="c1"># &quot;frozen&quot; scipy distribution object (without restricting x&gt;0!)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="n">loc</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">scale</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># support extends until the CDF is roughly &quot;6 sigma&quot;, assuming x&gt;0</span>
        <span class="n">support_limit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">2e-9</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="c1"># the mode</span>
                         <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">support_limit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="n">loc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>
        <span class="c1"># scale factor for PDF to account for x&gt;0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pdf_scale</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.GammaDistributionPositive&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># some iteration necessary as discarding negative values</span>
            <span class="c1"># might lead to too small size</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">size</span><span class="p">)))</span>
            <span class="k">return</span> <span class="n">r</span><span class="p">[:</span><span class="n">size</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">[(</span><span class="n">r</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">cdf0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">cdf</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">cdf0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">cdf0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">piecewise</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span>
                    <span class="p">[</span><span class="n">x</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">cdf</span><span class="p">])</span> <span class="c1"># return 0 for negative x</span>

    <span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">cdf0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">cdf0</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span>  <span class="n">cdf0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># return -inf for negative x values</span>
        <span class="n">inf0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">piecewise</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span> <span class="p">[</span><span class="n">x</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">inf0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pdf_scale</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_find_error_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">):</span>
        <span class="c1"># find the value of the CDF at the position of the left boundary</span>
        <span class="c1"># of the `confidence_level`% CL range by demanding that the value</span>
        <span class="c1"># of the PDF is the same at the two boundaries</span>
        <span class="k">def</span> <span class="nf">x_left</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">x_right</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">diff_logpdf</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="n">logpdf_x_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x_left</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
            <span class="n">logpdf_x_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x_right</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">logpdf_x_left</span> <span class="o">-</span> <span class="n">logpdf_x_right</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="n">diff_logpdf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="o">-</span><span class="mf">1e-6</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))):</span>
            <span class="c1"># look at a one-sided 1 sigma range. If the PDF at 0</span>
            <span class="c1"># is smaller than the PDF at the boundary of this range, it means</span>
            <span class="c1"># that the left-hand error is not meaningful to define.</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
        <span class="n">one_sided_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">one_sided_error</span><span class="p">):</span>
            <span class="c1"># look at a one-sided 1 sigma range. If the PDF at 0</span>
            <span class="c1"># is smaller than the PDF at the boundary of this range, return the</span>
            <span class="c1"># boundary of the range as the right-hand error</span>
            <span class="k">return</span> <span class="n">one_sided_error</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.statistics.probability.GammaDistributionPositive">GammaDistributionPositive</a></li>
          <li><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistributionPositive.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, a, loc, scale)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistributionPositive.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistributionPositive.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">loc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;loc must be negative or zero&quot;</span><span class="p">)</span>
    <span class="c1"># &quot;frozen&quot; scipy distribution object (without restricting x&gt;0!)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="n">loc</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">scale</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># support extends until the CDF is roughly &quot;6 sigma&quot;, assuming x&gt;0</span>
    <span class="n">support_limit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">2e-9</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="c1"># the mode</span>
                     <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">support_limit</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="n">loc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>
    <span class="c1"># scale factor for PDF to account for x&gt;0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_pdf_scale</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistributionPositive.cdf">
    <p>def <span class="ident">cdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistributionPositive.cdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistributionPositive.cdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">cdf0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">cdf</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">cdf0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">cdf0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">piecewise</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span>
                <span class="p">[</span><span class="n">x</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">cdf</span><span class="p">])</span> <span class="c1"># return 0 for negative x</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistributionPositive.delta_logpdf">
    <p>def <span class="ident">delta_logpdf</span>(</p><p>self, x, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistributionPositive.delta_logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistributionPositive.delta_logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistributionPositive.get_central">
    <p>def <span class="ident">get_central</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistributionPositive.get_central', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistributionPositive.get_central" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistributionPositive.get_dict">
    <p>def <span class="ident">get_dict</span>(</p><p>self, distribution=False, iterate=False, arraytolist=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get an ordered dictionary with arguments and values needed to
the instantiate the distribution.</p>
<p>Optional arguments (default to False):</p>
<ul>
<li><code>distribution</code>: add a 'distribution' key to the dictionary with the
value being the string representation of the distribution's name
(e.g. 'asymmetric_normal').</li>
<li><code>iterate</code>: If ProbabilityDistribution instances are among the
arguments (e.g. for KernelDensityEstimate), return the instance's
get_dict instead of the instance as value.</li>
<li><code>arraytolist</code>: convert numpy arrays to lists</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistributionPositive.get_dict', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistributionPositive.get_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">    the instantiate the distribution.</span>
<span class="sd">    Optional arguments (default to False):</span>
<span class="sd">    - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">    value being the string representation of the distribution&#39;s name</span>
<span class="sd">    (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">    - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">    arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">    get_dict instead of the instance as value.</span>
<span class="sd">    - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
    <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
        <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
    <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">od</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistributionPositive.get_error_left">
    <p>def <span class="ident">get_error_left</span>(</p><p>self, nsigma=1, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistributionPositive.get_error_left', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistributionPositive.get_error_left" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))):</span>
        <span class="c1"># look at a one-sided 1 sigma range. If the PDF at 0</span>
        <span class="c1"># is smaller than the PDF at the boundary of this range, it means</span>
        <span class="c1"># that the left-hand error is not meaningful to define.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistributionPositive.get_error_right">
    <p>def <span class="ident">get_error_right</span>(</p><p>self, nsigma=1, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistributionPositive.get_error_right', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistributionPositive.get_error_right" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
    <span class="n">one_sided_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">one_sided_error</span><span class="p">):</span>
        <span class="c1"># look at a one-sided 1 sigma range. If the PDF at 0</span>
        <span class="c1"># is smaller than the PDF at the boundary of this range, return the</span>
        <span class="c1"># boundary of the range as the right-hand error</span>
        <span class="k">return</span> <span class="n">one_sided_error</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistributionPositive.get_random">
    <p>def <span class="ident">get_random</span>(</p><p>self, size=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistributionPositive.get_random', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistributionPositive.get_random" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># some iteration necessary as discarding negative values</span>
        <span class="c1"># might lead to too small size</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">size</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">[:</span><span class="n">size</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistributionPositive.get_yaml">
    <p>def <span class="ident">get_yaml</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a YAML string representing the dictionary returned by the
get_dict method.</p>
<p>Arguments will be passed to <code>yaml.dump</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistributionPositive.get_yaml', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistributionPositive.get_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">    get_dict method.</span>
<span class="sd">    Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
    <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistributionPositive.logpdf">
    <p>def <span class="ident">logpdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistributionPositive.logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistributionPositive.logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="c1"># return -inf for negative x values</span>
    <span class="n">inf0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">piecewise</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span> <span class="p">[</span><span class="n">x</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">inf0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pdf_scale</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistributionPositive.ppf">
    <p>def <span class="ident">ppf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistributionPositive.ppf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistributionPositive.ppf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">cdf0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">cdf0</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span>  <span class="n">cdf0</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.statistics.probability.GammaDistributionPositive.a" class="name">var <span class="ident">a</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GammaDistributionPositive.error_left" class="name">var <span class="ident">error_left</span></p>
            

            
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GammaDistributionPositive.error_right" class="name">var <span class="ident">error_right</span></p>
            

            
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GammaDistributionPositive.loc" class="name">var <span class="ident">loc</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GammaDistributionPositive.scale" class="name">var <span class="ident">scale</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GammaDistributionPositive.scipy_dist" class="name">var <span class="ident">scipy_dist</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistributionPositive.class_to_string">
    <p>def <span class="ident">class_to_string</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a string name for a given ProbabilityDistribution subclass.</p>
<p>This converts camel case to underscore and removes the word
'distribution'.</p>
<p>Example: class_to_string(AsymmetricNormalDistribution) returns
'asymmetric_normal'.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistributionPositive.class_to_string', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistributionPositive.class_to_string" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>
<span class="sd">    This converts camel case to underscore and removes the word</span>
<span class="sd">    &#39;distribution&#39;.</span>
<span class="sd">    Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">    &#39;asymmetric_normal&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaDistributionPositive.get_subclasses">
    <p>def <span class="ident">get_subclasses</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Return all subclasses (including subclasses of subclasses).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaDistributionPositive.get_subclasses', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaDistributionPositive.get_subclasses" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">subclass</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="flavio.statistics.probability.GammaUpperLimit" class="name">class <span class="ident">GammaUpperLimit</span></p>
      
  
    <div class="desc"><p>Gamma distribution with x restricted to be positive appropriate for
a positive quantitity obtained from a low-statistics counting experiment,
e.g. a rare decay rate, given an upper limit on x.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaUpperLimit', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaUpperLimit" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">GammaUpperLimit</span><span class="p">(</span><span class="n">GammaDistributionPositive</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Gamma distribution with x restricted to be positive appropriate for</span>
<span class="sd">    a positive quantitity obtained from a low-statistics counting experiment,</span>
<span class="sd">    e.g. a rare decay rate, given an upper limit on x.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">counts_total</span><span class="p">,</span> <span class="n">counts_background</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - counts_total: observed total number (signal and background) of counts.</span>
<span class="sd">        - counts_background: number of expected background counts, assumed to be</span>
<span class="sd">          known.</span>
<span class="sd">        - limit: upper limit on x, which is proportional (with a positive</span>
<span class="sd">          proportionality factor) to the number of signal events.</span>
<span class="sd">        - confidence_level: confidence level of the upper limit, i.e. the value</span>
<span class="sd">          of the CDF at the limit. Float between 0 and 1. Frequently used values</span>
<span class="sd">          are 0.90 and 0.95.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">confidence_level</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">confidence_level</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Confidence level should be between 0 und 1&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">limit</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The upper limit should be a positive number&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">counts_total</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;counts_total should be a positive number or zero&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">counts_background</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;counts_background should be a positive number or zero&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="n">limit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span> <span class="o">=</span> <span class="n">confidence_level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">=</span> <span class="n">counts_total</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counts_background</span> <span class="o">=</span> <span class="n">counts_background</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_a_loc_scale</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.GammaUpperLimit&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">counts_background</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">limit</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_a_loc_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert the counts and limit to the input parameters needed for</span>
<span class="sd">        GammaDistributionPositive&quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">loc_unscaled</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">counts_background</span>
        <span class="n">dist_unscaled</span> <span class="o">=</span> <span class="n">GammaDistributionPositive</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc_unscaled</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">limit_unscaled</span> <span class="o">=</span> <span class="n">dist_unscaled</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span><span class="p">)</span>
        <span class="c1"># rescale</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limit</span><span class="o">/</span><span class="n">limit_unscaled</span>
        <span class="n">loc</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">counts_background</span><span class="o">*</span><span class="n">scale</span>
        <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.statistics.probability.GammaUpperLimit">GammaUpperLimit</a></li>
          <li><a href="#flavio.statistics.probability.GammaDistributionPositive">GammaDistributionPositive</a></li>
          <li><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaUpperLimit.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, counts_total, counts_background, limit, confidence_level)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize the distribution.</p>
<p>Parameters:</p>
<ul>
<li>counts_total: observed total number (signal and background) of counts.</li>
<li>counts_background: number of expected background counts, assumed to be
  known.</li>
<li>limit: upper limit on x, which is proportional (with a positive
  proportionality factor) to the number of signal events.</li>
<li>confidence_level: confidence level of the upper limit, i.e. the value
  of the CDF at the limit. Float between 0 and 1. Frequently used values
  are 0.90 and 0.95.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaUpperLimit.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaUpperLimit.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">counts_total</span><span class="p">,</span> <span class="n">counts_background</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - counts_total: observed total number (signal and background) of counts.</span>
<span class="sd">    - counts_background: number of expected background counts, assumed to be</span>
<span class="sd">      known.</span>
<span class="sd">    - limit: upper limit on x, which is proportional (with a positive</span>
<span class="sd">      proportionality factor) to the number of signal events.</span>
<span class="sd">    - confidence_level: confidence level of the upper limit, i.e. the value</span>
<span class="sd">      of the CDF at the limit. Float between 0 and 1. Frequently used values</span>
<span class="sd">      are 0.90 and 0.95.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">confidence_level</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">confidence_level</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Confidence level should be between 0 und 1&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">limit</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The upper limit should be a positive number&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">counts_total</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;counts_total should be a positive number or zero&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">counts_background</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;counts_background should be a positive number or zero&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="n">limit</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span> <span class="o">=</span> <span class="n">confidence_level</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">=</span> <span class="n">counts_total</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">counts_background</span> <span class="o">=</span> <span class="n">counts_background</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_a_loc_scale</span><span class="p">()</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaUpperLimit.cdf">
    <p>def <span class="ident">cdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaUpperLimit.cdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaUpperLimit.cdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">cdf0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">cdf</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">cdf0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">cdf0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">piecewise</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span>
                <span class="p">[</span><span class="n">x</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">cdf</span><span class="p">])</span> <span class="c1"># return 0 for negative x</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaUpperLimit.delta_logpdf">
    <p>def <span class="ident">delta_logpdf</span>(</p><p>self, x, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaUpperLimit.delta_logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaUpperLimit.delta_logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaUpperLimit.get_central">
    <p>def <span class="ident">get_central</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaUpperLimit.get_central', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaUpperLimit.get_central" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaUpperLimit.get_dict">
    <p>def <span class="ident">get_dict</span>(</p><p>self, distribution=False, iterate=False, arraytolist=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get an ordered dictionary with arguments and values needed to
the instantiate the distribution.</p>
<p>Optional arguments (default to False):</p>
<ul>
<li><code>distribution</code>: add a 'distribution' key to the dictionary with the
value being the string representation of the distribution's name
(e.g. 'asymmetric_normal').</li>
<li><code>iterate</code>: If ProbabilityDistribution instances are among the
arguments (e.g. for KernelDensityEstimate), return the instance's
get_dict instead of the instance as value.</li>
<li><code>arraytolist</code>: convert numpy arrays to lists</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaUpperLimit.get_dict', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaUpperLimit.get_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">    the instantiate the distribution.</span>
<span class="sd">    Optional arguments (default to False):</span>
<span class="sd">    - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">    value being the string representation of the distribution&#39;s name</span>
<span class="sd">    (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">    - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">    arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">    get_dict instead of the instance as value.</span>
<span class="sd">    - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
    <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
        <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
    <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">od</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaUpperLimit.get_error_left">
    <p>def <span class="ident">get_error_left</span>(</p><p>self, nsigma=1, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaUpperLimit.get_error_left', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaUpperLimit.get_error_left" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))):</span>
        <span class="c1"># look at a one-sided 1 sigma range. If the PDF at 0</span>
        <span class="c1"># is smaller than the PDF at the boundary of this range, it means</span>
        <span class="c1"># that the left-hand error is not meaningful to define.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaUpperLimit.get_error_right">
    <p>def <span class="ident">get_error_right</span>(</p><p>self, nsigma=1, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaUpperLimit.get_error_right', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaUpperLimit.get_error_right" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
    <span class="n">one_sided_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">one_sided_error</span><span class="p">):</span>
        <span class="c1"># look at a one-sided 1 sigma range. If the PDF at 0</span>
        <span class="c1"># is smaller than the PDF at the boundary of this range, return the</span>
        <span class="c1"># boundary of the range as the right-hand error</span>
        <span class="k">return</span> <span class="n">one_sided_error</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaUpperLimit.get_random">
    <p>def <span class="ident">get_random</span>(</p><p>self, size=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaUpperLimit.get_random', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaUpperLimit.get_random" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># some iteration necessary as discarding negative values</span>
        <span class="c1"># might lead to too small size</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">size</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">[:</span><span class="n">size</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaUpperLimit.get_yaml">
    <p>def <span class="ident">get_yaml</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a YAML string representing the dictionary returned by the
get_dict method.</p>
<p>Arguments will be passed to <code>yaml.dump</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaUpperLimit.get_yaml', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaUpperLimit.get_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">    get_dict method.</span>
<span class="sd">    Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
    <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaUpperLimit.logpdf">
    <p>def <span class="ident">logpdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaUpperLimit.logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaUpperLimit.logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="c1"># return -inf for negative x values</span>
    <span class="n">inf0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">piecewise</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span> <span class="p">[</span><span class="n">x</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">inf0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pdf_scale</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaUpperLimit.ppf">
    <p>def <span class="ident">ppf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaUpperLimit.ppf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaUpperLimit.ppf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">cdf0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scipy_dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">cdf0</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span>  <span class="n">cdf0</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.statistics.probability.GammaUpperLimit.confidence_level" class="name">var <span class="ident">confidence_level</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GammaUpperLimit.counts_background" class="name">var <span class="ident">counts_background</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GammaUpperLimit.counts_total" class="name">var <span class="ident">counts_total</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GammaUpperLimit.error_left" class="name">var <span class="ident">error_left</span></p>
            

            
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GammaUpperLimit.error_right" class="name">var <span class="ident">error_right</span></p>
            

            
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GammaUpperLimit.limit" class="name">var <span class="ident">limit</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaUpperLimit.class_to_string">
    <p>def <span class="ident">class_to_string</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a string name for a given ProbabilityDistribution subclass.</p>
<p>This converts camel case to underscore and removes the word
'distribution'.</p>
<p>Example: class_to_string(AsymmetricNormalDistribution) returns
'asymmetric_normal'.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaUpperLimit.class_to_string', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaUpperLimit.class_to_string" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>
<span class="sd">    This converts camel case to underscore and removes the word</span>
<span class="sd">    &#39;distribution&#39;.</span>
<span class="sd">    Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">    &#39;asymmetric_normal&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GammaUpperLimit.get_subclasses">
    <p>def <span class="ident">get_subclasses</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Return all subclasses (including subclasses of subclasses).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GammaUpperLimit.get_subclasses', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GammaUpperLimit.get_subclasses" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">subclass</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="flavio.statistics.probability.GaussianKDE" class="name">class <span class="ident">GaussianKDE</span></p>
      
  
    <div class="desc"><p>Univariate Gaussian kernel density estimate.</p>
<p>Parameters:</p>
<ul>
<li><code>data</code>: 1D array</li>
<li><code>bandwidth</code> (optional): standard deviation of the Gaussian smoothing kernel.
   If not provided, Scott's rule is used to estimate it.</li>
<li><code>n_bins</code> (optional): number of bins used in the intermediate step. This normally
  does not have to be changed.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianKDE', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianKDE" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">GaussianKDE</span><span class="p">(</span><span class="n">KernelDensityEstimate</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Univariate Gaussian kernel density estimate.</span>

<span class="sd">    Parameters:</span>

<span class="sd">    - `data`: 1D array</span>
<span class="sd">    - `bandwidth` (optional): standard deviation of the Gaussian smoothing kernel.</span>
<span class="sd">       If not provided, Scott&#39;s rule is used to estimate it.</span>
<span class="sd">    - `n_bins` (optional): number of bins used in the intermediate step. This normally</span>
<span class="sd">      does not have to be changed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">bandwidth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bandwidth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bandwidth</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mf">5.</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bandwidth</span> <span class="o">=</span> <span class="n">bandwidth</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                         <span class="n">kernel</span> <span class="o">=</span> <span class="n">NormalDistribution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bandwidth</span><span class="p">),</span>
                         <span class="n">n_bins</span><span class="o">=</span><span class="n">n_bins</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.GaussianKDE&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bandwidth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.statistics.probability.GaussianKDE">GaussianKDE</a></li>
          <li><a href="#flavio.statistics.probability.KernelDensityEstimate">KernelDensityEstimate</a></li>
          <li><a href="#flavio.statistics.probability.NumericalDistribution">NumericalDistribution</a></li>
          <li><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianKDE.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, data, bandwidth=None, n_bins=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></code>.<code><a href="#flavio.statistics.probability.ProbabilityDistribution.__init__">__init__</a></code>
    </p>

    
  
    <div class="desc"><p>Initialize a 1D numerical distribution.</p>
<p>Parameters:</p>
<ul>
<li><code>x</code>: x-axis values. Must be a 1D array of real values in strictly
  ascending order (but not necessarily evenly spaced)</li>
<li><code>y</code>: PDF values. Must be a 1D array of real positive values with the
  same length as <code>x</code></li>
<li>central_value: if None (default), will be set to the mode of the
  distribution, i.e. the x-value where y is largest (by looking up
  the input arrays, i.e. without interpolation!)</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianKDE.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianKDE.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">bandwidth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">bandwidth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bandwidth</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mf">5.</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bandwidth</span> <span class="o">=</span> <span class="n">bandwidth</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                     <span class="n">kernel</span> <span class="o">=</span> <span class="n">NormalDistribution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bandwidth</span><span class="p">),</span>
                     <span class="n">n_bins</span><span class="o">=</span><span class="n">n_bins</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianKDE.cdf">
    <p>def <span class="ident">cdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianKDE.cdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianKDE.cdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianKDE.delta_logpdf">
    <p>def <span class="ident">delta_logpdf</span>(</p><p>self, x, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianKDE.delta_logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianKDE.delta_logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianKDE.get_central">
    <p>def <span class="ident">get_central</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianKDE.get_central', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianKDE.get_central" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianKDE.get_dict">
    <p>def <span class="ident">get_dict</span>(</p><p>self, distribution=False, iterate=False, arraytolist=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get an ordered dictionary with arguments and values needed to
the instantiate the distribution.</p>
<p>Optional arguments (default to False):</p>
<ul>
<li><code>distribution</code>: add a 'distribution' key to the dictionary with the
value being the string representation of the distribution's name
(e.g. 'asymmetric_normal').</li>
<li><code>iterate</code>: If ProbabilityDistribution instances are among the
arguments (e.g. for KernelDensityEstimate), return the instance's
get_dict instead of the instance as value.</li>
<li><code>arraytolist</code>: convert numpy arrays to lists</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianKDE.get_dict', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianKDE.get_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">    the instantiate the distribution.</span>
<span class="sd">    Optional arguments (default to False):</span>
<span class="sd">    - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">    value being the string representation of the distribution&#39;s name</span>
<span class="sd">    (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">    - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">    arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">    get_dict instead of the instance as value.</span>
<span class="sd">    - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
    <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
        <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
    <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">od</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianKDE.get_error_left">
    <p>def <span class="ident">get_error_left</span>(</p><p>self, nsigma=1, method=&#39;central&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the lower error.</p>
<p>'method' should be one of:</p>
<ul>
<li>'central' for a central interval (same probability on both sides of
  the central value)</li>
<li>'hpd' for highest posterior density, i.e. probability is larger inside
  the interval than outside</li>
<li>'limit' for a one-sided error, i.e. a lower limit</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianKDE.get_error_left', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianKDE.get_error_left" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the lower error.</span>
<span class="sd">    &#39;method&#39; should be one of:</span>
<span class="sd">    - &#39;central&#39; for a central interval (same probability on both sides of</span>
<span class="sd">      the central value)</span>
<span class="sd">    - &#39;hpd&#39; for highest posterior density, i.e. probability is larger inside</span>
<span class="sd">      the interval than outside</span>
<span class="sd">    - &#39;limit&#39; for a one-sided error, i.e. a lower limit&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;limit&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
    <span class="n">cdf_central</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
    <span class="n">err_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">cdf_central</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;central&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">err_left</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;hpd&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_error_right</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="n">err_left</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">err_left</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Method &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">method</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; unknown&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianKDE.get_error_right">
    <p>def <span class="ident">get_error_right</span>(</p><p>self, nsigma=1, method=&#39;central&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the upper error</p>
<p>'method' should be one of:</p>
<ul>
<li>'central' for a central interval (same probability on both sides of
  the central value)</li>
<li>'hpd' for highest posterior density, i.e. probability is larger inside
  the interval than outside</li>
<li>'limit' for a one-sided error, i.e. an upper limit</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianKDE.get_error_right', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianKDE.get_error_right" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the upper error</span>
<span class="sd">    &#39;method&#39; should be one of:</span>
<span class="sd">    - &#39;central&#39; for a central interval (same probability on both sides of</span>
<span class="sd">      the central value)</span>
<span class="sd">    - &#39;hpd&#39; for highest posterior density, i.e. probability is larger inside</span>
<span class="sd">      the interval than outside</span>
<span class="sd">    - &#39;limit&#39; for a one-sided error, i.e. an upper limit&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;limit&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="n">cdf_central</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
    <span class="n">err_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">cdf_central</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cdf_central</span><span class="p">)</span> <span class="o">*</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;central&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">err_right</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;hpd&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_error_left</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="n">err_right</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">err_right</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Method &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">method</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; unknown&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianKDE.get_random">
    <p>def <span class="ident">get_random</span>(</p><p>self, size=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Draw a random number from the distribution.</p>
<p>If size is not None but an integer N, return an array of N numbers.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianKDE.get_random', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianKDE.get_random" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Draw a random number from the distribution.</span>
<span class="sd">    If size is not None but an integer N, return an array of N numbers.&quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_interp</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianKDE.get_yaml">
    <p>def <span class="ident">get_yaml</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a YAML string representing the dictionary returned by the
get_dict method.</p>
<p>Arguments will be passed to <code>yaml.dump</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianKDE.get_yaml', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianKDE.get_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">    get_dict method.</span>
<span class="sd">    Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
    <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianKDE.logpdf">
    <p>def <span class="ident">logpdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianKDE.logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianKDE.logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="c1"># ignore warning from log(0)=-np.inf</span>
    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianKDE.pdf">
    <p>def <span class="ident">pdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianKDE.pdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianKDE.pdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianKDE.ppf">
    <p>def <span class="ident">ppf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianKDE.ppf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianKDE.ppf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.statistics.probability.GaussianKDE.error_left" class="name">var <span class="ident">error_left</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#flavio.statistics.probability.KernelDensityEstimate">KernelDensityEstimate</a></code>.<code><a href="#flavio.statistics.probability.KernelDensityEstimate.error_left">error_left</a></code>
    </p>

            
  
    <div class="desc inherited"><p>Return the lower error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GaussianKDE.error_right" class="name">var <span class="ident">error_right</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#flavio.statistics.probability.NumericalDistribution">NumericalDistribution</a></code>.<code><a href="#flavio.statistics.probability.NumericalDistribution.error_right">error_right</a></code>
    </p>

            
  
    <div class="desc inherited"><p>Return the upper error</p></div>
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianKDE.class_to_string">
    <p>def <span class="ident">class_to_string</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a string name for a given ProbabilityDistribution subclass.</p>
<p>This converts camel case to underscore and removes the word
'distribution'.</p>
<p>Example: class_to_string(AsymmetricNormalDistribution) returns
'asymmetric_normal'.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianKDE.class_to_string', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianKDE.class_to_string" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>
<span class="sd">    This converts camel case to underscore and removes the word</span>
<span class="sd">    &#39;distribution&#39;.</span>
<span class="sd">    Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">    &#39;asymmetric_normal&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianKDE.from_pd">
    <p>def <span class="ident">from_pd</span>(</p><p>cls, pd, nsteps=1000)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianKDE.from_pd', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianKDE.from_pd" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_pd</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pd</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pd</span><span class="p">,</span> <span class="n">NumericalDistribution</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pd</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">nsteps</span><span class="p">)</span>
    <span class="n">_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">_x</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">_y</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianKDE.get_subclasses">
    <p>def <span class="ident">get_subclasses</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Return all subclasses (including subclasses of subclasses).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianKDE.get_subclasses', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianKDE.get_subclasses" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">subclass</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="flavio.statistics.probability.GaussianUpperLimit" class="name">class <span class="ident">GaussianUpperLimit</span></p>
      
  
    <div class="desc"><p>Upper limit defined as a half-normal distribution.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianUpperLimit', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianUpperLimit" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">GaussianUpperLimit</span><span class="p">(</span><span class="n">HalfNormalDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Upper limit defined as a half-normal distribution.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - limit: value of the upper limit</span>
<span class="sd">        - confidence_level: confidence_level of the upper limit. Float between</span>
<span class="sd">          0 and 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">confidence_level</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">confidence_level</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Confidence level should be between 0 und 1&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">limit</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The upper limit should be a positive number&quot;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                         <span class="n">standard_deviation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_standard_deviation</span><span class="p">(</span><span class="n">limit</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="n">limit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span> <span class="o">=</span> <span class="n">confidence_level</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.GaussianUpperLimit&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">limit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_standard_deviation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert the confidence level into a Gaussian standard deviation&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">limit</span> <span class="o">/</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">confidence_level</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.statistics.probability.GaussianUpperLimit">GaussianUpperLimit</a></li>
          <li><a href="#flavio.statistics.probability.HalfNormalDistribution">HalfNormalDistribution</a></li>
          <li><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianUpperLimit.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, limit, confidence_level)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize the distribution.</p>
<p>Parameters:</p>
<ul>
<li>limit: value of the upper limit</li>
<li>confidence_level: confidence_level of the upper limit. Float between
  0 and 1.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianUpperLimit.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianUpperLimit.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - limit: value of the upper limit</span>
<span class="sd">    - confidence_level: confidence_level of the upper limit. Float between</span>
<span class="sd">      0 and 1.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">confidence_level</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">confidence_level</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Confidence level should be between 0 und 1&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">limit</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The upper limit should be a positive number&quot;</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                     <span class="n">standard_deviation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_standard_deviation</span><span class="p">(</span><span class="n">limit</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="n">limit</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span> <span class="o">=</span> <span class="n">confidence_level</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianUpperLimit.cdf">
    <p>def <span class="ident">cdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianUpperLimit.cdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianUpperLimit.cdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">halfnorm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span>
                                            <span class="n">loc</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span>
                                            <span class="n">scale</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">halfnorm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
                                        <span class="n">loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span>
                                        <span class="n">scale</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianUpperLimit.delta_logpdf">
    <p>def <span class="ident">delta_logpdf</span>(</p><p>self, x, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianUpperLimit.delta_logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianUpperLimit.delta_logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianUpperLimit.get_central">
    <p>def <span class="ident">get_central</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianUpperLimit.get_central', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianUpperLimit.get_central" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianUpperLimit.get_dict">
    <p>def <span class="ident">get_dict</span>(</p><p>self, distribution=False, iterate=False, arraytolist=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get an ordered dictionary with arguments and values needed to
the instantiate the distribution.</p>
<p>Optional arguments (default to False):</p>
<ul>
<li><code>distribution</code>: add a 'distribution' key to the dictionary with the
value being the string representation of the distribution's name
(e.g. 'asymmetric_normal').</li>
<li><code>iterate</code>: If ProbabilityDistribution instances are among the
arguments (e.g. for KernelDensityEstimate), return the instance's
get_dict instead of the instance as value.</li>
<li><code>arraytolist</code>: convert numpy arrays to lists</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianUpperLimit.get_dict', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianUpperLimit.get_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">    the instantiate the distribution.</span>
<span class="sd">    Optional arguments (default to False):</span>
<span class="sd">    - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">    value being the string representation of the distribution&#39;s name</span>
<span class="sd">    (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">    - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">    arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">    get_dict instead of the instance as value.</span>
<span class="sd">    - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
    <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
        <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
    <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">od</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianUpperLimit.get_error_left">
    <p>def <span class="ident">get_error_left</span>(</p><p>self, nsigma=1, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianUpperLimit.get_error_left', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianUpperLimit.get_error_left" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>  <span class="c1"># return a positive value!</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianUpperLimit.get_error_right">
    <p>def <span class="ident">get_error_right</span>(</p><p>self, nsigma=1, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianUpperLimit.get_error_right', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianUpperLimit.get_error_right" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianUpperLimit.get_random">
    <p>def <span class="ident">get_random</span>(</p><p>self, size=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianUpperLimit.get_random', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianUpperLimit.get_random" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">),</span> <span class="n">size</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianUpperLimit.get_standard_deviation">
    <p>def <span class="ident">get_standard_deviation</span>(</p><p>self, limit, confidence_level)</p>
    </div>
    

    
  
    <div class="desc"><p>Convert the confidence level into a Gaussian standard deviation</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianUpperLimit.get_standard_deviation', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianUpperLimit.get_standard_deviation" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_standard_deviation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert the confidence level into a Gaussian standard deviation&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">limit</span> <span class="o">/</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">confidence_level</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianUpperLimit.get_yaml">
    <p>def <span class="ident">get_yaml</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a YAML string representing the dictionary returned by the
get_dict method.</p>
<p>Arguments will be passed to <code>yaml.dump</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianUpperLimit.get_yaml', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianUpperLimit.get_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">    get_dict method.</span>
<span class="sd">    Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
    <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianUpperLimit.logpdf">
    <p>def <span class="ident">logpdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianUpperLimit.logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianUpperLimit.logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">_lpvect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_lpvect</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianUpperLimit.ppf">
    <p>def <span class="ident">ppf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianUpperLimit.ppf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianUpperLimit.ppf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">halfnorm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span>
                                        <span class="n">loc</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span>
                                        <span class="n">scale</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">halfnorm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
                                        <span class="n">loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span>
                                        <span class="n">scale</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.statistics.probability.GaussianUpperLimit.confidence_level" class="name">var <span class="ident">confidence_level</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GaussianUpperLimit.error_left" class="name">var <span class="ident">error_left</span></p>
            

            
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GaussianUpperLimit.error_right" class="name">var <span class="ident">error_right</span></p>
            

            
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GaussianUpperLimit.limit" class="name">var <span class="ident">limit</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianUpperLimit.class_to_string">
    <p>def <span class="ident">class_to_string</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a string name for a given ProbabilityDistribution subclass.</p>
<p>This converts camel case to underscore and removes the word
'distribution'.</p>
<p>Example: class_to_string(AsymmetricNormalDistribution) returns
'asymmetric_normal'.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianUpperLimit.class_to_string', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianUpperLimit.class_to_string" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>
<span class="sd">    This converts camel case to underscore and removes the word</span>
<span class="sd">    &#39;distribution&#39;.</span>
<span class="sd">    Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">    &#39;asymmetric_normal&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GaussianUpperLimit.get_subclasses">
    <p>def <span class="ident">get_subclasses</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Return all subclasses (including subclasses of subclasses).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GaussianUpperLimit.get_subclasses', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GaussianUpperLimit.get_subclasses" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">subclass</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="flavio.statistics.probability.GeneralGammaDistributionPositive" class="name">class <span class="ident">GeneralGammaDistributionPositive</span></p>
      
  
    <div class="desc"><p>Distribution appropriate for
a positive quantitity obtained from a low-statistics counting experiment,
e.g. a rare decay rate.
The difference to <code>GammaUpperLimit</code> is that this class also allows to
specify an uncertainty on the number of background events. The result
is a numerical distribution obtained from the convolution of a normal
distribution (for the background uncertainty) and a gamma distribution,
restricted to positive values.
In contrast to <code>GammaUpperLimit</code>, the scale factor (the relational between
the observable of interest and the raw number of counts) is not determined
from a limit and a confidence level, but specified explicitly.
For the case of a limit, see <code>GeneralGammaUpperLimit</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaDistributionPositive', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaDistributionPositive" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">GeneralGammaDistributionPositive</span><span class="p">(</span><span class="n">NumericalDistribution</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Distribution appropriate for</span>
<span class="sd">    a positive quantitity obtained from a low-statistics counting experiment,</span>
<span class="sd">    e.g. a rare decay rate.</span>
<span class="sd">    The difference to `GammaUpperLimit` is that this class also allows to</span>
<span class="sd">    specify an uncertainty on the number of background events. The result</span>
<span class="sd">    is a numerical distribution obtained from the convolution of a normal</span>
<span class="sd">    distribution (for the background uncertainty) and a gamma distribution,</span>
<span class="sd">    restricted to positive values.</span>
<span class="sd">    In contrast to `GammaUpperLimit`, the scale factor (the relational between</span>
<span class="sd">    the observable of interest and the raw number of counts) is not determined</span>
<span class="sd">    from a limit and a confidence level, but specified explicitly.</span>
<span class="sd">    For the case of a limit, see `GeneralGammaUpperLimit`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">scale_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">counts_total</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">counts_background</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">counts_signal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">background_variance</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - `scale_factor`: scale factor by which the number of counts is multiplied</span>
<span class="sd">          to get the observable of interest.</span>
<span class="sd">        - `counts_total`: observed total number (signal and background) of counts.</span>
<span class="sd">        - `counts_background`: expected mean number of expected background counts</span>
<span class="sd">        - `counts_signal`: mean obseved number of signal events</span>
<span class="sd">        - `background_variance`: standard deviation of the expected number of</span>
<span class="sd">          background events</span>

<span class="sd">        Of the three parameters `counts_total`, `counts_background`, and</span>
<span class="sd">        `counts_signal`, only two must be specified. The third one will</span>
<span class="sd">        be determined from the relation</span>

<span class="sd">        `counts_total = counts_signal + counts_background`</span>

<span class="sd">        Note that if `background_variance=0`, it makes more sense to use</span>
<span class="sd">        `GammaUpperLimit`, which is equivalent but analytical rather than</span>
<span class="sd">        numerical.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">scale_factor</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Scale factor should be positive&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">=</span> <span class="n">scale_factor</span>
        <span class="k">if</span> <span class="n">counts_total</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">counts_total</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;counts_total should be a positive number, zero, or None&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">counts_background</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">counts_background</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;counts_background should be a positive number or None&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">background_variance</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;background_variance should be a positive number&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">[</span><span class="n">counts_total</span><span class="p">,</span> <span class="n">counts_signal</span><span class="p">,</span> <span class="n">counts_background</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># if all three are specified, check the relation holds!</span>
            <span class="k">if</span> <span class="n">counts_background</span> <span class="o">!=</span> <span class="n">counts_total</span> <span class="o">-</span> <span class="n">counts_signal</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The relation `counts_total = counts_signal + counts_background` is not satisfied&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">counts_background</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">counts_background</span> <span class="o">=</span> <span class="n">counts_total</span> <span class="o">-</span> <span class="n">counts_signal</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">counts_background</span> <span class="o">=</span> <span class="n">counts_background</span>
        <span class="k">if</span> <span class="n">counts_signal</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">counts_signal</span> <span class="o">=</span> <span class="n">counts_total</span> <span class="o">-</span> <span class="n">counts_background</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">counts_signal</span> <span class="o">=</span> <span class="n">counts_signal</span>
        <span class="k">if</span> <span class="n">counts_total</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">=</span> <span class="n">counts_signal</span> <span class="o">+</span> <span class="n">counts_background</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">=</span> <span class="n">counts_total</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">background_variance</span> <span class="o">=</span> <span class="n">background_variance</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">background_variance</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">100.</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;For vanishing or very small background variance, &quot;</span>
                          <span class="s2">&quot;it is safer to use GammaUpperLimit instead of &quot;</span>
                          <span class="s2">&quot;GeneralGammaUpperLimit to avoid numerical &quot;</span>
                          <span class="s2">&quot;instability.&quot;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;flavio.statistics.probability.GeneralGammaDistributionPositive&#39;</span>
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, counts_total=</span><span class="si">{}</span><span class="s1">, counts_signal=</span><span class="si">{}</span><span class="s1">, &#39;</span>
               <span class="s1">&#39;background_variance=</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">counts_signal</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">background_variance</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">background_variance</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># this is a bit pointless as in this case it makes more</span>
            <span class="c1"># sense to use GammaUpperLimit itself</span>
            <span class="n">gamma_unscaled</span> <span class="o">=</span> <span class="n">GammaDistributionPositive</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                                       <span class="n">loc</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">counts_background</span><span class="p">,</span>
                                                       <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">num_unscaled</span> <span class="o">=</span> <span class="n">NumericalDistribution</span><span class="o">.</span><span class="n">from_pd</span><span class="p">(</span><span class="n">gamma_unscaled</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># define a gamma distribution (with x&gt;loc, not x&gt;0!) and convolve</span>
            <span class="c1"># it with a Gaussian</span>
            <span class="n">gamma_unscaled</span> <span class="o">=</span> <span class="n">GammaDistribution</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                               <span class="n">loc</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">counts_background</span><span class="p">,</span>
                                               <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">norm_bg</span> <span class="o">=</span> <span class="n">NormalDistribution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">background_variance</span><span class="p">)</span>
            <span class="n">num_unscaled</span> <span class="o">=</span> <span class="n">convolve_distributions</span><span class="p">([</span><span class="n">gamma_unscaled</span><span class="p">,</span> <span class="n">norm_bg</span><span class="p">],</span> <span class="n">central_values</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>
        <span class="c1"># now that we have convolved, cut off anything below x=0</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">num_unscaled</span><span class="o">.</span><span class="n">x</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">num_unscaled</span><span class="o">.</span><span class="n">y_norm</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1">#  make sure the PDF at 0 exists</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>  <span class="c1"># add 0 as first element</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># copy first element</span>
        <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">num_unscaled</span> <span class="o">=</span> <span class="n">NumericalDistribution</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.statistics.probability.GeneralGammaDistributionPositive">GeneralGammaDistributionPositive</a></li>
          <li><a href="#flavio.statistics.probability.NumericalDistribution">NumericalDistribution</a></li>
          <li><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaDistributionPositive.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, scale_factor=1, counts_total=None, counts_background=None, counts_signal=None, background_variance=0)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize the distribution.</p>
<p>Parameters:</p>
<p>Parameters:</p>
<ul>
<li><code>scale_factor</code>: scale factor by which the number of counts is multiplied
  to get the observable of interest.</li>
<li><code>counts_total</code>: observed total number (signal and background) of counts.</li>
<li><code>counts_background</code>: expected mean number of expected background counts</li>
<li><code>counts_signal</code>: mean obseved number of signal events</li>
<li><code>background_variance</code>: standard deviation of the expected number of
  background events</li>
</ul>
<p>Of the three parameters <code>counts_total</code>, <code>counts_background</code>, and
<code>counts_signal</code>, only two must be specified. The third one will
be determined from the relation</p>
<p><code>counts_total = counts_signal + counts_background</code></p>
<p>Note that if <code>background_variance=0</code>, it makes more sense to use
<code>GammaUpperLimit</code>, which is equivalent but analytical rather than
numerical.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaDistributionPositive.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaDistributionPositive.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">scale_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
             <span class="n">counts_total</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">counts_background</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">counts_signal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">background_variance</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - `scale_factor`: scale factor by which the number of counts is multiplied</span>
<span class="sd">      to get the observable of interest.</span>
<span class="sd">    - `counts_total`: observed total number (signal and background) of counts.</span>
<span class="sd">    - `counts_background`: expected mean number of expected background counts</span>
<span class="sd">    - `counts_signal`: mean obseved number of signal events</span>
<span class="sd">    - `background_variance`: standard deviation of the expected number of</span>
<span class="sd">      background events</span>
<span class="sd">    Of the three parameters `counts_total`, `counts_background`, and</span>
<span class="sd">    `counts_signal`, only two must be specified. The third one will</span>
<span class="sd">    be determined from the relation</span>
<span class="sd">    `counts_total = counts_signal + counts_background`</span>
<span class="sd">    Note that if `background_variance=0`, it makes more sense to use</span>
<span class="sd">    `GammaUpperLimit`, which is equivalent but analytical rather than</span>
<span class="sd">    numerical.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">scale_factor</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Scale factor should be positive&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">=</span> <span class="n">scale_factor</span>
    <span class="k">if</span> <span class="n">counts_total</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">counts_total</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;counts_total should be a positive number, zero, or None&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">counts_background</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">counts_background</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;counts_background should be a positive number or None&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">background_variance</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;background_variance should be a positive number&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">[</span><span class="n">counts_total</span><span class="p">,</span> <span class="n">counts_signal</span><span class="p">,</span> <span class="n">counts_background</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># if all three are specified, check the relation holds!</span>
        <span class="k">if</span> <span class="n">counts_background</span> <span class="o">!=</span> <span class="n">counts_total</span> <span class="o">-</span> <span class="n">counts_signal</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The relation `counts_total = counts_signal + counts_background` is not satisfied&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">counts_background</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counts_background</span> <span class="o">=</span> <span class="n">counts_total</span> <span class="o">-</span> <span class="n">counts_signal</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counts_background</span> <span class="o">=</span> <span class="n">counts_background</span>
    <span class="k">if</span> <span class="n">counts_signal</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counts_signal</span> <span class="o">=</span> <span class="n">counts_total</span> <span class="o">-</span> <span class="n">counts_background</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counts_signal</span> <span class="o">=</span> <span class="n">counts_signal</span>
    <span class="k">if</span> <span class="n">counts_total</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">=</span> <span class="n">counts_signal</span> <span class="o">+</span> <span class="n">counts_background</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">=</span> <span class="n">counts_total</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">background_variance</span> <span class="o">=</span> <span class="n">background_variance</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">background_variance</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">100.</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;For vanishing or very small background variance, &quot;</span>
                      <span class="s2">&quot;it is safer to use GammaUpperLimit instead of &quot;</span>
                      <span class="s2">&quot;GeneralGammaUpperLimit to avoid numerical &quot;</span>
                      <span class="s2">&quot;instability.&quot;</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaDistributionPositive.cdf">
    <p>def <span class="ident">cdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaDistributionPositive.cdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaDistributionPositive.cdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaDistributionPositive.delta_logpdf">
    <p>def <span class="ident">delta_logpdf</span>(</p><p>self, x, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaDistributionPositive.delta_logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaDistributionPositive.delta_logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaDistributionPositive.get_central">
    <p>def <span class="ident">get_central</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaDistributionPositive.get_central', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaDistributionPositive.get_central" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaDistributionPositive.get_dict">
    <p>def <span class="ident">get_dict</span>(</p><p>self, distribution=False, iterate=False, arraytolist=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get an ordered dictionary with arguments and values needed to
the instantiate the distribution.</p>
<p>Optional arguments (default to False):</p>
<ul>
<li><code>distribution</code>: add a 'distribution' key to the dictionary with the
value being the string representation of the distribution's name
(e.g. 'asymmetric_normal').</li>
<li><code>iterate</code>: If ProbabilityDistribution instances are among the
arguments (e.g. for KernelDensityEstimate), return the instance's
get_dict instead of the instance as value.</li>
<li><code>arraytolist</code>: convert numpy arrays to lists</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaDistributionPositive.get_dict', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaDistributionPositive.get_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">    the instantiate the distribution.</span>
<span class="sd">    Optional arguments (default to False):</span>
<span class="sd">    - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">    value being the string representation of the distribution&#39;s name</span>
<span class="sd">    (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">    - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">    arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">    get_dict instead of the instance as value.</span>
<span class="sd">    - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
    <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
        <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
    <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">od</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaDistributionPositive.get_error_left">
    <p>def <span class="ident">get_error_left</span>(</p><p>self, nsigma=1, method=&#39;central&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the lower error.</p>
<p>'method' should be one of:</p>
<ul>
<li>'central' for a central interval (same probability on both sides of
  the central value)</li>
<li>'hpd' for highest posterior density, i.e. probability is larger inside
  the interval than outside</li>
<li>'limit' for a one-sided error, i.e. a lower limit</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaDistributionPositive.get_error_left', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaDistributionPositive.get_error_left" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the lower error.</span>
<span class="sd">    &#39;method&#39; should be one of:</span>
<span class="sd">    - &#39;central&#39; for a central interval (same probability on both sides of</span>
<span class="sd">      the central value)</span>
<span class="sd">    - &#39;hpd&#39; for highest posterior density, i.e. probability is larger inside</span>
<span class="sd">      the interval than outside</span>
<span class="sd">    - &#39;limit&#39; for a one-sided error, i.e. a lower limit&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;limit&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
    <span class="n">cdf_central</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
    <span class="n">err_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">cdf_central</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;central&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">err_left</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;hpd&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_error_right</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="n">err_left</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">err_left</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Method &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">method</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; unknown&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaDistributionPositive.get_error_right">
    <p>def <span class="ident">get_error_right</span>(</p><p>self, nsigma=1, method=&#39;central&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the upper error</p>
<p>'method' should be one of:</p>
<ul>
<li>'central' for a central interval (same probability on both sides of
  the central value)</li>
<li>'hpd' for highest posterior density, i.e. probability is larger inside
  the interval than outside</li>
<li>'limit' for a one-sided error, i.e. an upper limit</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaDistributionPositive.get_error_right', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaDistributionPositive.get_error_right" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the upper error</span>
<span class="sd">    &#39;method&#39; should be one of:</span>
<span class="sd">    - &#39;central&#39; for a central interval (same probability on both sides of</span>
<span class="sd">      the central value)</span>
<span class="sd">    - &#39;hpd&#39; for highest posterior density, i.e. probability is larger inside</span>
<span class="sd">      the interval than outside</span>
<span class="sd">    - &#39;limit&#39; for a one-sided error, i.e. an upper limit&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;limit&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="n">cdf_central</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
    <span class="n">err_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">cdf_central</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cdf_central</span><span class="p">)</span> <span class="o">*</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;central&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">err_right</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;hpd&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_error_left</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="n">err_right</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">err_right</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Method &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">method</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; unknown&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaDistributionPositive.get_random">
    <p>def <span class="ident">get_random</span>(</p><p>self, size=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Draw a random number from the distribution.</p>
<p>If size is not None but an integer N, return an array of N numbers.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaDistributionPositive.get_random', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaDistributionPositive.get_random" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Draw a random number from the distribution.</span>
<span class="sd">    If size is not None but an integer N, return an array of N numbers.&quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_interp</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaDistributionPositive.get_yaml">
    <p>def <span class="ident">get_yaml</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a YAML string representing the dictionary returned by the
get_dict method.</p>
<p>Arguments will be passed to <code>yaml.dump</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaDistributionPositive.get_yaml', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaDistributionPositive.get_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">    get_dict method.</span>
<span class="sd">    Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
    <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaDistributionPositive.logpdf">
    <p>def <span class="ident">logpdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaDistributionPositive.logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaDistributionPositive.logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="c1"># ignore warning from log(0)=-np.inf</span>
    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaDistributionPositive.pdf">
    <p>def <span class="ident">pdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaDistributionPositive.pdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaDistributionPositive.pdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaDistributionPositive.ppf">
    <p>def <span class="ident">ppf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaDistributionPositive.ppf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaDistributionPositive.ppf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.statistics.probability.GeneralGammaDistributionPositive.background_variance" class="name">var <span class="ident">background_variance</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GeneralGammaDistributionPositive.error_left" class="name">var <span class="ident">error_left</span></p>
            

            
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GeneralGammaDistributionPositive.error_right" class="name">var <span class="ident">error_right</span></p>
            

            
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GeneralGammaDistributionPositive.scale_factor" class="name">var <span class="ident">scale_factor</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaDistributionPositive.class_to_string">
    <p>def <span class="ident">class_to_string</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a string name for a given ProbabilityDistribution subclass.</p>
<p>This converts camel case to underscore and removes the word
'distribution'.</p>
<p>Example: class_to_string(AsymmetricNormalDistribution) returns
'asymmetric_normal'.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaDistributionPositive.class_to_string', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaDistributionPositive.class_to_string" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>
<span class="sd">    This converts camel case to underscore and removes the word</span>
<span class="sd">    &#39;distribution&#39;.</span>
<span class="sd">    Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">    &#39;asymmetric_normal&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaDistributionPositive.from_pd">
    <p>def <span class="ident">from_pd</span>(</p><p>cls, pd, nsteps=1000)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaDistributionPositive.from_pd', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaDistributionPositive.from_pd" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_pd</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pd</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pd</span><span class="p">,</span> <span class="n">NumericalDistribution</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pd</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">nsteps</span><span class="p">)</span>
    <span class="n">_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">_x</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">_y</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaDistributionPositive.get_subclasses">
    <p>def <span class="ident">get_subclasses</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Return all subclasses (including subclasses of subclasses).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaDistributionPositive.get_subclasses', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaDistributionPositive.get_subclasses" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">subclass</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="flavio.statistics.probability.GeneralGammaUpperLimit" class="name">class <span class="ident">GeneralGammaUpperLimit</span></p>
      
  
    <div class="desc"><p>Distribution appropriate for
a positive quantitity obtained from a low-statistics counting experiment,
e.g. a rare decay rate, given an upper limit on x.
The difference to <code>GammaUpperLimit</code> is that this class also allows to
specify an uncertainty on the number of background events. The result
is a numerical distribution obtained from the convolution of a normal
distribution (for the background uncertainty) and a gamma distribution,
restricted to positive values.
The only difference to <code>GeneralGammaDistributionPositive</code> is that the scale
factor is determined from the limit and confidence level.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaUpperLimit', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaUpperLimit" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">GeneralGammaUpperLimit</span><span class="p">(</span><span class="n">GeneralGammaDistributionPositive</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Distribution appropriate for</span>
<span class="sd">    a positive quantitity obtained from a low-statistics counting experiment,</span>
<span class="sd">    e.g. a rare decay rate, given an upper limit on x.</span>
<span class="sd">    The difference to `GammaUpperLimit` is that this class also allows to</span>
<span class="sd">    specify an uncertainty on the number of background events. The result</span>
<span class="sd">    is a numerical distribution obtained from the convolution of a normal</span>
<span class="sd">    distribution (for the background uncertainty) and a gamma distribution,</span>
<span class="sd">    restricted to positive values.</span>
<span class="sd">    The only difference to `GeneralGammaDistributionPositive` is that the scale</span>
<span class="sd">    factor is determined from the limit and confidence level.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">limit</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">,</span>
                 <span class="n">counts_total</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">counts_background</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">counts_signal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">background_variance</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - `limit`: upper limit on x, which is proportional (with a positive</span>
<span class="sd">          proportionality factor) to the number of signal events.</span>
<span class="sd">        - `confidence_level`: confidence level of the upper limit, i.e. the value</span>
<span class="sd">          of the CDF at the limit. Float between 0 and 1. Frequently used values</span>
<span class="sd">          are 0.90 and 0.95.</span>
<span class="sd">        - `counts_total`: observed total number (signal and background) of counts.</span>
<span class="sd">        - `counts_background`: expected mean number of expected background counts</span>
<span class="sd">        - `counts_signal`: mean obseved number of signal events</span>
<span class="sd">        - `background_variance`: standard deviation of the expected number of</span>
<span class="sd">          background events</span>

<span class="sd">        Of the three parameters `counts_total`, `counts_background`, and</span>
<span class="sd">        `counts_signal`, only two must be specified. The third one will</span>
<span class="sd">        be determined from the relation</span>

<span class="sd">        `counts_total = counts_signal + counts_background`</span>

<span class="sd">        Note that if `background_variance=0`, it makes more sense to use</span>
<span class="sd">        `GammaUpperLimit`, which is equivalent but analytical rather than</span>
<span class="sd">        numerical.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="n">limit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span> <span class="o">=</span> <span class="n">confidence_level</span>
        <span class="n">_d_unscaled</span> <span class="o">=</span> <span class="n">GeneralGammaDistributionPositive</span><span class="p">(</span>
            <span class="n">scale_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">counts_total</span><span class="o">=</span><span class="n">counts_total</span><span class="p">,</span>
            <span class="n">counts_background</span><span class="o">=</span><span class="n">counts_background</span><span class="p">,</span>
            <span class="n">counts_signal</span><span class="o">=</span><span class="n">counts_signal</span><span class="p">,</span>
            <span class="n">background_variance</span><span class="o">=</span><span class="n">background_variance</span><span class="p">)</span>
        <span class="n">limit_unscaled</span> <span class="o">=</span> <span class="n">_d_unscaled</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span><span class="p">)</span>
        <span class="c1"># use the value of the limit to determine the scale factor</span>
        <span class="n">scale_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limit</span> <span class="o">/</span> <span class="n">limit_unscaled</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">scale_factor</span><span class="o">=</span><span class="n">scale_factor</span><span class="p">,</span>
            <span class="n">counts_total</span><span class="o">=</span><span class="n">counts_total</span><span class="p">,</span>
            <span class="n">counts_background</span><span class="o">=</span><span class="n">counts_background</span><span class="p">,</span>
            <span class="n">counts_signal</span><span class="o">=</span><span class="n">counts_signal</span><span class="p">,</span>
            <span class="n">background_variance</span><span class="o">=</span><span class="n">background_variance</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;flavio.statistics.probability.GeneralGammaUpperLimit&#39;</span>
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, counts_total=</span><span class="si">{}</span><span class="s1">, counts_signal=</span><span class="si">{}</span><span class="s1">, &#39;</span>
               <span class="s1">&#39;background_variance=</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">limit</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">counts_total</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">counts_signal</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">background_variance</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.statistics.probability.GeneralGammaUpperLimit">GeneralGammaUpperLimit</a></li>
          <li><a href="#flavio.statistics.probability.GeneralGammaDistributionPositive">GeneralGammaDistributionPositive</a></li>
          <li><a href="#flavio.statistics.probability.NumericalDistribution">NumericalDistribution</a></li>
          <li><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaUpperLimit.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, limit, confidence_level, counts_total=None, counts_background=None, counts_signal=None, background_variance=0)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize the distribution.</p>
<p>Parameters:</p>
<p>Parameters:</p>
<ul>
<li><code>limit</code>: upper limit on x, which is proportional (with a positive
  proportionality factor) to the number of signal events.</li>
<li><code>confidence_level</code>: confidence level of the upper limit, i.e. the value
  of the CDF at the limit. Float between 0 and 1. Frequently used values
  are 0.90 and 0.95.</li>
<li><code>counts_total</code>: observed total number (signal and background) of counts.</li>
<li><code>counts_background</code>: expected mean number of expected background counts</li>
<li><code>counts_signal</code>: mean obseved number of signal events</li>
<li><code>background_variance</code>: standard deviation of the expected number of
  background events</li>
</ul>
<p>Of the three parameters <code>counts_total</code>, <code>counts_background</code>, and
<code>counts_signal</code>, only two must be specified. The third one will
be determined from the relation</p>
<p><code>counts_total = counts_signal + counts_background</code></p>
<p>Note that if <code>background_variance=0</code>, it makes more sense to use
<code>GammaUpperLimit</code>, which is equivalent but analytical rather than
numerical.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaUpperLimit.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaUpperLimit.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">limit</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">,</span>
             <span class="n">counts_total</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">counts_background</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">counts_signal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">background_variance</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - `limit`: upper limit on x, which is proportional (with a positive</span>
<span class="sd">      proportionality factor) to the number of signal events.</span>
<span class="sd">    - `confidence_level`: confidence level of the upper limit, i.e. the value</span>
<span class="sd">      of the CDF at the limit. Float between 0 and 1. Frequently used values</span>
<span class="sd">      are 0.90 and 0.95.</span>
<span class="sd">    - `counts_total`: observed total number (signal and background) of counts.</span>
<span class="sd">    - `counts_background`: expected mean number of expected background counts</span>
<span class="sd">    - `counts_signal`: mean obseved number of signal events</span>
<span class="sd">    - `background_variance`: standard deviation of the expected number of</span>
<span class="sd">      background events</span>
<span class="sd">    Of the three parameters `counts_total`, `counts_background`, and</span>
<span class="sd">    `counts_signal`, only two must be specified. The third one will</span>
<span class="sd">    be determined from the relation</span>
<span class="sd">    `counts_total = counts_signal + counts_background`</span>
<span class="sd">    Note that if `background_variance=0`, it makes more sense to use</span>
<span class="sd">    `GammaUpperLimit`, which is equivalent but analytical rather than</span>
<span class="sd">    numerical.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="n">limit</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span> <span class="o">=</span> <span class="n">confidence_level</span>
    <span class="n">_d_unscaled</span> <span class="o">=</span> <span class="n">GeneralGammaDistributionPositive</span><span class="p">(</span>
        <span class="n">scale_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">counts_total</span><span class="o">=</span><span class="n">counts_total</span><span class="p">,</span>
        <span class="n">counts_background</span><span class="o">=</span><span class="n">counts_background</span><span class="p">,</span>
        <span class="n">counts_signal</span><span class="o">=</span><span class="n">counts_signal</span><span class="p">,</span>
        <span class="n">background_variance</span><span class="o">=</span><span class="n">background_variance</span><span class="p">)</span>
    <span class="n">limit_unscaled</span> <span class="o">=</span> <span class="n">_d_unscaled</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">confidence_level</span><span class="p">)</span>
    <span class="c1"># use the value of the limit to determine the scale factor</span>
    <span class="n">scale_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limit</span> <span class="o">/</span> <span class="n">limit_unscaled</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">scale_factor</span><span class="o">=</span><span class="n">scale_factor</span><span class="p">,</span>
        <span class="n">counts_total</span><span class="o">=</span><span class="n">counts_total</span><span class="p">,</span>
        <span class="n">counts_background</span><span class="o">=</span><span class="n">counts_background</span><span class="p">,</span>
        <span class="n">counts_signal</span><span class="o">=</span><span class="n">counts_signal</span><span class="p">,</span>
        <span class="n">background_variance</span><span class="o">=</span><span class="n">background_variance</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaUpperLimit.cdf">
    <p>def <span class="ident">cdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaUpperLimit.cdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaUpperLimit.cdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaUpperLimit.delta_logpdf">
    <p>def <span class="ident">delta_logpdf</span>(</p><p>self, x, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaUpperLimit.delta_logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaUpperLimit.delta_logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaUpperLimit.get_central">
    <p>def <span class="ident">get_central</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaUpperLimit.get_central', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaUpperLimit.get_central" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaUpperLimit.get_dict">
    <p>def <span class="ident">get_dict</span>(</p><p>self, distribution=False, iterate=False, arraytolist=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get an ordered dictionary with arguments and values needed to
the instantiate the distribution.</p>
<p>Optional arguments (default to False):</p>
<ul>
<li><code>distribution</code>: add a 'distribution' key to the dictionary with the
value being the string representation of the distribution's name
(e.g. 'asymmetric_normal').</li>
<li><code>iterate</code>: If ProbabilityDistribution instances are among the
arguments (e.g. for KernelDensityEstimate), return the instance's
get_dict instead of the instance as value.</li>
<li><code>arraytolist</code>: convert numpy arrays to lists</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaUpperLimit.get_dict', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaUpperLimit.get_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">    the instantiate the distribution.</span>
<span class="sd">    Optional arguments (default to False):</span>
<span class="sd">    - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">    value being the string representation of the distribution&#39;s name</span>
<span class="sd">    (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">    - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">    arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">    get_dict instead of the instance as value.</span>
<span class="sd">    - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
    <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
        <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
    <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">od</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaUpperLimit.get_error_left">
    <p>def <span class="ident">get_error_left</span>(</p><p>self, nsigma=1, method=&#39;central&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the lower error.</p>
<p>'method' should be one of:</p>
<ul>
<li>'central' for a central interval (same probability on both sides of
  the central value)</li>
<li>'hpd' for highest posterior density, i.e. probability is larger inside
  the interval than outside</li>
<li>'limit' for a one-sided error, i.e. a lower limit</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaUpperLimit.get_error_left', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaUpperLimit.get_error_left" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the lower error.</span>
<span class="sd">    &#39;method&#39; should be one of:</span>
<span class="sd">    - &#39;central&#39; for a central interval (same probability on both sides of</span>
<span class="sd">      the central value)</span>
<span class="sd">    - &#39;hpd&#39; for highest posterior density, i.e. probability is larger inside</span>
<span class="sd">      the interval than outside</span>
<span class="sd">    - &#39;limit&#39; for a one-sided error, i.e. a lower limit&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;limit&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
    <span class="n">cdf_central</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
    <span class="n">err_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">cdf_central</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;central&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">err_left</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;hpd&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_error_right</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="n">err_left</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">err_left</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Method &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">method</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; unknown&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaUpperLimit.get_error_right">
    <p>def <span class="ident">get_error_right</span>(</p><p>self, nsigma=1, method=&#39;central&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the upper error</p>
<p>'method' should be one of:</p>
<ul>
<li>'central' for a central interval (same probability on both sides of
  the central value)</li>
<li>'hpd' for highest posterior density, i.e. probability is larger inside
  the interval than outside</li>
<li>'limit' for a one-sided error, i.e. an upper limit</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaUpperLimit.get_error_right', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaUpperLimit.get_error_right" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the upper error</span>
<span class="sd">    &#39;method&#39; should be one of:</span>
<span class="sd">    - &#39;central&#39; for a central interval (same probability on both sides of</span>
<span class="sd">      the central value)</span>
<span class="sd">    - &#39;hpd&#39; for highest posterior density, i.e. probability is larger inside</span>
<span class="sd">      the interval than outside</span>
<span class="sd">    - &#39;limit&#39; for a one-sided error, i.e. an upper limit&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;limit&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="n">cdf_central</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
    <span class="n">err_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">cdf_central</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cdf_central</span><span class="p">)</span> <span class="o">*</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;central&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">err_right</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;hpd&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_error_left</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="n">err_right</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">err_right</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Method &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">method</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; unknown&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaUpperLimit.get_random">
    <p>def <span class="ident">get_random</span>(</p><p>self, size=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Draw a random number from the distribution.</p>
<p>If size is not None but an integer N, return an array of N numbers.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaUpperLimit.get_random', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaUpperLimit.get_random" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Draw a random number from the distribution.</span>
<span class="sd">    If size is not None but an integer N, return an array of N numbers.&quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_interp</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaUpperLimit.get_yaml">
    <p>def <span class="ident">get_yaml</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a YAML string representing the dictionary returned by the
get_dict method.</p>
<p>Arguments will be passed to <code>yaml.dump</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaUpperLimit.get_yaml', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaUpperLimit.get_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">    get_dict method.</span>
<span class="sd">    Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
    <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaUpperLimit.logpdf">
    <p>def <span class="ident">logpdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaUpperLimit.logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaUpperLimit.logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="c1"># ignore warning from log(0)=-np.inf</span>
    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaUpperLimit.pdf">
    <p>def <span class="ident">pdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaUpperLimit.pdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaUpperLimit.pdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaUpperLimit.ppf">
    <p>def <span class="ident">ppf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaUpperLimit.ppf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaUpperLimit.ppf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.statistics.probability.GeneralGammaUpperLimit.confidence_level" class="name">var <span class="ident">confidence_level</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GeneralGammaUpperLimit.error_left" class="name">var <span class="ident">error_left</span></p>
            

            
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GeneralGammaUpperLimit.error_right" class="name">var <span class="ident">error_right</span></p>
            

            
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.GeneralGammaUpperLimit.limit" class="name">var <span class="ident">limit</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaUpperLimit.class_to_string">
    <p>def <span class="ident">class_to_string</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a string name for a given ProbabilityDistribution subclass.</p>
<p>This converts camel case to underscore and removes the word
'distribution'.</p>
<p>Example: class_to_string(AsymmetricNormalDistribution) returns
'asymmetric_normal'.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaUpperLimit.class_to_string', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaUpperLimit.class_to_string" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>
<span class="sd">    This converts camel case to underscore and removes the word</span>
<span class="sd">    &#39;distribution&#39;.</span>
<span class="sd">    Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">    &#39;asymmetric_normal&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaUpperLimit.from_pd">
    <p>def <span class="ident">from_pd</span>(</p><p>cls, pd, nsteps=1000)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaUpperLimit.from_pd', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaUpperLimit.from_pd" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_pd</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pd</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pd</span><span class="p">,</span> <span class="n">NumericalDistribution</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pd</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">nsteps</span><span class="p">)</span>
    <span class="n">_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">_x</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">_y</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.GeneralGammaUpperLimit.get_subclasses">
    <p>def <span class="ident">get_subclasses</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Return all subclasses (including subclasses of subclasses).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.GeneralGammaUpperLimit.get_subclasses', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.GeneralGammaUpperLimit.get_subclasses" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">subclass</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="flavio.statistics.probability.HalfNormalDistribution" class="name">class <span class="ident">HalfNormalDistribution</span></p>
      
  
    <div class="desc"><p>Half-normal distribution with zero PDF above or below the mode.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.HalfNormalDistribution', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.HalfNormalDistribution" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">HalfNormalDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Half-normal distribution with zero PDF above or below the mode.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">standard_deviation</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - central_value: mode of the distribution.</span>
<span class="sd">        - standard_deviation:</span>
<span class="sd">          If positive, the PDF is zero below central_value and (twice) that of</span>
<span class="sd">          a Gaussian with this standard deviation above.</span>
<span class="sd">          If negative, the PDF is zero above central_value and (twice) that of</span>
<span class="sd">          a Gaussian with standard deviation equal to abs(standard_deviation)</span>
<span class="sd">          below.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span>
                         <span class="n">support</span><span class="o">=</span><span class="nb">sorted</span><span class="p">((</span><span class="n">central_value</span><span class="p">,</span>
                                         <span class="n">central_value</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">standard_deviation</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">standard_deviation</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Standard deviation must be non-zero number&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">=</span> <span class="n">standard_deviation</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.HalfNormalDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">),</span> <span class="n">size</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">normal_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">_lpvect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_lpvect</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">halfnorm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span>
                                                <span class="n">loc</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span>
                                                <span class="n">scale</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">halfnorm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
                                            <span class="n">loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span>
                                            <span class="n">scale</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">halfnorm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span>
                                            <span class="n">loc</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span>
                                            <span class="n">scale</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">halfnorm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
                                            <span class="n">loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span>
                                            <span class="n">scale</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>  <span class="c1"># return a positive value!</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.statistics.probability.HalfNormalDistribution">HalfNormalDistribution</a></li>
          <li><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.HalfNormalDistribution.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, central_value, standard_deviation)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize the distribution.</p>
<p>Parameters:</p>
<ul>
<li>central_value: mode of the distribution.</li>
<li>standard_deviation:
  If positive, the PDF is zero below central_value and (twice) that of
  a Gaussian with this standard deviation above.
  If negative, the PDF is zero above central_value and (twice) that of
  a Gaussian with standard deviation equal to abs(standard_deviation)
  below.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.HalfNormalDistribution.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.HalfNormalDistribution.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">standard_deviation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - central_value: mode of the distribution.</span>
<span class="sd">    - standard_deviation:</span>
<span class="sd">      If positive, the PDF is zero below central_value and (twice) that of</span>
<span class="sd">      a Gaussian with this standard deviation above.</span>
<span class="sd">      If negative, the PDF is zero above central_value and (twice) that of</span>
<span class="sd">      a Gaussian with standard deviation equal to abs(standard_deviation)</span>
<span class="sd">      below.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span>
                     <span class="n">support</span><span class="o">=</span><span class="nb">sorted</span><span class="p">((</span><span class="n">central_value</span><span class="p">,</span>
                                     <span class="n">central_value</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">standard_deviation</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">standard_deviation</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Standard deviation must be non-zero number&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">=</span> <span class="n">standard_deviation</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.HalfNormalDistribution.cdf">
    <p>def <span class="ident">cdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.HalfNormalDistribution.cdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.HalfNormalDistribution.cdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">halfnorm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span>
                                            <span class="n">loc</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span>
                                            <span class="n">scale</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">halfnorm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
                                        <span class="n">loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span>
                                        <span class="n">scale</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.HalfNormalDistribution.delta_logpdf">
    <p>def <span class="ident">delta_logpdf</span>(</p><p>self, x, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.HalfNormalDistribution.delta_logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.HalfNormalDistribution.delta_logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.HalfNormalDistribution.get_central">
    <p>def <span class="ident">get_central</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.HalfNormalDistribution.get_central', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.HalfNormalDistribution.get_central" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.HalfNormalDistribution.get_dict">
    <p>def <span class="ident">get_dict</span>(</p><p>self, distribution=False, iterate=False, arraytolist=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get an ordered dictionary with arguments and values needed to
the instantiate the distribution.</p>
<p>Optional arguments (default to False):</p>
<ul>
<li><code>distribution</code>: add a 'distribution' key to the dictionary with the
value being the string representation of the distribution's name
(e.g. 'asymmetric_normal').</li>
<li><code>iterate</code>: If ProbabilityDistribution instances are among the
arguments (e.g. for KernelDensityEstimate), return the instance's
get_dict instead of the instance as value.</li>
<li><code>arraytolist</code>: convert numpy arrays to lists</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.HalfNormalDistribution.get_dict', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.HalfNormalDistribution.get_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">    the instantiate the distribution.</span>
<span class="sd">    Optional arguments (default to False):</span>
<span class="sd">    - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">    value being the string representation of the distribution&#39;s name</span>
<span class="sd">    (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">    - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">    arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">    get_dict instead of the instance as value.</span>
<span class="sd">    - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
    <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
        <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
    <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">od</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.HalfNormalDistribution.get_error_left">
    <p>def <span class="ident">get_error_left</span>(</p><p>self, nsigma=1, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.HalfNormalDistribution.get_error_left', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.HalfNormalDistribution.get_error_left" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>  <span class="c1"># return a positive value!</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.HalfNormalDistribution.get_error_right">
    <p>def <span class="ident">get_error_right</span>(</p><p>self, nsigma=1, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.HalfNormalDistribution.get_error_right', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.HalfNormalDistribution.get_error_right" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.HalfNormalDistribution.get_random">
    <p>def <span class="ident">get_random</span>(</p><p>self, size=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.HalfNormalDistribution.get_random', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.HalfNormalDistribution.get_random" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">),</span> <span class="n">size</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.HalfNormalDistribution.get_yaml">
    <p>def <span class="ident">get_yaml</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a YAML string representing the dictionary returned by the
get_dict method.</p>
<p>Arguments will be passed to <code>yaml.dump</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.HalfNormalDistribution.get_yaml', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.HalfNormalDistribution.get_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">    get_dict method.</span>
<span class="sd">    Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
    <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.HalfNormalDistribution.logpdf">
    <p>def <span class="ident">logpdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.HalfNormalDistribution.logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.HalfNormalDistribution.logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">_lpvect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_lpvect</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.HalfNormalDistribution.ppf">
    <p>def <span class="ident">ppf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.HalfNormalDistribution.ppf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.HalfNormalDistribution.ppf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">halfnorm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span>
                                        <span class="n">loc</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span>
                                        <span class="n">scale</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">halfnorm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
                                        <span class="n">loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span>
                                        <span class="n">scale</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.statistics.probability.HalfNormalDistribution.error_left" class="name">var <span class="ident">error_left</span></p>
            

            
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.HalfNormalDistribution.error_right" class="name">var <span class="ident">error_right</span></p>
            

            
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.HalfNormalDistribution.standard_deviation" class="name">var <span class="ident">standard_deviation</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.HalfNormalDistribution.class_to_string">
    <p>def <span class="ident">class_to_string</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a string name for a given ProbabilityDistribution subclass.</p>
<p>This converts camel case to underscore and removes the word
'distribution'.</p>
<p>Example: class_to_string(AsymmetricNormalDistribution) returns
'asymmetric_normal'.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.HalfNormalDistribution.class_to_string', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.HalfNormalDistribution.class_to_string" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>
<span class="sd">    This converts camel case to underscore and removes the word</span>
<span class="sd">    &#39;distribution&#39;.</span>
<span class="sd">    Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">    &#39;asymmetric_normal&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.HalfNormalDistribution.get_subclasses">
    <p>def <span class="ident">get_subclasses</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Return all subclasses (including subclasses of subclasses).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.HalfNormalDistribution.get_subclasses', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.HalfNormalDistribution.get_subclasses" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">subclass</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="flavio.statistics.probability.KernelDensityEstimate" class="name">class <span class="ident">KernelDensityEstimate</span></p>
      
  
    <div class="desc"><p>Univariate kernel density estimate.</p>
<p>Parameters:</p>
<ul>
<li><code>data</code>: 1D array</li>
<li><code>kernel</code>: instance of <code>ProbabilityDistribution</code> used as smoothing kernel</li>
<li><code>n_bins</code> (optional): number of bins used in the intermediate step. This normally
  does not have to be changed.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.KernelDensityEstimate', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.KernelDensityEstimate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">KernelDensityEstimate</span><span class="p">(</span><span class="n">NumericalDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Univariate kernel density estimate.</span>

<span class="sd">    Parameters:</span>

<span class="sd">    - `data`: 1D array</span>
<span class="sd">    - `kernel`: instance of `ProbabilityDistribution` used as smoothing kernel</span>
<span class="sd">    - `n_bins` (optional): number of bins used in the intermediate step. This normally</span>
<span class="sd">      does not have to be changed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">n_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">assert</span> <span class="n">kernel</span><span class="o">.</span><span class="n">central_value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Kernel density must have zero central value&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span> <span class="o">=</span> <span class="n">kernel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n_bins</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span> <span class="o">=</span> <span class="n">n_bins</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">x_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="mf">2.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_raw</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw_dist</span> <span class="o">=</span> <span class="n">NumericalDistribution</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">cdist</span> <span class="o">=</span> <span class="n">convolve_distributions</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_dist</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">],</span> <span class="s1">&#39;sum&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cdist</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">cdist</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.KernelDensityEstimate&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.statistics.probability.KernelDensityEstimate">KernelDensityEstimate</a></li>
          <li><a href="#flavio.statistics.probability.NumericalDistribution">NumericalDistribution</a></li>
          <li><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.KernelDensityEstimate.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, data, kernel, n_bins=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize a 1D numerical distribution.</p>
<p>Parameters:</p>
<ul>
<li><code>x</code>: x-axis values. Must be a 1D array of real values in strictly
  ascending order (but not necessarily evenly spaced)</li>
<li><code>y</code>: PDF values. Must be a 1D array of real positive values with the
  same length as <code>x</code></li>
<li>central_value: if None (default), will be set to the mode of the
  distribution, i.e. the x-value where y is largest (by looking up
  the input arrays, i.e. without interpolation!)</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.KernelDensityEstimate.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.KernelDensityEstimate.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">n_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">assert</span> <span class="n">kernel</span><span class="o">.</span><span class="n">central_value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Kernel density must have zero central value&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span> <span class="o">=</span> <span class="n">kernel</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n_bins</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span> <span class="o">=</span> <span class="n">n_bins</span>
    <span class="n">y</span><span class="p">,</span> <span class="n">x_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="mf">2.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">y_raw</span> <span class="o">=</span> <span class="n">y</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raw_dist</span> <span class="o">=</span> <span class="n">NumericalDistribution</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">cdist</span> <span class="o">=</span> <span class="n">convolve_distributions</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_dist</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">],</span> <span class="s1">&#39;sum&#39;</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cdist</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">cdist</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.KernelDensityEstimate.cdf">
    <p>def <span class="ident">cdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.KernelDensityEstimate.cdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.KernelDensityEstimate.cdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.KernelDensityEstimate.delta_logpdf">
    <p>def <span class="ident">delta_logpdf</span>(</p><p>self, x, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.KernelDensityEstimate.delta_logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.KernelDensityEstimate.delta_logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.KernelDensityEstimate.get_central">
    <p>def <span class="ident">get_central</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.KernelDensityEstimate.get_central', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.KernelDensityEstimate.get_central" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.KernelDensityEstimate.get_dict">
    <p>def <span class="ident">get_dict</span>(</p><p>self, distribution=False, iterate=False, arraytolist=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get an ordered dictionary with arguments and values needed to
the instantiate the distribution.</p>
<p>Optional arguments (default to False):</p>
<ul>
<li><code>distribution</code>: add a 'distribution' key to the dictionary with the
value being the string representation of the distribution's name
(e.g. 'asymmetric_normal').</li>
<li><code>iterate</code>: If ProbabilityDistribution instances are among the
arguments (e.g. for KernelDensityEstimate), return the instance's
get_dict instead of the instance as value.</li>
<li><code>arraytolist</code>: convert numpy arrays to lists</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.KernelDensityEstimate.get_dict', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.KernelDensityEstimate.get_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">    the instantiate the distribution.</span>
<span class="sd">    Optional arguments (default to False):</span>
<span class="sd">    - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">    value being the string representation of the distribution&#39;s name</span>
<span class="sd">    (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">    - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">    arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">    get_dict instead of the instance as value.</span>
<span class="sd">    - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
    <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
        <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
    <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">od</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.KernelDensityEstimate.get_error_left">
    <p>def <span class="ident">get_error_left</span>(</p><p>self, nsigma=1, method=&#39;central&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the lower error.</p>
<p>'method' should be one of:</p>
<ul>
<li>'central' for a central interval (same probability on both sides of
  the central value)</li>
<li>'hpd' for highest posterior density, i.e. probability is larger inside
  the interval than outside</li>
<li>'limit' for a one-sided error, i.e. a lower limit</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.KernelDensityEstimate.get_error_left', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.KernelDensityEstimate.get_error_left" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the lower error.</span>
<span class="sd">    &#39;method&#39; should be one of:</span>
<span class="sd">    - &#39;central&#39; for a central interval (same probability on both sides of</span>
<span class="sd">      the central value)</span>
<span class="sd">    - &#39;hpd&#39; for highest posterior density, i.e. probability is larger inside</span>
<span class="sd">      the interval than outside</span>
<span class="sd">    - &#39;limit&#39; for a one-sided error, i.e. a lower limit&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;limit&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
    <span class="n">cdf_central</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
    <span class="n">err_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">cdf_central</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;central&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">err_left</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;hpd&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_error_right</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="n">err_left</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">err_left</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Method &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">method</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; unknown&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.KernelDensityEstimate.get_error_right">
    <p>def <span class="ident">get_error_right</span>(</p><p>self, nsigma=1, method=&#39;central&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the upper error</p>
<p>'method' should be one of:</p>
<ul>
<li>'central' for a central interval (same probability on both sides of
  the central value)</li>
<li>'hpd' for highest posterior density, i.e. probability is larger inside
  the interval than outside</li>
<li>'limit' for a one-sided error, i.e. an upper limit</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.KernelDensityEstimate.get_error_right', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.KernelDensityEstimate.get_error_right" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the upper error</span>
<span class="sd">    &#39;method&#39; should be one of:</span>
<span class="sd">    - &#39;central&#39; for a central interval (same probability on both sides of</span>
<span class="sd">      the central value)</span>
<span class="sd">    - &#39;hpd&#39; for highest posterior density, i.e. probability is larger inside</span>
<span class="sd">      the interval than outside</span>
<span class="sd">    - &#39;limit&#39; for a one-sided error, i.e. an upper limit&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;limit&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="n">cdf_central</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
    <span class="n">err_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">cdf_central</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cdf_central</span><span class="p">)</span> <span class="o">*</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;central&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">err_right</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;hpd&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_error_left</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="n">err_right</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">err_right</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Method &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">method</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; unknown&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.KernelDensityEstimate.get_random">
    <p>def <span class="ident">get_random</span>(</p><p>self, size=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Draw a random number from the distribution.</p>
<p>If size is not None but an integer N, return an array of N numbers.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.KernelDensityEstimate.get_random', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.KernelDensityEstimate.get_random" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Draw a random number from the distribution.</span>
<span class="sd">    If size is not None but an integer N, return an array of N numbers.&quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_interp</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.KernelDensityEstimate.get_yaml">
    <p>def <span class="ident">get_yaml</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a YAML string representing the dictionary returned by the
get_dict method.</p>
<p>Arguments will be passed to <code>yaml.dump</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.KernelDensityEstimate.get_yaml', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.KernelDensityEstimate.get_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">    get_dict method.</span>
<span class="sd">    Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
    <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.KernelDensityEstimate.logpdf">
    <p>def <span class="ident">logpdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.KernelDensityEstimate.logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.KernelDensityEstimate.logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="c1"># ignore warning from log(0)=-np.inf</span>
    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.KernelDensityEstimate.pdf">
    <p>def <span class="ident">pdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.KernelDensityEstimate.pdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.KernelDensityEstimate.pdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.KernelDensityEstimate.ppf">
    <p>def <span class="ident">ppf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.KernelDensityEstimate.ppf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.KernelDensityEstimate.ppf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.statistics.probability.KernelDensityEstimate.data" class="name">var <span class="ident">data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.KernelDensityEstimate.error_left" class="name">var <span class="ident">error_left</span></p>
            

            
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.KernelDensityEstimate.error_right" class="name">var <span class="ident">error_right</span></p>
            

            
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.KernelDensityEstimate.kernel" class="name">var <span class="ident">kernel</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.KernelDensityEstimate.n" class="name">var <span class="ident">n</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.KernelDensityEstimate.raw_dist" class="name">var <span class="ident">raw_dist</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.KernelDensityEstimate.y_raw" class="name">var <span class="ident">y_raw</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.KernelDensityEstimate.class_to_string">
    <p>def <span class="ident">class_to_string</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a string name for a given ProbabilityDistribution subclass.</p>
<p>This converts camel case to underscore and removes the word
'distribution'.</p>
<p>Example: class_to_string(AsymmetricNormalDistribution) returns
'asymmetric_normal'.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.KernelDensityEstimate.class_to_string', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.KernelDensityEstimate.class_to_string" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>
<span class="sd">    This converts camel case to underscore and removes the word</span>
<span class="sd">    &#39;distribution&#39;.</span>
<span class="sd">    Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">    &#39;asymmetric_normal&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.KernelDensityEstimate.from_pd">
    <p>def <span class="ident">from_pd</span>(</p><p>cls, pd, nsteps=1000)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.KernelDensityEstimate.from_pd', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.KernelDensityEstimate.from_pd" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_pd</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pd</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pd</span><span class="p">,</span> <span class="n">NumericalDistribution</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pd</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">nsteps</span><span class="p">)</span>
    <span class="n">_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">_x</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">_y</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.KernelDensityEstimate.get_subclasses">
    <p>def <span class="ident">get_subclasses</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Return all subclasses (including subclasses of subclasses).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.KernelDensityEstimate.get_subclasses', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.KernelDensityEstimate.get_subclasses" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">subclass</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="flavio.statistics.probability.LogNormalDistribution" class="name">class <span class="ident">LogNormalDistribution</span></p>
      
  
    <div class="desc"><p>Univariate log-normal distribution.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.LogNormalDistribution', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.LogNormalDistribution" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">LogNormalDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Univariate log-normal distribution.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - central_value: median of the distribution (neither mode nor mean!).</span>
<span class="sd">          Can be positive or negative, but must be nonzero.</span>
<span class="sd">        - factor: must be larger than 1. 68% of the probability will be between</span>
<span class="sd">          `central_value * factor` and `central_value / factor`.</span>

<span class="sd">        The mean and standard deviation of the underlying normal distribution</span>
<span class="sd">        correspond to `log(abs(central_value))` and `log(factor)`, respectively.</span>

<span class="sd">        Example:</span>

<span class="sd">        `LogNormalDistribution(central_value=3, factor=2)`</span>

<span class="sd">        corresponds to the distribution of the exponential of a normally</span>
<span class="sd">        distributed variable with mean ln(3) and standard deviation ln(2).</span>
<span class="sd">        68% of the probability is within 6=3*2 and 1.5=4/2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">central_value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Central value must not be zero&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">factor</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Factor must be bigger than 1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">=</span> <span class="n">factor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">central_value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">central_value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">slim</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">central_value</span><span class="p">))</span>
                            <span class="o">-</span> <span class="mi">6</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span>
                             <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">slim</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span> <span class="o">=</span> <span class="o">+</span><span class="mi">1</span>
            <span class="n">slim</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">central_value</span><span class="p">))</span>
                            <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span>
                             <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">slim</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.LogNormalDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span>
        <span class="k">return</span> <span class="n">s</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">s</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">s</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
        <span class="n">cl</span> <span class="o">=</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">cl</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
        <span class="n">cl</span> <span class="o">=</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">cl</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.statistics.probability.LogNormalDistribution">LogNormalDistribution</a></li>
          <li><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.LogNormalDistribution.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, central_value, factor)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize the distribution.</p>
<p>Parameters:</p>
<ul>
<li>central_value: median of the distribution (neither mode nor mean!).
  Can be positive or negative, but must be nonzero.</li>
<li>factor: must be larger than 1. 68% of the probability will be between
  <code>central_value * factor</code> and <code>central_value / factor</code>.</li>
</ul>
<p>The mean and standard deviation of the underlying normal distribution
correspond to <code>log(abs(central_value))</code> and <code>log(factor)</code>, respectively.</p>
<p>Example:</p>
<p><code>LogNormalDistribution(central_value=3, factor=2)</code></p>
<p>corresponds to the distribution of the exponential of a normally
distributed variable with mean ln(3) and standard deviation ln(2).
68% of the probability is within 6=3*2 and 1.5=4/2.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.LogNormalDistribution.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.LogNormalDistribution.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - central_value: median of the distribution (neither mode nor mean!).</span>
<span class="sd">      Can be positive or negative, but must be nonzero.</span>
<span class="sd">    - factor: must be larger than 1. 68% of the probability will be between</span>
<span class="sd">      `central_value * factor` and `central_value / factor`.</span>
<span class="sd">    The mean and standard deviation of the underlying normal distribution</span>
<span class="sd">    correspond to `log(abs(central_value))` and `log(factor)`, respectively.</span>
<span class="sd">    Example:</span>
<span class="sd">    `LogNormalDistribution(central_value=3, factor=2)`</span>
<span class="sd">    corresponds to the distribution of the exponential of a normally</span>
<span class="sd">    distributed variable with mean ln(3) and standard deviation ln(2).</span>
<span class="sd">    68% of the probability is within 6=3*2 and 1.5=4/2.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">central_value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Central value must not be zero&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">factor</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Factor must be bigger than 1&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">=</span> <span class="n">factor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">central_value</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">central_value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">slim</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">central_value</span><span class="p">))</span>
                        <span class="o">-</span> <span class="mi">6</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span>
                         <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">slim</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span> <span class="o">=</span> <span class="o">+</span><span class="mi">1</span>
        <span class="n">slim</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">central_value</span><span class="p">))</span>
                        <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span>
                         <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">slim</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.LogNormalDistribution.cdf">
    <p>def <span class="ident">cdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.LogNormalDistribution.cdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.LogNormalDistribution.cdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.LogNormalDistribution.delta_logpdf">
    <p>def <span class="ident">delta_logpdf</span>(</p><p>self, x, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.LogNormalDistribution.delta_logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.LogNormalDistribution.delta_logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.LogNormalDistribution.get_central">
    <p>def <span class="ident">get_central</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.LogNormalDistribution.get_central', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.LogNormalDistribution.get_central" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.LogNormalDistribution.get_dict">
    <p>def <span class="ident">get_dict</span>(</p><p>self, distribution=False, iterate=False, arraytolist=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get an ordered dictionary with arguments and values needed to
the instantiate the distribution.</p>
<p>Optional arguments (default to False):</p>
<ul>
<li><code>distribution</code>: add a 'distribution' key to the dictionary with the
value being the string representation of the distribution's name
(e.g. 'asymmetric_normal').</li>
<li><code>iterate</code>: If ProbabilityDistribution instances are among the
arguments (e.g. for KernelDensityEstimate), return the instance's
get_dict instead of the instance as value.</li>
<li><code>arraytolist</code>: convert numpy arrays to lists</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.LogNormalDistribution.get_dict', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.LogNormalDistribution.get_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">    the instantiate the distribution.</span>
<span class="sd">    Optional arguments (default to False):</span>
<span class="sd">    - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">    value being the string representation of the distribution&#39;s name</span>
<span class="sd">    (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">    - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">    arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">    get_dict instead of the instance as value.</span>
<span class="sd">    - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
    <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
        <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
    <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">od</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.LogNormalDistribution.get_error_left">
    <p>def <span class="ident">get_error_left</span>(</p><p>self, nsigma=1, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.LogNormalDistribution.get_error_left', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.LogNormalDistribution.get_error_left" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
    <span class="n">cl</span> <span class="o">=</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">cl</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.LogNormalDistribution.get_error_right">
    <p>def <span class="ident">get_error_right</span>(</p><p>self, nsigma=1, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.LogNormalDistribution.get_error_right', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.LogNormalDistribution.get_error_right" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
    <span class="n">cl</span> <span class="o">=</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">cl</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.LogNormalDistribution.get_random">
    <p>def <span class="ident">get_random</span>(</p><p>self, size=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.LogNormalDistribution.get_random', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.LogNormalDistribution.get_random" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span>
    <span class="k">return</span> <span class="n">s</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.LogNormalDistribution.get_yaml">
    <p>def <span class="ident">get_yaml</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a YAML string representing the dictionary returned by the
get_dict method.</p>
<p>Arguments will be passed to <code>yaml.dump</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.LogNormalDistribution.get_yaml', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.LogNormalDistribution.get_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">    get_dict method.</span>
<span class="sd">    Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
    <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.LogNormalDistribution.logpdf">
    <p>def <span class="ident">logpdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.LogNormalDistribution.logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.LogNormalDistribution.logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span>
    <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">s</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.LogNormalDistribution.pdf">
    <p>def <span class="ident">pdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.LogNormalDistribution.pdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.LogNormalDistribution.pdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span>
    <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">s</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.LogNormalDistribution.ppf">
    <p>def <span class="ident">ppf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.LogNormalDistribution.ppf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.LogNormalDistribution.ppf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_sign</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_central_value</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_standard_deviation</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.statistics.probability.LogNormalDistribution.error_left" class="name">var <span class="ident">error_left</span></p>
            

            
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.LogNormalDistribution.error_right" class="name">var <span class="ident">error_right</span></p>
            

            
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.LogNormalDistribution.factor" class="name">var <span class="ident">factor</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.LogNormalDistribution.log_central_value" class="name">var <span class="ident">log_central_value</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.LogNormalDistribution.log_standard_deviation" class="name">var <span class="ident">log_standard_deviation</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.LogNormalDistribution.class_to_string">
    <p>def <span class="ident">class_to_string</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a string name for a given ProbabilityDistribution subclass.</p>
<p>This converts camel case to underscore and removes the word
'distribution'.</p>
<p>Example: class_to_string(AsymmetricNormalDistribution) returns
'asymmetric_normal'.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.LogNormalDistribution.class_to_string', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.LogNormalDistribution.class_to_string" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>
<span class="sd">    This converts camel case to underscore and removes the word</span>
<span class="sd">    &#39;distribution&#39;.</span>
<span class="sd">    Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">    &#39;asymmetric_normal&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.LogNormalDistribution.get_subclasses">
    <p>def <span class="ident">get_subclasses</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Return all subclasses (including subclasses of subclasses).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.LogNormalDistribution.get_subclasses', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.LogNormalDistribution.get_subclasses" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">subclass</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="flavio.statistics.probability.MultivariateNormalDistribution" class="name">class <span class="ident">MultivariateNormalDistribution</span></p>
      
  
    <div class="desc"><p>A multivariate normal distribution.</p>
<p>Parameters:</p>
<ul>
<li>central_value: the location vector</li>
<li>covariance: the covariance matrix</li>
<li>standard_deviation: the square root of the variance vector</li>
<li>correlation: the correlation matrix</li>
</ul>
<p>If the covariance matrix is not specified, standard_deviation and the
correlation matrix have to be specified.</p>
<p>Methods:</p>
<ul>
<li>get_random(size=None): get <code>size</code> random numbers (default: a single one)</li>
<li>logpdf(x, exclude=None): get the logarithm of the probability density
  function. If an iterable of integers is given for <code>exclude</code>, the parameters
  at these positions will be removed from the covariance before evaluating
  the PDF, effectively ignoring certain dimensions.</li>
</ul>
<p>Properties:</p>
<ul>
<li>error_left, error_right: both return the vector of standard deviations</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNormalDistribution', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNormalDistribution" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MultivariateNormalDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A multivariate normal distribution.</span>

<span class="sd">    Parameters:</span>

<span class="sd">    - central_value: the location vector</span>
<span class="sd">    - covariance: the covariance matrix</span>
<span class="sd">    - standard_deviation: the square root of the variance vector</span>
<span class="sd">    - correlation: the correlation matrix</span>

<span class="sd">    If the covariance matrix is not specified, standard_deviation and the</span>
<span class="sd">    correlation matrix have to be specified.</span>

<span class="sd">    Methods:</span>

<span class="sd">    - get_random(size=None): get `size` random numbers (default: a single one)</span>
<span class="sd">    - logpdf(x, exclude=None): get the logarithm of the probability density</span>
<span class="sd">      function. If an iterable of integers is given for `exclude`, the parameters</span>
<span class="sd">      at these positions will be removed from the covariance before evaluating</span>
<span class="sd">      the PDF, effectively ignoring certain dimensions.</span>

<span class="sd">    Properties:</span>

<span class="sd">    - error_left, error_right: both return the vector of standard deviations</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">covariance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">standard_deviation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">correlation</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize PDF instance.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - central_value: vector of means, shape (n)</span>
<span class="sd">        - covariance: covariance matrix, shape (n,n)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">covariance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="n">covariance</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">correlation</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">standard_deviation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You must specify either covariance or standard_deviation&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">standard_deviation</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">correlation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">correlation</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                    <span class="c1"># if it&#39;s a number, return delta_ij + (1-delta_ij)*x</span>
                    <span class="n">n_dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">central_value</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n_dim</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n_dim</span><span class="p">,</span> <span class="n">n_dim</span><span class="p">))</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n_dim</span><span class="p">))</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">correlation</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">correlation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">correlation</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">central_value</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">,</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">central_value</span><span class="p">)</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span>
                    <span class="p">]))</span>
        <span class="c1"># to avoid ill-conditioned covariance matrices, all data are rescaled</span>
        <span class="c1"># by the inverse variances</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaled_covariance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">err</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">err</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled_covariance</span><span class="p">)</span> <span class="o">&gt;</span>
                      <span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;The covariance matrix is not positive definite!&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">covariance</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.MultivariateNormalDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get `size` random numbers (default: a single one)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">reduce_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a different instance where certain dimensions, specified by</span>
<span class="sd">        the iterable of integers `exclude`, are removed from the covariance.</span>

<span class="sd">        If `exclude` contains all indices but one, an instance of</span>
<span class="sd">        `NormalDistribution` will be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">exclude</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="c1"># if parameters are to be excluded, construct a</span>
        <span class="c1"># distribution with reduced mean vector and covariance matrix</span>
        <span class="n">_cent_ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="n">exclude</span><span class="p">)</span>
        <span class="n">_cov_ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">,</span> <span class="n">exclude</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">exclude</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_cent_ex</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># if only 1 dimension remains, can use a univariate Gaussian</span>
            <span class="n">_dist_ex</span> <span class="o">=</span> <span class="n">NormalDistribution</span><span class="p">(</span>
                <span class="n">central_value</span><span class="o">=</span><span class="n">_cent_ex</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">standard_deviation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">_cov_ex</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if more than 1 dimension remains, use a (smaller)</span>
            <span class="c1"># multivariate Gaussian</span>
            <span class="n">_dist_ex</span> <span class="o">=</span> <span class="n">MultivariateNormalDistribution</span><span class="p">(</span>
                <span class="n">central_value</span><span class="o">=</span><span class="n">_cent_ex</span><span class="p">,</span> <span class="n">covariance</span><span class="o">=</span><span class="n">_cov_ex</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_dist_ex</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the logarithm of the probability density function.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - x: vector; position at which PDF should be evaluated</span>
<span class="sd">        - exclude: optional; if an iterable of integers is given, the parameters</span>
<span class="sd">          at these positions will be removed from the covariance before</span>
<span class="sd">          evaluating the PDF, effectively ignoring certain dimensions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># if parameters are to be excluded, construct a temporary</span>
            <span class="c1"># distribution with reduced mean vector and covariance matrix</span>
            <span class="c1"># and call its logpdf method</span>
            <span class="n">_dist_ex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce_dimension</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">_dist_ex</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="c1"># undoing the rescaling of the covariance</span>
        <span class="n">pdf_scaled</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span>
            <span class="n">x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">err</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">err</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaled_covariance</span><span class="p">)</span>
        <span class="n">sign</span><span class="p">,</span> <span class="n">logdet</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pdf_scaled</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled_covariance</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower errors&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">err</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper errors&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">err</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.statistics.probability.MultivariateNormalDistribution">MultivariateNormalDistribution</a></li>
          <li><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNormalDistribution.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, central_value, covariance=None, standard_deviation=None, correlation=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize PDF instance.</p>
<p>Parameters:</p>
<ul>
<li>central_value: vector of means, shape (n)</li>
<li>covariance: covariance matrix, shape (n,n)</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNormalDistribution.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNormalDistribution.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">covariance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">standard_deviation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">correlation</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize PDF instance.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - central_value: vector of means, shape (n)</span>
<span class="sd">    - covariance: covariance matrix, shape (n,n)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">covariance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="n">covariance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">,</span>
                                                    <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>
        <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">correlation</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">standard_deviation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You must specify either covariance or standard_deviation&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">standard_deviation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">correlation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">correlation</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                <span class="c1"># if it&#39;s a number, return delta_ij + (1-delta_ij)*x</span>
                <span class="n">n_dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">central_value</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n_dim</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n_dim</span><span class="p">,</span> <span class="n">n_dim</span><span class="p">))</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n_dim</span><span class="p">))</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">correlation</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">correlation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">correlation</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">central_value</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">central_value</span><span class="p">)</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span>
                <span class="p">]))</span>
    <span class="c1"># to avoid ill-conditioned covariance matrices, all data are rescaled</span>
    <span class="c1"># by the inverse variances</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scaled_covariance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">err</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">err</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled_covariance</span><span class="p">)</span> <span class="o">&gt;</span>
                  <span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;The covariance matrix is not positive definite!&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">covariance</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNormalDistribution.delta_logpdf">
    <p>def <span class="ident">delta_logpdf</span>(</p><p>self, x, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNormalDistribution.delta_logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNormalDistribution.delta_logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNormalDistribution.get_central">
    <p>def <span class="ident">get_central</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNormalDistribution.get_central', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNormalDistribution.get_central" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNormalDistribution.get_dict">
    <p>def <span class="ident">get_dict</span>(</p><p>self, distribution=False, iterate=False, arraytolist=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get an ordered dictionary with arguments and values needed to
the instantiate the distribution.</p>
<p>Optional arguments (default to False):</p>
<ul>
<li><code>distribution</code>: add a 'distribution' key to the dictionary with the
value being the string representation of the distribution's name
(e.g. 'asymmetric_normal').</li>
<li><code>iterate</code>: If ProbabilityDistribution instances are among the
arguments (e.g. for KernelDensityEstimate), return the instance's
get_dict instead of the instance as value.</li>
<li><code>arraytolist</code>: convert numpy arrays to lists</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNormalDistribution.get_dict', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNormalDistribution.get_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">    the instantiate the distribution.</span>
<span class="sd">    Optional arguments (default to False):</span>
<span class="sd">    - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">    value being the string representation of the distribution&#39;s name</span>
<span class="sd">    (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">    - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">    arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">    get_dict instead of the instance as value.</span>
<span class="sd">    - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
    <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
        <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
    <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">od</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNormalDistribution.get_error_left">
    <p>def <span class="ident">get_error_left</span>(</p><p>self, nsigma=1)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the lower errors</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNormalDistribution.get_error_left', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNormalDistribution.get_error_left" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the lower errors&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">err</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNormalDistribution.get_error_right">
    <p>def <span class="ident">get_error_right</span>(</p><p>self, nsigma=1)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the upper errors</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNormalDistribution.get_error_right', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNormalDistribution.get_error_right" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the upper errors&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">err</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNormalDistribution.get_random">
    <p>def <span class="ident">get_random</span>(</p><p>self, size=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get <code>size</code> random numbers (default: a single one)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNormalDistribution.get_random', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNormalDistribution.get_random" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get `size` random numbers (default: a single one)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNormalDistribution.get_yaml">
    <p>def <span class="ident">get_yaml</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a YAML string representing the dictionary returned by the
get_dict method.</p>
<p>Arguments will be passed to <code>yaml.dump</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNormalDistribution.get_yaml', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNormalDistribution.get_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">    get_dict method.</span>
<span class="sd">    Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
    <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNormalDistribution.logpdf">
    <p>def <span class="ident">logpdf</span>(</p><p>self, x, exclude=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the logarithm of the probability density function.</p>
<p>Parameters:</p>
<ul>
<li>x: vector; position at which PDF should be evaluated</li>
<li>exclude: optional; if an iterable of integers is given, the parameters
  at these positions will be removed from the covariance before
  evaluating the PDF, effectively ignoring certain dimensions.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNormalDistribution.logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNormalDistribution.logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the logarithm of the probability density function.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - x: vector; position at which PDF should be evaluated</span>
<span class="sd">    - exclude: optional; if an iterable of integers is given, the parameters</span>
<span class="sd">      at these positions will be removed from the covariance before</span>
<span class="sd">      evaluating the PDF, effectively ignoring certain dimensions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># if parameters are to be excluded, construct a temporary</span>
        <span class="c1"># distribution with reduced mean vector and covariance matrix</span>
        <span class="c1"># and call its logpdf method</span>
        <span class="n">_dist_ex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce_dimension</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_dist_ex</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="c1"># undoing the rescaling of the covariance</span>
    <span class="n">pdf_scaled</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">err</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">err</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaled_covariance</span><span class="p">)</span>
    <span class="n">sign</span><span class="p">,</span> <span class="n">logdet</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pdf_scaled</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled_covariance</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">slogdet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNormalDistribution.reduce_dimension">
    <p>def <span class="ident">reduce_dimension</span>(</p><p>self, exclude=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Return a different instance where certain dimensions, specified by
the iterable of integers <code>exclude</code>, are removed from the covariance.</p>
<p>If <code>exclude</code> contains all indices but one, an instance of
<code>NormalDistribution</code> will be returned.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNormalDistribution.reduce_dimension', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNormalDistribution.reduce_dimension" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">reduce_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a different instance where certain dimensions, specified by</span>
<span class="sd">    the iterable of integers `exclude`, are removed from the covariance.</span>
<span class="sd">    If `exclude` contains all indices but one, an instance of</span>
<span class="sd">    `NormalDistribution` will be returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">exclude</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="c1"># if parameters are to be excluded, construct a</span>
    <span class="c1"># distribution with reduced mean vector and covariance matrix</span>
    <span class="n">_cent_ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="n">exclude</span><span class="p">)</span>
    <span class="n">_cov_ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">,</span> <span class="n">exclude</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">exclude</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_cent_ex</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># if only 1 dimension remains, can use a univariate Gaussian</span>
        <span class="n">_dist_ex</span> <span class="o">=</span> <span class="n">NormalDistribution</span><span class="p">(</span>
            <span class="n">central_value</span><span class="o">=</span><span class="n">_cent_ex</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">standard_deviation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">_cov_ex</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># if more than 1 dimension remains, use a (smaller)</span>
        <span class="c1"># multivariate Gaussian</span>
        <span class="n">_dist_ex</span> <span class="o">=</span> <span class="n">MultivariateNormalDistribution</span><span class="p">(</span>
            <span class="n">central_value</span><span class="o">=</span><span class="n">_cent_ex</span><span class="p">,</span> <span class="n">covariance</span><span class="o">=</span><span class="n">_cov_ex</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_dist_ex</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.statistics.probability.MultivariateNormalDistribution.err" class="name">var <span class="ident">err</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.MultivariateNormalDistribution.error_left" class="name">var <span class="ident">error_left</span></p>
            

            
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.MultivariateNormalDistribution.error_right" class="name">var <span class="ident">error_right</span></p>
            

            
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.MultivariateNormalDistribution.scaled_covariance" class="name">var <span class="ident">scaled_covariance</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNormalDistribution.class_to_string">
    <p>def <span class="ident">class_to_string</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a string name for a given ProbabilityDistribution subclass.</p>
<p>This converts camel case to underscore and removes the word
'distribution'.</p>
<p>Example: class_to_string(AsymmetricNormalDistribution) returns
'asymmetric_normal'.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNormalDistribution.class_to_string', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNormalDistribution.class_to_string" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>
<span class="sd">    This converts camel case to underscore and removes the word</span>
<span class="sd">    &#39;distribution&#39;.</span>
<span class="sd">    Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">    &#39;asymmetric_normal&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNormalDistribution.get_subclasses">
    <p>def <span class="ident">get_subclasses</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Return all subclasses (including subclasses of subclasses).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNormalDistribution.get_subclasses', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNormalDistribution.get_subclasses" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">subclass</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="flavio.statistics.probability.MultivariateNumericalDistribution" class="name">class <span class="ident">MultivariateNumericalDistribution</span></p>
      
  
    <div class="desc"><p>A multivariate distribution with PDF specified numerically.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNumericalDistribution', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNumericalDistribution" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MultivariateNumericalDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A multivariate distribution with PDF specified numerically.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">central_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize a multivariate numerical distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - `xi`: for an N-dimensional distribution, a list of N 1D arrays</span>
<span class="sd">          specifiying the grid in N dimensions. The 1D arrays must contain</span>
<span class="sd">          real, evenly spaced values in strictly ascending order (but the</span>
<span class="sd">          spacing can be different for different dimensions). Any of the 1D</span>
<span class="sd">          arrays can also be given alternatively as a list of two numbers, which</span>
<span class="sd">          will be assumed to be the upper and lower boundaries, while the</span>
<span class="sd">          spacing will be determined from the shape of `y`.</span>
<span class="sd">        - `y`: PDF values on the grid defined by the `xi`. If the N `xi` have</span>
<span class="sd">          length M1, ..., MN, `y` has dimension (M1, ..., MN). This is the same</span>
<span class="sd">          shape as the grid obtained from `numpy.meshgrid(*xi, indexing=&#39;ij&#39;)`.</span>
<span class="sd">        - central_value: if None (default), will be set to the mode of the</span>
<span class="sd">          distribution, i.e. the N-dimensional xi-vector where y is largest</span>
<span class="sd">          (by looking up the input arrays, i.e. without interpolation!)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">:</span>
            <span class="c1"># check that grid spacings are even up to per mille precision</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-3</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Grid must be evenly spaced per dimension&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">xi</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">central_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">central_value</span><span class="p">,</span>
                             <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if no central value is specified, set it to the mode</span>
            <span class="n">mode_index</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">argmax</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">))[</span><span class="n">mode_index</span><span class="p">]</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">_bin_volume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="n">_bin_volume</span>  <span class="c1"># normalize PDF to 1</span>
        <span class="c1"># ignore warning from log(0)=-np.inf</span>
        <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
            <span class="c1"># logy = np.nan_to_num(np.log(self.y_norm))</span>
            <span class="n">logy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span><span class="p">)</span>
            <span class="n">logy</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isneginf</span><span class="p">(</span><span class="n">logy</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1e100</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logpdf_interp</span> <span class="o">=</span> <span class="n">RegularGridInterpolator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">,</span> <span class="n">logy</span><span class="p">,</span>
                                        <span class="n">fill_value</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># the following is needed for get_random: initialize to None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y_flat</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cdf_flat</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.MultivariateNumericalDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Draw a random number from the distribution.</span>

<span class="sd">        If size is not None but an integer N, return an array of N numbers.</span>

<span class="sd">        For the MultivariateNumericalDistribution, the PDF from which the</span>
<span class="sd">        random numbers are drawn is approximated to be piecewise constant in</span>
<span class="sd">        hypercubes around the points of the lattice spanned by the `xi`. A finer</span>
<span class="sd">        lattice spacing will lead to a smoother distribution of random numbers</span>
<span class="sd">        (but will also be slower).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)])</span>

    <span class="k">def</span> <span class="nf">_get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># if these have not been initialized, do it (once)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y_flat</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># get a flattened array of the PDF</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_y_flat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cdf_flat</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># get the (discrete) 1D CDF</span>
            <span class="n">_cdf_flat</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_y_flat</span><span class="p">)</span>
            <span class="c1"># normalize to 1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cdf_flat</span> <span class="o">=</span> <span class="n">_cdf_flat</span><span class="o">/</span><span class="n">_cdf_flat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># draw a number between 0 and 1</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">()</span>
        <span class="c1"># find the index of the CDF-value closest to r</span>
        <span class="n">i_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cdf_flat</span><span class="o">-</span><span class="n">r</span><span class="p">))</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y_flat</span><span class="p">[</span><span class="n">i_r</span><span class="p">])</span>
        <span class="n">i_bla</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">index</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">a</span><span class="p">[</span><span class="n">i_bla</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">])</span>
        <span class="n">xi_r</span> <span class="o">=</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">))</span> <span class="p">]</span>
        <span class="n">xi_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">X</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="p">])</span>
        <span class="k">return</span> <span class="n">xi_r</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">))</span> <span class="o">*</span> <span class="n">xi_diff</span>

    <span class="k">def</span> <span class="nf">reduce_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a different instance where certain dimensions, specified by</span>
<span class="sd">        the iterable of integers `exclude`, are removed from the covariance.</span>

<span class="sd">        If `exclude` contains all indices but one, an instance of</span>
<span class="sd">        `NumericalDistribution` will be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">exclude</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="c1"># if parameters are to be excluded, construct a</span>
        <span class="c1"># distribution with reduced mean vector and covariance matrix</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">exclude</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">exclude</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">exclude</span> <span class="o">=</span> <span class="p">(</span><span class="n">exclude</span><span class="p">,)</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">exclude</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">exclude</span><span class="p">))</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">exclude</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># if there is just 1 dimension left, use univariate</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">NumericalDistribution</span><span class="p">(</span><span class="n">xi</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">MultivariateNumericalDistribution</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dist</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the logarithm of the probability density function.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - x: vector; position at which PDF should be evaluated</span>
<span class="sd">        - exclude: optional; if an iterable of integers is given, the parameters</span>
<span class="sd">          at these positions will be ignored by maximizing the likelihood</span>
<span class="sd">          along the remaining directions, i.e., they will be &quot;profiled out&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># if parameters are to be excluded, construct a temporary</span>
            <span class="c1"># distribution with reduced mean vector and covariance matrix</span>
            <span class="c1"># and call its logpdf method</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce_dimension</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">dist</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">),):</span>
            <span class="c1"># return a scalar</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;1D errors not implemented for multivariate numerical distributions&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;1D errors not implemented for multivariate numerical distributions&quot;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_pd</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pd</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
        <span class="k">if</span>  <span class="nb">isinstance</span><span class="p">(</span><span class="n">pd</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
            <span class="c1"># nothing to do</span>
            <span class="k">return</span> <span class="n">pd</span>
        <span class="n">_xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">nsteps</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">central_value</span><span class="p">))])</span>
        <span class="n">ndim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">_xi</span><span class="p">)</span>
        <span class="n">_xlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="o">*</span><span class="n">_xi</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ndim</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">**</span><span class="n">ndim</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="n">_ylist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">_xlist</span><span class="p">))</span>
        <span class="n">_y</span> <span class="o">=</span> <span class="n">_ylist</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">nsteps</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="n">xi</span><span class="o">=</span><span class="n">_xi</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">_y</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.statistics.probability.MultivariateNumericalDistribution">MultivariateNumericalDistribution</a></li>
          <li><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNumericalDistribution.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, xi, y, central_value=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize a multivariate numerical distribution.</p>
<p>Parameters:</p>
<ul>
<li><code>xi</code>: for an N-dimensional distribution, a list of N 1D arrays
  specifiying the grid in N dimensions. The 1D arrays must contain
  real, evenly spaced values in strictly ascending order (but the
  spacing can be different for different dimensions). Any of the 1D
  arrays can also be given alternatively as a list of two numbers, which
  will be assumed to be the upper and lower boundaries, while the
  spacing will be determined from the shape of <code>y</code>.</li>
<li><code>y</code>: PDF values on the grid defined by the <code>xi</code>. If the N <code>xi</code> have
  length M1, ..., MN, <code>y</code> has dimension (M1, ..., MN). This is the same
  shape as the grid obtained from <code>numpy.meshgrid(*xi, indexing='ij')</code>.</li>
<li>central_value: if None (default), will be set to the mode of the
  distribution, i.e. the N-dimensional xi-vector where y is largest
  (by looking up the input arrays, i.e. without interpolation!)</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNumericalDistribution.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNumericalDistribution.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">central_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize a multivariate numerical distribution.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - `xi`: for an N-dimensional distribution, a list of N 1D arrays</span>
<span class="sd">      specifiying the grid in N dimensions. The 1D arrays must contain</span>
<span class="sd">      real, evenly spaced values in strictly ascending order (but the</span>
<span class="sd">      spacing can be different for different dimensions). Any of the 1D</span>
<span class="sd">      arrays can also be given alternatively as a list of two numbers, which</span>
<span class="sd">      will be assumed to be the upper and lower boundaries, while the</span>
<span class="sd">      spacing will be determined from the shape of `y`.</span>
<span class="sd">    - `y`: PDF values on the grid defined by the `xi`. If the N `xi` have</span>
<span class="sd">      length M1, ..., MN, `y` has dimension (M1, ..., MN). This is the same</span>
<span class="sd">      shape as the grid obtained from `numpy.meshgrid(*xi, indexing=&#39;ij&#39;)`.</span>
<span class="sd">    - central_value: if None (default), will be set to the mode of the</span>
<span class="sd">      distribution, i.e. the N-dimensional xi-vector where y is largest</span>
<span class="sd">      (by looking up the input arrays, i.e. without interpolation!)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">:</span>
        <span class="c1"># check that grid spacings are even up to per mille precision</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Grid must be evenly spaced per dimension&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">xi</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">central_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">central_value</span><span class="p">,</span>
                         <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># if no central value is specified, set it to the mode</span>
        <span class="n">mode_index</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">argmax</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">))[</span><span class="n">mode_index</span><span class="p">]</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">_bin_volume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="n">_bin_volume</span>  <span class="c1"># normalize PDF to 1</span>
    <span class="c1"># ignore warning from log(0)=-np.inf</span>
    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
        <span class="c1"># logy = np.nan_to_num(np.log(self.y_norm))</span>
        <span class="n">logy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span><span class="p">)</span>
        <span class="n">logy</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isneginf</span><span class="p">(</span><span class="n">logy</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1e100</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logpdf_interp</span> <span class="o">=</span> <span class="n">RegularGridInterpolator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">,</span> <span class="n">logy</span><span class="p">,</span>
                                    <span class="n">fill_value</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># the following is needed for get_random: initialize to None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_y_flat</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_cdf_flat</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNumericalDistribution.delta_logpdf">
    <p>def <span class="ident">delta_logpdf</span>(</p><p>self, x, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNumericalDistribution.delta_logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNumericalDistribution.delta_logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNumericalDistribution.get_central">
    <p>def <span class="ident">get_central</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNumericalDistribution.get_central', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNumericalDistribution.get_central" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNumericalDistribution.get_dict">
    <p>def <span class="ident">get_dict</span>(</p><p>self, distribution=False, iterate=False, arraytolist=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get an ordered dictionary with arguments and values needed to
the instantiate the distribution.</p>
<p>Optional arguments (default to False):</p>
<ul>
<li><code>distribution</code>: add a 'distribution' key to the dictionary with the
value being the string representation of the distribution's name
(e.g. 'asymmetric_normal').</li>
<li><code>iterate</code>: If ProbabilityDistribution instances are among the
arguments (e.g. for KernelDensityEstimate), return the instance's
get_dict instead of the instance as value.</li>
<li><code>arraytolist</code>: convert numpy arrays to lists</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNumericalDistribution.get_dict', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNumericalDistribution.get_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">    the instantiate the distribution.</span>
<span class="sd">    Optional arguments (default to False):</span>
<span class="sd">    - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">    value being the string representation of the distribution&#39;s name</span>
<span class="sd">    (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">    - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">    arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">    get_dict instead of the instance as value.</span>
<span class="sd">    - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
    <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
        <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
    <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">od</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNumericalDistribution.get_error_left">
    <p>def <span class="ident">get_error_left</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNumericalDistribution.get_error_left', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNumericalDistribution.get_error_left" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
        <span class="s2">&quot;1D errors not implemented for multivariate numerical distributions&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNumericalDistribution.get_error_right">
    <p>def <span class="ident">get_error_right</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNumericalDistribution.get_error_right', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNumericalDistribution.get_error_right" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
        <span class="s2">&quot;1D errors not implemented for multivariate numerical distributions&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNumericalDistribution.get_random">
    <p>def <span class="ident">get_random</span>(</p><p>self, size=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Draw a random number from the distribution.</p>
<p>If size is not None but an integer N, return an array of N numbers.</p>
<p>For the MultivariateNumericalDistribution, the PDF from which the
random numbers are drawn is approximated to be piecewise constant in
hypercubes around the points of the lattice spanned by the <code>xi</code>. A finer
lattice spacing will lead to a smoother distribution of random numbers
(but will also be slower).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNumericalDistribution.get_random', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNumericalDistribution.get_random" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Draw a random number from the distribution.</span>
<span class="sd">    If size is not None but an integer N, return an array of N numbers.</span>
<span class="sd">    For the MultivariateNumericalDistribution, the PDF from which the</span>
<span class="sd">    random numbers are drawn is approximated to be piecewise constant in</span>
<span class="sd">    hypercubes around the points of the lattice spanned by the `xi`. A finer</span>
<span class="sd">    lattice spacing will lead to a smoother distribution of random numbers</span>
<span class="sd">    (but will also be slower).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_random</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)])</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNumericalDistribution.get_yaml">
    <p>def <span class="ident">get_yaml</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a YAML string representing the dictionary returned by the
get_dict method.</p>
<p>Arguments will be passed to <code>yaml.dump</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNumericalDistribution.get_yaml', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNumericalDistribution.get_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">    get_dict method.</span>
<span class="sd">    Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
    <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNumericalDistribution.logpdf">
    <p>def <span class="ident">logpdf</span>(</p><p>self, x, exclude=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the logarithm of the probability density function.</p>
<p>Parameters:</p>
<ul>
<li>x: vector; position at which PDF should be evaluated</li>
<li>exclude: optional; if an iterable of integers is given, the parameters
  at these positions will be ignored by maximizing the likelihood
  along the remaining directions, i.e., they will be "profiled out".</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNumericalDistribution.logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNumericalDistribution.logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the logarithm of the probability density function.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - x: vector; position at which PDF should be evaluated</span>
<span class="sd">    - exclude: optional; if an iterable of integers is given, the parameters</span>
<span class="sd">      at these positions will be ignored by maximizing the likelihood</span>
<span class="sd">      along the remaining directions, i.e., they will be &quot;profiled out&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># if parameters are to be excluded, construct a temporary</span>
        <span class="c1"># distribution with reduced mean vector and covariance matrix</span>
        <span class="c1"># and call its logpdf method</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce_dimension</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dist</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">),):</span>
        <span class="c1"># return a scalar</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNumericalDistribution.reduce_dimension">
    <p>def <span class="ident">reduce_dimension</span>(</p><p>self, exclude=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Return a different instance where certain dimensions, specified by
the iterable of integers <code>exclude</code>, are removed from the covariance.</p>
<p>If <code>exclude</code> contains all indices but one, an instance of
<code>NumericalDistribution</code> will be returned.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNumericalDistribution.reduce_dimension', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNumericalDistribution.reduce_dimension" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">reduce_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a different instance where certain dimensions, specified by</span>
<span class="sd">    the iterable of integers `exclude`, are removed from the covariance.</span>
<span class="sd">    If `exclude` contains all indices but one, an instance of</span>
<span class="sd">    `NumericalDistribution` will be returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">exclude</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="c1"># if parameters are to be excluded, construct a</span>
    <span class="c1"># distribution with reduced mean vector and covariance matrix</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">exclude</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">exclude</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="n">exclude</span> <span class="o">=</span> <span class="p">(</span><span class="n">exclude</span><span class="p">,)</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">exclude</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">exclude</span><span class="p">))</span>
    <span class="n">cv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">exclude</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># if there is just 1 dimension left, use univariate</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">NumericalDistribution</span><span class="p">(</span><span class="n">xi</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">MultivariateNumericalDistribution</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dist</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.statistics.probability.MultivariateNumericalDistribution.error_left" class="name">var <span class="ident">error_left</span></p>
            

            
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.MultivariateNumericalDistribution.error_right" class="name">var <span class="ident">error_right</span></p>
            

            
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.MultivariateNumericalDistribution.xi" class="name">var <span class="ident">xi</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.MultivariateNumericalDistribution.y" class="name">var <span class="ident">y</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.MultivariateNumericalDistribution.y_norm" class="name">var <span class="ident">y_norm</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNumericalDistribution.class_to_string">
    <p>def <span class="ident">class_to_string</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a string name for a given ProbabilityDistribution subclass.</p>
<p>This converts camel case to underscore and removes the word
'distribution'.</p>
<p>Example: class_to_string(AsymmetricNormalDistribution) returns
'asymmetric_normal'.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNumericalDistribution.class_to_string', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNumericalDistribution.class_to_string" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>
<span class="sd">    This converts camel case to underscore and removes the word</span>
<span class="sd">    &#39;distribution&#39;.</span>
<span class="sd">    Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">    &#39;asymmetric_normal&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNumericalDistribution.from_pd">
    <p>def <span class="ident">from_pd</span>(</p><p>cls, pd, nsteps=100)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNumericalDistribution.from_pd', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNumericalDistribution.from_pd" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_pd</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pd</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="k">if</span>  <span class="nb">isinstance</span><span class="p">(</span><span class="n">pd</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
        <span class="c1"># nothing to do</span>
        <span class="k">return</span> <span class="n">pd</span>
    <span class="n">_xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">nsteps</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">central_value</span><span class="p">))])</span>
    <span class="n">ndim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">_xi</span><span class="p">)</span>
    <span class="n">_xlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="o">*</span><span class="n">_xi</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ndim</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">**</span><span class="n">ndim</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">_ylist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">_xlist</span><span class="p">))</span>
    <span class="n">_y</span> <span class="o">=</span> <span class="n">_ylist</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">nsteps</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">)))</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="n">xi</span><span class="o">=</span><span class="n">_xi</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">_y</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.MultivariateNumericalDistribution.get_subclasses">
    <p>def <span class="ident">get_subclasses</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Return all subclasses (including subclasses of subclasses).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.MultivariateNumericalDistribution.get_subclasses', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.MultivariateNumericalDistribution.get_subclasses" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">subclass</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="flavio.statistics.probability.NormalDistribution" class="name">class <span class="ident">NormalDistribution</span></p>
      
  
    <div class="desc"><p>Univariate normal or Gaussian distribution.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NormalDistribution', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NormalDistribution" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">NormalDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Univariate normal or Gaussian distribution.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">standard_deviation</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - central_value: location (mode and mean)</span>
<span class="sd">        - standard_deviation: standard deviation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span>
                         <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">central_value</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">standard_deviation</span><span class="p">,</span>
                                  <span class="n">central_value</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">standard_deviation</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">standard_deviation</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Standard deviation must be positive number&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">=</span> <span class="n">standard_deviation</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.NormalDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">normal_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">normal_pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.statistics.probability.NormalDistribution">NormalDistribution</a></li>
          <li><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NormalDistribution.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, central_value, standard_deviation)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize the distribution.</p>
<p>Parameters:</p>
<ul>
<li>central_value: location (mode and mean)</li>
<li>standard_deviation: standard deviation</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NormalDistribution.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NormalDistribution.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">standard_deviation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - central_value: location (mode and mean)</span>
<span class="sd">    - standard_deviation: standard deviation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span>
                     <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">central_value</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">standard_deviation</span><span class="p">,</span>
                              <span class="n">central_value</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">standard_deviation</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">standard_deviation</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Standard deviation must be positive number&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">=</span> <span class="n">standard_deviation</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NormalDistribution.cdf">
    <p>def <span class="ident">cdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NormalDistribution.cdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NormalDistribution.cdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NormalDistribution.delta_logpdf">
    <p>def <span class="ident">delta_logpdf</span>(</p><p>self, x, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NormalDistribution.delta_logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NormalDistribution.delta_logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NormalDistribution.get_central">
    <p>def <span class="ident">get_central</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NormalDistribution.get_central', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NormalDistribution.get_central" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NormalDistribution.get_dict">
    <p>def <span class="ident">get_dict</span>(</p><p>self, distribution=False, iterate=False, arraytolist=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get an ordered dictionary with arguments and values needed to
the instantiate the distribution.</p>
<p>Optional arguments (default to False):</p>
<ul>
<li><code>distribution</code>: add a 'distribution' key to the dictionary with the
value being the string representation of the distribution's name
(e.g. 'asymmetric_normal').</li>
<li><code>iterate</code>: If ProbabilityDistribution instances are among the
arguments (e.g. for KernelDensityEstimate), return the instance's
get_dict instead of the instance as value.</li>
<li><code>arraytolist</code>: convert numpy arrays to lists</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NormalDistribution.get_dict', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NormalDistribution.get_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">    the instantiate the distribution.</span>
<span class="sd">    Optional arguments (default to False):</span>
<span class="sd">    - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">    value being the string representation of the distribution&#39;s name</span>
<span class="sd">    (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">    - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">    arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">    get_dict instead of the instance as value.</span>
<span class="sd">    - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
    <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
        <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
    <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">od</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NormalDistribution.get_error_left">
    <p>def <span class="ident">get_error_left</span>(</p><p>self, nsigma=1, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NormalDistribution.get_error_left', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NormalDistribution.get_error_left" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NormalDistribution.get_error_right">
    <p>def <span class="ident">get_error_right</span>(</p><p>self, nsigma=1, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NormalDistribution.get_error_right', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NormalDistribution.get_error_right" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">nsigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NormalDistribution.get_random">
    <p>def <span class="ident">get_random</span>(</p><p>self, size=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NormalDistribution.get_random', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NormalDistribution.get_random" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NormalDistribution.get_yaml">
    <p>def <span class="ident">get_yaml</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a YAML string representing the dictionary returned by the
get_dict method.</p>
<p>Arguments will be passed to <code>yaml.dump</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NormalDistribution.get_yaml', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NormalDistribution.get_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">    get_dict method.</span>
<span class="sd">    Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
    <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NormalDistribution.logpdf">
    <p>def <span class="ident">logpdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NormalDistribution.logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NormalDistribution.logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">normal_logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NormalDistribution.pdf">
    <p>def <span class="ident">pdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NormalDistribution.pdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NormalDistribution.pdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">normal_pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NormalDistribution.ppf">
    <p>def <span class="ident">ppf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NormalDistribution.ppf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NormalDistribution.ppf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.statistics.probability.NormalDistribution.error_left" class="name">var <span class="ident">error_left</span></p>
            

            
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.NormalDistribution.error_right" class="name">var <span class="ident">error_right</span></p>
            

            
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.NormalDistribution.standard_deviation" class="name">var <span class="ident">standard_deviation</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NormalDistribution.class_to_string">
    <p>def <span class="ident">class_to_string</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a string name for a given ProbabilityDistribution subclass.</p>
<p>This converts camel case to underscore and removes the word
'distribution'.</p>
<p>Example: class_to_string(AsymmetricNormalDistribution) returns
'asymmetric_normal'.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NormalDistribution.class_to_string', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NormalDistribution.class_to_string" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>
<span class="sd">    This converts camel case to underscore and removes the word</span>
<span class="sd">    &#39;distribution&#39;.</span>
<span class="sd">    Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">    &#39;asymmetric_normal&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NormalDistribution.get_subclasses">
    <p>def <span class="ident">get_subclasses</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Return all subclasses (including subclasses of subclasses).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NormalDistribution.get_subclasses', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NormalDistribution.get_subclasses" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">subclass</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="flavio.statistics.probability.NumericalDistribution" class="name">class <span class="ident">NumericalDistribution</span></p>
      
  
    <div class="desc"><p>Univariate distribution defined in terms of numerical values for the
PDF.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NumericalDistribution', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NumericalDistribution" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">NumericalDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Univariate distribution defined in terms of numerical values for the</span>
<span class="sd">    PDF.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">central_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize a 1D numerical distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - `x`: x-axis values. Must be a 1D array of real values in strictly</span>
<span class="sd">          ascending order (but not necessarily evenly spaced)</span>
<span class="sd">        - `y`: PDF values. Must be a 1D array of real positive values with the</span>
<span class="sd">          same length as `x`</span>
<span class="sd">        - central_value: if None (default), will be set to the mode of the</span>
<span class="sd">          distribution, i.e. the x-value where y is largest (by looking up</span>
<span class="sd">          the input arrays, i.e. without interpolation!)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="k">if</span> <span class="n">central_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">central_value</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">central_value</span><span class="p">,</span>
                                 <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Central value must be within range provided&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span>  <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># normalize PDF to 1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span><span class="p">,</span>
                                        <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">_cdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">_cdf</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">_cdf</span> <span class="o">=</span> <span class="n">_cdf</span><span class="o">/</span><span class="n">_cdf</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># normalize CDF to 1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ppf_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">_cdf</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cdf_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">_cdf</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.NumericalDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Draw a random number from the distribution.</span>

<span class="sd">        If size is not None but an integer N, return an array of N numbers.&quot;&quot;&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_interp</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># ignore warning from log(0)=-np.inf</span>
        <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_find_error_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">confidence_level</span><span class="p">):</span>
        <span class="c1"># find the value of the CDF at the position of the left boundary</span>
        <span class="c1"># of the `confidence_level`% CL range by demanding that the value</span>
        <span class="c1"># of the PDF is the same at the two boundaries</span>
        <span class="k">def</span> <span class="nf">x_left</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">x_right</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">diff_logpdf</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="n">logpdf_x_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x_left</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
            <span class="n">logpdf_x_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x_right</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">logpdf_x_left</span> <span class="o">-</span> <span class="n">logpdf_x_right</span>
        <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="n">diff_logpdf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="o">-</span><span class="mf">1e-6</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower error.</span>

<span class="sd">        &#39;method&#39; should be one of:</span>

<span class="sd">        - &#39;central&#39; for a central interval (same probability on both sides of</span>
<span class="sd">          the central value)</span>
<span class="sd">        - &#39;hpd&#39; for highest posterior density, i.e. probability is larger inside</span>
<span class="sd">          the interval than outside</span>
<span class="sd">        - &#39;limit&#39; for a one-sided error, i.e. a lower limit&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;limit&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="n">cdf_central</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">err_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">cdf_central</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;central&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">err_left</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;hpd&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_error_right</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="n">err_left</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">err_left</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Method &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">method</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; unknown&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper error</span>

<span class="sd">        &#39;method&#39; should be one of:</span>

<span class="sd">        - &#39;central&#39; for a central interval (same probability on both sides of</span>
<span class="sd">          the central value)</span>
<span class="sd">        - &#39;hpd&#39; for highest posterior density, i.e. probability is larger inside</span>
<span class="sd">          the interval than outside</span>
<span class="sd">        - &#39;limit&#39; for a one-sided error, i.e. an upper limit&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;limit&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
        <span class="n">cdf_central</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">err_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">cdf_central</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cdf_central</span><span class="p">)</span> <span class="o">*</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;central&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">err_right</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;hpd&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_error_left</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="n">err_right</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">err_right</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Method &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">method</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; unknown&quot;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_pd</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pd</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pd</span><span class="p">,</span> <span class="n">NumericalDistribution</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pd</span>
        <span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">nsteps</span><span class="p">)</span>
        <span class="n">_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">_x</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">_y</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.statistics.probability.NumericalDistribution">NumericalDistribution</a></li>
          <li><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NumericalDistribution.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, x, y, central_value=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize a 1D numerical distribution.</p>
<p>Parameters:</p>
<ul>
<li><code>x</code>: x-axis values. Must be a 1D array of real values in strictly
  ascending order (but not necessarily evenly spaced)</li>
<li><code>y</code>: PDF values. Must be a 1D array of real positive values with the
  same length as <code>x</code></li>
<li>central_value: if None (default), will be set to the mode of the
  distribution, i.e. the x-value where y is largest (by looking up
  the input arrays, i.e. without interpolation!)</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NumericalDistribution.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NumericalDistribution.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">central_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize a 1D numerical distribution.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - `x`: x-axis values. Must be a 1D array of real values in strictly</span>
<span class="sd">      ascending order (but not necessarily evenly spaced)</span>
<span class="sd">    - `y`: PDF values. Must be a 1D array of real positive values with the</span>
<span class="sd">      same length as `x`</span>
<span class="sd">    - central_value: if None (default), will be set to the mode of the</span>
<span class="sd">      distribution, i.e. the x-value where y is largest (by looking up</span>
<span class="sd">      the input arrays, i.e. without interpolation!)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">if</span> <span class="n">central_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">central_value</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">central_value</span><span class="p">,</span>
                             <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Central value must be within range provided&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span>  <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># normalize PDF to 1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pdf_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span><span class="p">,</span>
                                    <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">_cdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">_cdf</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_norm</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">_cdf</span> <span class="o">=</span> <span class="n">_cdf</span><span class="o">/</span><span class="n">_cdf</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># normalize CDF to 1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ppf_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">_cdf</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cdf_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">_cdf</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NumericalDistribution.cdf">
    <p>def <span class="ident">cdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NumericalDistribution.cdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NumericalDistribution.cdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NumericalDistribution.delta_logpdf">
    <p>def <span class="ident">delta_logpdf</span>(</p><p>self, x, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NumericalDistribution.delta_logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NumericalDistribution.delta_logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NumericalDistribution.get_central">
    <p>def <span class="ident">get_central</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NumericalDistribution.get_central', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NumericalDistribution.get_central" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NumericalDistribution.get_dict">
    <p>def <span class="ident">get_dict</span>(</p><p>self, distribution=False, iterate=False, arraytolist=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get an ordered dictionary with arguments and values needed to
the instantiate the distribution.</p>
<p>Optional arguments (default to False):</p>
<ul>
<li><code>distribution</code>: add a 'distribution' key to the dictionary with the
value being the string representation of the distribution's name
(e.g. 'asymmetric_normal').</li>
<li><code>iterate</code>: If ProbabilityDistribution instances are among the
arguments (e.g. for KernelDensityEstimate), return the instance's
get_dict instead of the instance as value.</li>
<li><code>arraytolist</code>: convert numpy arrays to lists</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NumericalDistribution.get_dict', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NumericalDistribution.get_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">    the instantiate the distribution.</span>
<span class="sd">    Optional arguments (default to False):</span>
<span class="sd">    - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">    value being the string representation of the distribution&#39;s name</span>
<span class="sd">    (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">    - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">    arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">    get_dict instead of the instance as value.</span>
<span class="sd">    - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
    <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
        <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
    <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">od</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NumericalDistribution.get_error_left">
    <p>def <span class="ident">get_error_left</span>(</p><p>self, nsigma=1, method=&#39;central&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the lower error.</p>
<p>'method' should be one of:</p>
<ul>
<li>'central' for a central interval (same probability on both sides of
  the central value)</li>
<li>'hpd' for highest posterior density, i.e. probability is larger inside
  the interval than outside</li>
<li>'limit' for a one-sided error, i.e. a lower limit</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NumericalDistribution.get_error_left', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NumericalDistribution.get_error_left" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the lower error.</span>
<span class="sd">    &#39;method&#39; should be one of:</span>
<span class="sd">    - &#39;central&#39; for a central interval (same probability on both sides of</span>
<span class="sd">      the central value)</span>
<span class="sd">    - &#39;hpd&#39; for highest posterior density, i.e. probability is larger inside</span>
<span class="sd">      the interval than outside</span>
<span class="sd">    - &#39;limit&#39; for a one-sided error, i.e. a lower limit&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;limit&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
    <span class="n">cdf_central</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
    <span class="n">err_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">cdf_central</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;central&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">err_left</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;hpd&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_error_right</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="n">err_left</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">err_left</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Method &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">method</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; unknown&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NumericalDistribution.get_error_right">
    <p>def <span class="ident">get_error_right</span>(</p><p>self, nsigma=1, method=&#39;central&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the upper error</p>
<p>'method' should be one of:</p>
<ul>
<li>'central' for a central interval (same probability on both sides of
  the central value)</li>
<li>'hpd' for highest posterior density, i.e. probability is larger inside
  the interval than outside</li>
<li>'limit' for a one-sided error, i.e. an upper limit</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NumericalDistribution.get_error_right', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NumericalDistribution.get_error_right" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the upper error</span>
<span class="sd">    &#39;method&#39; should be one of:</span>
<span class="sd">    - &#39;central&#39; for a central interval (same probability on both sides of</span>
<span class="sd">      the central value)</span>
<span class="sd">    - &#39;hpd&#39; for highest posterior density, i.e. probability is larger inside</span>
<span class="sd">      the interval than outside</span>
<span class="sd">    - &#39;limit&#39; for a one-sided error, i.e. an upper limit&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;limit&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="n">cdf_central</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
    <span class="n">err_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">cdf_central</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cdf_central</span><span class="p">)</span> <span class="o">*</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;central&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">err_right</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;hpd&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_error_left</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;central&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">+</span> <span class="n">err_right</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">err_right</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_error_cdf</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Method &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">method</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; unknown&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NumericalDistribution.get_random">
    <p>def <span class="ident">get_random</span>(</p><p>self, size=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Draw a random number from the distribution.</p>
<p>If size is not None but an integer N, return an array of N numbers.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NumericalDistribution.get_random', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NumericalDistribution.get_random" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Draw a random number from the distribution.</span>
<span class="sd">    If size is not None but an integer N, return an array of N numbers.&quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_interp</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NumericalDistribution.get_yaml">
    <p>def <span class="ident">get_yaml</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a YAML string representing the dictionary returned by the
get_dict method.</p>
<p>Arguments will be passed to <code>yaml.dump</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NumericalDistribution.get_yaml', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NumericalDistribution.get_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">    get_dict method.</span>
<span class="sd">    Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
    <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NumericalDistribution.logpdf">
    <p>def <span class="ident">logpdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NumericalDistribution.logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NumericalDistribution.logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="c1"># ignore warning from log(0)=-np.inf</span>
    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NumericalDistribution.pdf">
    <p>def <span class="ident">pdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NumericalDistribution.pdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NumericalDistribution.pdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NumericalDistribution.ppf">
    <p>def <span class="ident">ppf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NumericalDistribution.ppf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NumericalDistribution.ppf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.statistics.probability.NumericalDistribution.cdf_interp" class="name">var <span class="ident">cdf_interp</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.NumericalDistribution.error_left" class="name">var <span class="ident">error_left</span></p>
            

            
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.NumericalDistribution.error_right" class="name">var <span class="ident">error_right</span></p>
            

            
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.NumericalDistribution.pdf_interp" class="name">var <span class="ident">pdf_interp</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.NumericalDistribution.ppf_interp" class="name">var <span class="ident">ppf_interp</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.NumericalDistribution.x" class="name">var <span class="ident">x</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.NumericalDistribution.y" class="name">var <span class="ident">y</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.NumericalDistribution.y_norm" class="name">var <span class="ident">y_norm</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NumericalDistribution.class_to_string">
    <p>def <span class="ident">class_to_string</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a string name for a given ProbabilityDistribution subclass.</p>
<p>This converts camel case to underscore and removes the word
'distribution'.</p>
<p>Example: class_to_string(AsymmetricNormalDistribution) returns
'asymmetric_normal'.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NumericalDistribution.class_to_string', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NumericalDistribution.class_to_string" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>
<span class="sd">    This converts camel case to underscore and removes the word</span>
<span class="sd">    &#39;distribution&#39;.</span>
<span class="sd">    Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">    &#39;asymmetric_normal&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NumericalDistribution.from_pd">
    <p>def <span class="ident">from_pd</span>(</p><p>cls, pd, nsteps=1000)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NumericalDistribution.from_pd', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NumericalDistribution.from_pd" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_pd</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pd</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pd</span><span class="p">,</span> <span class="n">NumericalDistribution</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pd</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">support</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">nsteps</span><span class="p">)</span>
    <span class="n">_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">_x</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">central_value</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">_y</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.NumericalDistribution.get_subclasses">
    <p>def <span class="ident">get_subclasses</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Return all subclasses (including subclasses of subclasses).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.NumericalDistribution.get_subclasses', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.NumericalDistribution.get_subclasses" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">subclass</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="flavio.statistics.probability.ProbabilityDistribution" class="name">class <span class="ident">ProbabilityDistribution</span></p>
      
  
    <div class="desc"><p>Common base class for all probability distributions</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.ProbabilityDistribution', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.ProbabilityDistribution" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ProbabilityDistribution</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Common base class for all probability distributions&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">support</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">=</span> <span class="n">central_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">support</span> <span class="o">=</span> <span class="n">support</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
            <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
            <span class="k">yield</span> <span class="n">subclass</span>

    <span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_error_left</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_error_right</span><span class="p">()</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>

<span class="sd">        This converts camel case to underscore and removes the word</span>
<span class="sd">        &#39;distribution&#39;.</span>

<span class="sd">        Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">        &#39;asymmetric_normal&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">        the instantiate the distribution.</span>

<span class="sd">        Optional arguments (default to False):</span>

<span class="sd">        - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">        value being the string representation of the distribution&#39;s name</span>
<span class="sd">        (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">        - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">        arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">        get_dict instead of the instance as value.</span>
<span class="sd">        - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
        <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
            <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
        <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">od</span>

    <span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">        get_dict method.</span>

<span class="sd">        Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
        <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
            <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.ProbabilityDistribution.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, central_value, support)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.ProbabilityDistribution.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.ProbabilityDistribution.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">support</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span> <span class="o">=</span> <span class="n">central_value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">support</span> <span class="o">=</span> <span class="n">support</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.ProbabilityDistribution.delta_logpdf">
    <p>def <span class="ident">delta_logpdf</span>(</p><p>self, x, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.ProbabilityDistribution.delta_logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.ProbabilityDistribution.delta_logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.ProbabilityDistribution.get_central">
    <p>def <span class="ident">get_central</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.ProbabilityDistribution.get_central', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.ProbabilityDistribution.get_central" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.ProbabilityDistribution.get_dict">
    <p>def <span class="ident">get_dict</span>(</p><p>self, distribution=False, iterate=False, arraytolist=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get an ordered dictionary with arguments and values needed to
the instantiate the distribution.</p>
<p>Optional arguments (default to False):</p>
<ul>
<li><code>distribution</code>: add a 'distribution' key to the dictionary with the
value being the string representation of the distribution's name
(e.g. 'asymmetric_normal').</li>
<li><code>iterate</code>: If ProbabilityDistribution instances are among the
arguments (e.g. for KernelDensityEstimate), return the instance's
get_dict instead of the instance as value.</li>
<li><code>arraytolist</code>: convert numpy arrays to lists</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.ProbabilityDistribution.get_dict', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.ProbabilityDistribution.get_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">    the instantiate the distribution.</span>
<span class="sd">    Optional arguments (default to False):</span>
<span class="sd">    - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">    value being the string representation of the distribution&#39;s name</span>
<span class="sd">    (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">    - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">    arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">    get_dict instead of the instance as value.</span>
<span class="sd">    - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
    <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
        <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
    <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">od</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.ProbabilityDistribution.get_yaml">
    <p>def <span class="ident">get_yaml</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a YAML string representing the dictionary returned by the
get_dict method.</p>
<p>Arguments will be passed to <code>yaml.dump</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.ProbabilityDistribution.get_yaml', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.ProbabilityDistribution.get_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">    get_dict method.</span>
<span class="sd">    Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
    <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.statistics.probability.ProbabilityDistribution.central_value" class="name">var <span class="ident">central_value</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.ProbabilityDistribution.error_left" class="name">var <span class="ident">error_left</span></p>
            

            
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.ProbabilityDistribution.error_right" class="name">var <span class="ident">error_right</span></p>
            

            
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.ProbabilityDistribution.support" class="name">var <span class="ident">support</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.ProbabilityDistribution.class_to_string">
    <p>def <span class="ident">class_to_string</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a string name for a given ProbabilityDistribution subclass.</p>
<p>This converts camel case to underscore and removes the word
'distribution'.</p>
<p>Example: class_to_string(AsymmetricNormalDistribution) returns
'asymmetric_normal'.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.ProbabilityDistribution.class_to_string', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.ProbabilityDistribution.class_to_string" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>
<span class="sd">    This converts camel case to underscore and removes the word</span>
<span class="sd">    &#39;distribution&#39;.</span>
<span class="sd">    Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">    &#39;asymmetric_normal&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.ProbabilityDistribution.get_subclasses">
    <p>def <span class="ident">get_subclasses</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Return all subclasses (including subclasses of subclasses).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.ProbabilityDistribution.get_subclasses', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.ProbabilityDistribution.get_subclasses" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">subclass</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="flavio.statistics.probability.UniformDistribution" class="name">class <span class="ident">UniformDistribution</span></p>
      
  
    <div class="desc"><p>Distribution with constant PDF in a range and zero otherwise.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.UniformDistribution', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.UniformDistribution" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">UniformDistribution</span><span class="p">(</span><span class="n">ProbabilityDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Distribution with constant PDF in a range and zero otherwise.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">half_range</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        - central_value: arithmetic mean of the upper and lower range boundaries</span>
<span class="sd">        - half_range: half the difference of upper and lower range boundaries</span>

<span class="sd">        Example:</span>

<span class="sd">        central_value = 5 and half_range = 3 leads to the range [2, 8].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">half_range</span> <span class="o">=</span> <span class="n">half_range</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">range</span> <span class="o">=</span> <span class="p">(</span><span class="n">central_value</span> <span class="o">-</span> <span class="n">half_range</span><span class="p">,</span>
                      <span class="n">central_value</span> <span class="o">+</span> <span class="n">half_range</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;flavio.statistics.probability.UniformDistribution&#39;</span> <span class="o">+</span> \
               <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_range</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_range</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">_lpvect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_lpvect</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_range</span>

    <span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_range</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.statistics.probability.UniformDistribution">UniformDistribution</a></li>
          <li><a href="#flavio.statistics.probability.ProbabilityDistribution">ProbabilityDistribution</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.UniformDistribution.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, central_value, half_range)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize the distribution.</p>
<p>Parameters:</p>
<ul>
<li>central_value: arithmetic mean of the upper and lower range boundaries</li>
<li>half_range: half the difference of upper and lower range boundaries</li>
</ul>
<p>Example:</p>
<p>central_value = 5 and half_range = 3 leads to the range [2, 8].</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.UniformDistribution.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.UniformDistribution.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_value</span><span class="p">,</span> <span class="n">half_range</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize the distribution.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - central_value: arithmetic mean of the upper and lower range boundaries</span>
<span class="sd">    - half_range: half the difference of upper and lower range boundaries</span>
<span class="sd">    Example:</span>
<span class="sd">    central_value = 5 and half_range = 3 leads to the range [2, 8].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">half_range</span> <span class="o">=</span> <span class="n">half_range</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">range</span> <span class="o">=</span> <span class="p">(</span><span class="n">central_value</span> <span class="o">-</span> <span class="n">half_range</span><span class="p">,</span>
                  <span class="n">central_value</span> <span class="o">+</span> <span class="n">half_range</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">central_value</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.UniformDistribution.delta_logpdf">
    <p>def <span class="ident">delta_logpdf</span>(</p><p>self, x, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.UniformDistribution.delta_logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.UniformDistribution.delta_logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delta_logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">central_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">logpdf</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.UniformDistribution.get_central">
    <p>def <span class="ident">get_central</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.UniformDistribution.get_central', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.UniformDistribution.get_central" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_central</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">central_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.UniformDistribution.get_dict">
    <p>def <span class="ident">get_dict</span>(</p><p>self, distribution=False, iterate=False, arraytolist=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get an ordered dictionary with arguments and values needed to
the instantiate the distribution.</p>
<p>Optional arguments (default to False):</p>
<ul>
<li><code>distribution</code>: add a 'distribution' key to the dictionary with the
value being the string representation of the distribution's name
(e.g. 'asymmetric_normal').</li>
<li><code>iterate</code>: If ProbabilityDistribution instances are among the
arguments (e.g. for KernelDensityEstimate), return the instance's
get_dict instead of the instance as value.</li>
<li><code>arraytolist</code>: convert numpy arrays to lists</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.UniformDistribution.get_dict', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.UniformDistribution.get_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get an ordered dictionary with arguments and values needed to</span>
<span class="sd">    the instantiate the distribution.</span>
<span class="sd">    Optional arguments (default to False):</span>
<span class="sd">    - `distribution`: add a &#39;distribution&#39; key to the dictionary with the</span>
<span class="sd">    value being the string representation of the distribution&#39;s name</span>
<span class="sd">    (e.g. &#39;asymmetric_normal&#39;).</span>
<span class="sd">    - `iterate`: If ProbabilityDistribution instances are among the</span>
<span class="sd">    arguments (e.g. for KernelDensityEstimate), return the instance&#39;s</span>
<span class="sd">    get_dict instead of the instance as value.</span>
<span class="sd">    - `arraytolist`: convert numpy arrays to lists</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
    <span class="n">od</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distribution</span><span class="p">:</span>
        <span class="n">od</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_string</span><span class="p">()</span>
    <span class="n">od</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ProbabilityDistribution</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arraytolist</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                        <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">od</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
            <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
                    <span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">od</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">od</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.UniformDistribution.get_error_left">
    <p>def <span class="ident">get_error_left</span>(</p><p>self, nsigma=1, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.UniformDistribution.get_error_left', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.UniformDistribution.get_error_left" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the lower error&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_range</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.UniformDistribution.get_error_right">
    <p>def <span class="ident">get_error_right</span>(</p><p>self, nsigma=1, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.UniformDistribution.get_error_right', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.UniformDistribution.get_error_right" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_error_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the upper error&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">confidence_level</span><span class="p">(</span><span class="n">nsigma</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_range</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.UniformDistribution.get_random">
    <p>def <span class="ident">get_random</span>(</p><p>self, size=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.UniformDistribution.get_random', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.UniformDistribution.get_random" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.UniformDistribution.get_yaml">
    <p>def <span class="ident">get_yaml</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a YAML string representing the dictionary returned by the
get_dict method.</p>
<p>Arguments will be passed to <code>yaml.dump</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.UniformDistribution.get_yaml', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.UniformDistribution.get_yaml" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a YAML string representing the dictionary returned by the</span>
<span class="sd">    get_dict method.</span>
<span class="sd">    Arguments will be passed to `yaml.dump`.&quot;&quot;&quot;</span>
    <span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">arraytolist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">od</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.UniformDistribution.logpdf">
    <p>def <span class="ident">logpdf</span>(</p><p>self, x)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.UniformDistribution.logpdf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.UniformDistribution.logpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">logpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">_lpvect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logpdf</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_lpvect</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.statistics.probability.UniformDistribution.error_left" class="name">var <span class="ident">error_left</span></p>
            

            
  
    <div class="desc"><p>Return the lower error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.UniformDistribution.error_right" class="name">var <span class="ident">error_right</span></p>
            

            
  
    <div class="desc"><p>Return the upper error</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.UniformDistribution.half_range" class="name">var <span class="ident">half_range</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.statistics.probability.UniformDistribution.range" class="name">var <span class="ident">range</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.UniformDistribution.class_to_string">
    <p>def <span class="ident">class_to_string</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a string name for a given ProbabilityDistribution subclass.</p>
<p>This converts camel case to underscore and removes the word
'distribution'.</p>
<p>Example: class_to_string(AsymmetricNormalDistribution) returns
'asymmetric_normal'.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.UniformDistribution.class_to_string', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.UniformDistribution.class_to_string" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a string name for a given ProbabilityDistribution subclass.</span>
<span class="sd">    This converts camel case to underscore and removes the word</span>
<span class="sd">    &#39;distribution&#39;.</span>
<span class="sd">    Example: class_to_string(AsymmetricNormalDistribution) returns</span>
<span class="sd">    &#39;asymmetric_normal&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_camel_to_underscore</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.statistics.probability.UniformDistribution.get_subclasses">
    <p>def <span class="ident">get_subclasses</span>(</p><p>cls)</p>
    </div>
    

    
  
    <div class="desc"><p>Return all subclasses (including subclasses of subclasses).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.statistics.probability.UniformDistribution.get_subclasses', this);">Show source &equiv;</a></p>
  <div id="source-flavio.statistics.probability.UniformDistribution.get_subclasses" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_subclasses</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return all subclasses (including subclasses of subclasses).&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">subclass</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">subclass</span><span class="o">.</span><span class="n">get_subclasses</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">subclass</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>

    <script>
      renderMathInElement(document.body, options={delimiters:[
  {left: "$$", right: "$$", display: true},
  {left: "\\[", right: "\\]", display: true},
  {left: "\\(", right: "\\)", display: false},
  {left: "$", right: "$", display: false}
]});
    </script>
    <script type="text/javascript">
    $("script[type='math/tex; mode=display']").replaceWith(
      function(){
        var tex = $(this).text();
        return "<span class=\"katex-display\">" +
               katex.renderToString("\\displaystyle "+tex) +
               "</span>";
    });
    </script>

</body>
</html>
