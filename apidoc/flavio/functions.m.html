<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>flavio.functions API documentation</title>
    <meta name="description" content="Main functions for user interaction. All of these are imported into the
top-level namespace." />

  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Noto+Sans:400' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/public/plugins/katex/katex.min.css">
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

    .katex {
      font-size:1em;
    }
    .katex .mathit, .katex .mathrm {
      font-family: 'Noto Sans';
    }
  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Noto Sans", "Helvetica Neue", Helvetica, sans;
    font-weight: 400;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  }

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; }

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;

      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  pre { line-height: 125%; margin: 0; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
.codehilite .hll { background-color: #ffffcc }
.codehilite { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
    <script src="/public/plugins/katex/katex.min.js"></script>
    <script src="/public/plugins/katex/auto-render.min.js"></script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>
      
  <ul>
    <li class="mono"><a href="#flavio.functions.combine_measurements">combine_measurements</a></li>
    <li class="mono"><a href="#flavio.functions.get_dependent_parameters_sm">get_dependent_parameters_sm</a></li>
    <li class="mono"><a href="#flavio.functions.get_dependent_wcs">get_dependent_wcs</a></li>
    <li class="mono"><a href="#flavio.functions.np_prediction">np_prediction</a></li>
    <li class="mono"><a href="#flavio.functions.np_uncertainty">np_uncertainty</a></li>
    <li class="mono"><a href="#flavio.functions.sm_covariance">sm_covariance</a></li>
    <li class="mono"><a href="#flavio.functions.sm_error_budget">sm_error_budget</a></li>
    <li class="mono"><a href="#flavio.functions.sm_prediction">sm_prediction</a></li>
    <li class="mono"><a href="#flavio.functions.sm_uncertainty">sm_uncertainty</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#flavio.functions.AwareDict">AwareDict</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.functions.AwareDict.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.functions.AwareDict.copy">copy</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#flavio.functions.AwareWilson">AwareWilson</a></span>
        
          
  <ul>
    <li class="mono"><a href="#flavio.functions.AwareWilson.__init__">__init__</a></li>
    <li class="mono"><a href="#flavio.functions.AwareWilson.clear_cache">clear_cache</a></li>
    <li class="mono"><a href="#flavio.functions.AwareWilson.get_option">get_option</a></li>
    <li class="mono"><a href="#flavio.functions.AwareWilson.get_wc">get_wc</a></li>
    <li class="mono"><a href="#flavio.functions.AwareWilson.get_wcxf">get_wcxf</a></li>
    <li class="mono"><a href="#flavio.functions.AwareWilson.match_run">match_run</a></li>
    <li class="mono"><a href="#flavio.functions.AwareWilson.run_wcxf">run_wcxf</a></li>
    <li class="mono"><a href="#flavio.functions.AwareWilson.set_initial">set_initial</a></li>
    <li class="mono"><a href="#flavio.functions.AwareWilson.set_initial_wcxf">set_initial_wcxf</a></li>
    <li class="mono"><a href="#flavio.functions.AwareWilson.set_option">set_option</a></li>
    <li class="mono"><a href="#flavio.functions.AwareWilson.from_wc">from_wc</a></li>
    <li class="mono"><a href="#flavio.functions.AwareWilson.from_wilson">from_wilson</a></li>
    <li class="mono"><a href="#flavio.functions.AwareWilson.load_wc">load_wc</a></li>
    <li class="mono"><a href="#flavio.functions.AwareWilson.set_default_option">set_default_option</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">flavio.functions</span> module</h1>
  <p>Main functions for user interaction. All of these are imported into the
top-level namespace.</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions" class="source">
    <div class="codehilite"><pre><span></span><span class="sd">&quot;&quot;&quot;Main functions for user interaction. All of these are imported into the</span>
<span class="sd">top-level namespace.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">flavio</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Pool</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">warnings</span>


<span class="k">def</span> <span class="nf">np_prediction</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="n">wc_obj</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the central value of the new physics prediction of an observable.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    - `obs_name`: name of the observable as a string</span>
<span class="sd">    - `wc_obj`: an instance of `flavio.WilsonCoefficients`</span>

<span class="sd">    Additional arguments are passed to the observable and are necessary,</span>
<span class="sd">    depending on the observable (e.g. $q^2$-dependent observables).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">Observable</span><span class="p">[</span><span class="n">obs_name</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">obs</span><span class="o">.</span><span class="n">prediction_central</span><span class="p">(</span><span class="n">flavio</span><span class="o">.</span><span class="n">default_parameters</span><span class="p">,</span> <span class="n">wc_obj</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">sm_prediction</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the central value of the Standard Model prediction of an observable.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    - `obs_name`: name of the observable as a string</span>

<span class="sd">    Additional arguments are passed to the observable and are necessary,</span>
<span class="sd">    depending on the observable (e.g. $q^2$-dependent observables).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">Observable</span><span class="p">[</span><span class="n">obs_name</span><span class="p">]</span>
    <span class="n">wc_sm</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">eft</span><span class="o">.</span><span class="n">_wc_sm</span>
    <span class="k">return</span> <span class="n">obs</span><span class="o">.</span><span class="n">prediction_central</span><span class="p">(</span><span class="n">flavio</span><span class="o">.</span><span class="n">default_parameters</span><span class="p">,</span> <span class="n">wc_sm</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_obs_prediction_par</span><span class="p">(</span><span class="n">par</span><span class="p">,</span> <span class="n">obs_name</span><span class="p">,</span> <span class="n">wc_obj</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">Observable</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">obs_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">obs</span><span class="o">.</span><span class="n">prediction_par</span><span class="p">(</span><span class="n">par</span><span class="p">,</span> <span class="n">wc_obj</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="k">def</span> <span class="nf">np_uncertainty</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="n">wc_obj</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the uncertainty of the prediction of an observable in the presence</span>
<span class="sd">    of new physics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    - `obs_name`: name of the observable as a string</span>
<span class="sd">    - `wc_obj`: an instance of `flavio.WilsonCoefficients`</span>
<span class="sd">    - `N` (optional): number of random evaluations of the observable.</span>
<span class="sd">    The relative accuracy of the uncertainty returned is given by $1/\sqrt{2N}$.</span>
<span class="sd">    - `threads` (optional): if bigger than one, number of threads for parallel</span>
<span class="sd">    computation of the uncertainty.</span>

<span class="sd">    Additional arguments are passed to the observable and are necessary,</span>
<span class="sd">    depending on the observable (e.g. $q^2$-dependent observables).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">par_random</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">default_parameters</span><span class="o">.</span><span class="n">get_random_all</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
    <span class="n">par_random</span> <span class="o">=</span> <span class="p">[{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">par_random</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">threads</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># not parallel</span>
        <span class="n">all_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">_obs_prediction_par</span><span class="p">(</span><span class="n">par</span><span class="p">,</span> <span class="n">obs_name</span><span class="p">,</span> <span class="n">wc_obj</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">par_random</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># parallel</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="n">threads</span><span class="p">)</span>
        <span class="c1"># convert args to kwargs</span>
        <span class="n">_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">obs_args</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">Observable</span><span class="p">[</span><span class="n">obs_name</span><span class="p">]</span><span class="o">.</span><span class="n">arguments</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
            <span class="n">_kwargs</span><span class="p">[</span><span class="n">obs_args</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">a</span>
        <span class="n">all_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                        <span class="n">partial</span><span class="p">(</span><span class="n">_obs_prediction_par</span><span class="p">,</span>
                        <span class="n">obs_name</span><span class="o">=</span><span class="n">obs_name</span><span class="p">,</span> <span class="n">wc_obj</span><span class="o">=</span><span class="n">wc_obj</span><span class="p">,</span> <span class="o">**</span><span class="n">_kwargs</span><span class="p">),</span>
                        <span class="n">par_random</span><span class="p">))</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">all_pred</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">sm_uncertainty</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the uncertainty of the Standard Model prediction of an observable.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    - `obs_name`: name of the observable as a string</span>
<span class="sd">    - `N` (optional): number of random evaluations of the observable.</span>
<span class="sd">    The relative accuracy of the uncertainty returned is given by $1/\sqrt{2N}$.</span>
<span class="sd">    - `threads` (optional): if bigger than one, number of threads for parallel</span>
<span class="sd">    computation of the uncertainty.</span>

<span class="sd">    Additional arguments are passed to the observable and are necessary,</span>
<span class="sd">    depending on the observable (e.g. $q^2$-dependent observables).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wc_sm</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">eft</span><span class="o">.</span><span class="n">_wc_sm</span>
    <span class="k">return</span> <span class="n">np_uncertainty</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="n">wc_sm</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="n">threads</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">AwareDict</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generalization of dictionary that adds the key to the</span>
<span class="sd">    set `akeys` upon getting an item.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the instance.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">akeys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="n">d</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get an item, adding the key to the `pcalled` set.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">akeys</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cp</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
        <span class="n">cp</span><span class="o">.</span><span class="n">akeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">akeys</span>
        <span class="k">return</span> <span class="n">cp</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">AwareWilson</span><span class="p">(</span><span class="n">flavio</span><span class="o">.</span><span class="n">WilsonCoefficients</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Subclass of `flavio.WilsonCoefficients` that adds the arguments of calls</span>
<span class="sd">    to its `match_run`  method to `atuples` attribute.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atuples</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">match_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">eft</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">sectors</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atuples</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">scale</span><span class="p">,</span> <span class="n">eft</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">sectors</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">match_run</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">eft</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">sectors</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_dependent_parameters_sm</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the set of parameters the SM prediction of the observable depends on.&quot;&quot;&quot;</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">Observable</span><span class="p">[</span><span class="n">obs_name</span><span class="p">]</span>
    <span class="n">wc_sm</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">eft</span><span class="o">.</span><span class="n">_wc_sm</span>
    <span class="n">par_central</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">default_parameters</span><span class="o">.</span><span class="n">get_central_all</span><span class="p">()</span>
    <span class="n">apar_central</span> <span class="o">=</span> <span class="n">AwareDict</span><span class="p">(</span><span class="n">par_central</span><span class="p">)</span>
    <span class="n">obs</span><span class="o">.</span><span class="n">prediction_par</span><span class="p">(</span><span class="n">apar_central</span><span class="p">,</span> <span class="n">wc_sm</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># return all observed keys except the ones that don&#39;t actually correspond</span>
    <span class="c1"># to existing parameter names (this might happen by user functions modifying</span>
    <span class="c1"># the dictionaries)</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">apar_central</span><span class="o">.</span><span class="n">akeys</span>
            <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">flavio</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">instances</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>


<span class="k">def</span> <span class="nf">get_dependent_wcs</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the EFT, basis, scale, and sector of Wilson coefficients</span>
<span class="sd">    the NP prediction of the observable depends on.</span>

<span class="sd">    Returns a set of tuples of the form</span>
<span class="sd">    `(scale, eft, basis, sectors)`,</span>
<span class="sd">    where sectors is a tuple of WCxf sectors or &#39;all&#39;.</span>

<span class="sd">    Note that this function simply checks the arguments with which the</span>
<span class="sd">    `match_run` method of the underlying `wilson.Wilson` instance is called.</span>
<span class="sd">    Thus it is only guaranteed that the Wilson coefficients the observable</span>
<span class="sd">    actually depends on are contained in these sectors.&quot;&quot;&quot;</span>
    <span class="n">awc</span> <span class="o">=</span> <span class="n">AwareWilson</span><span class="p">()</span>
    <span class="c1"># need at least one non-zero WC to make sure match_run is called at all</span>
    <span class="n">awc</span><span class="o">.</span><span class="n">set_initial</span><span class="p">({</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mf">1e-30</span><span class="p">},</span> <span class="mf">91.1876</span><span class="p">,</span> <span class="s1">&#39;SMEFT&#39;</span><span class="p">,</span> <span class="s1">&#39;Warsaw&#39;</span><span class="p">)</span>
    <span class="n">np_prediction</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="n">awc</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">awc</span><span class="o">.</span><span class="n">atuples</span>


<span class="k">def</span> <span class="nf">sm_error_budget</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the *relative* uncertainty of the Standard Model prediction due to</span>
<span class="sd">    variation of individual observables.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    - `obs_name`: name of the observable as a string</span>
<span class="sd">    - `N` (optional): number of random evaluations of the observable.</span>
<span class="sd">    The relative accuracy of the uncertainties returned is given by $1/\sqrt{2N}$.</span>

<span class="sd">    Additional arguments are passed to the observable and are necessary,</span>
<span class="sd">    depending on the observable (e.g. $q^2$-dependent observables).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">Observable</span><span class="p">[</span><span class="n">obs_name</span><span class="p">]</span>
    <span class="n">wc_sm</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">eft</span><span class="o">.</span><span class="n">_wc_sm</span>
    <span class="n">par_central</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">default_parameters</span><span class="o">.</span><span class="n">get_central_all</span><span class="p">()</span>
    <span class="n">par_random</span> <span class="o">=</span> <span class="p">[</span><span class="n">flavio</span><span class="o">.</span><span class="n">default_parameters</span><span class="o">.</span><span class="n">get_random_all</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">pred_central</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">prediction_par</span><span class="p">(</span><span class="n">par_central</span><span class="p">,</span> <span class="n">wc_sm</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Step 1: determine the parameters the observable depends on at all.</span>
    <span class="n">dependent_par</span> <span class="o">=</span> <span class="n">get_dependent_parameters_sm</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Step 2: group parameters if correlated</span>
    <span class="n">par_constraint</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="p">:</span> <span class="nb">id</span><span class="p">(</span><span class="n">flavio</span><span class="o">.</span><span class="n">default_parameters</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">dependent_par</span><span class="p">}</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">par_constraint</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">v</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">dependent_par_lists</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="c1"># Step 3: for each of the (groups of) dependent parameters, determine the error</span>
    <span class="c1"># analogous to the sm_uncertainty function. Normalize to the central</span>
    <span class="c1"># prediction (so relative errors are returned)</span>
    <span class="n">individual_errors</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">def</span> <span class="nf">make_par_random</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">par_random</span><span class="p">):</span>
        <span class="n">par_tmp</span> <span class="o">=</span> <span class="n">par_central</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">par_tmp</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">par_random</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">par_tmp</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">dependent_par_lists</span><span class="p">:</span>
        <span class="n">par_random_p</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_par_random</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">pr</span><span class="p">)</span> <span class="k">for</span> <span class="n">pr</span> <span class="ow">in</span> <span class="n">par_random</span><span class="p">]</span>
        <span class="n">all_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="n">obs</span><span class="o">.</span><span class="n">prediction_par</span><span class="p">(</span><span class="n">par</span><span class="p">,</span> <span class="n">wc_sm</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">par_random_p</span>
        <span class="p">])</span>
        <span class="c1"># for the dictionary key, use the list element if there is only 1,</span>
        <span class="c1"># otherwise use a tuple (which is hashable)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">individual_errors</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">all_pred</span><span class="p">)</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">pred_central</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">individual_errors</span>


<span class="k">def</span> <span class="nf">_get_prediction_array_sm</span><span class="p">(</span><span class="n">par</span><span class="p">,</span> <span class="n">obs_list</span><span class="p">):</span>
    <span class="n">wc_sm</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">eft</span><span class="o">.</span><span class="n">_wc_sm</span>
    <span class="k">def</span> <span class="nf">get_prediction_sm</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">par</span><span class="p">):</span>
        <span class="n">obs_dict</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">Observable</span><span class="o">.</span><span class="n">argument_format</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="s1">&#39;dict&#39;</span><span class="p">)</span>
        <span class="n">obs_obj</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">Observable</span><span class="p">[</span><span class="n">obs_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">obs_obj</span><span class="o">.</span><span class="n">prediction_par</span><span class="p">(</span><span class="n">par</span><span class="p">,</span> <span class="n">wc_sm</span><span class="p">,</span> <span class="o">**</span><span class="n">obs_dict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">get_prediction_sm</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">par</span><span class="p">)</span> <span class="k">for</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">obs_list</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">sm_covariance</span><span class="p">(</span><span class="n">obs_list</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">par_vary</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">par_obj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get the covariance matrix of the Standard Model predictions for a</span>
<span class="sd">    list of observables.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    - `obs_list`: a list of observables that should be given either as a string</span>
<span class="sd">    name (for observables that do not depend on any arguments) or as a tuple</span>
<span class="sd">    of a string and values for the arguements the observable depends on (e.g.</span>
<span class="sd">    the values of `q2min` and `q2max` for a binned observable)</span>
<span class="sd">    - `N` (optional): number of random evaluations of the observables.</span>
<span class="sd">    The relative accuracy of the uncertainties returned is given</span>
<span class="sd">    by $1/\sqrt{2N}$.</span>
<span class="sd">    - `par_vary` (optional): a list of parameters to vary. Defaults to &#39;all&#39;, i.e. all</span>
<span class="sd">    parameters are varied according to their probability distributions.</span>
<span class="sd">    - `par_obj` (optional): an instance of ParameterConstraints, defaults to</span>
<span class="sd">    flavio.default_parameters.</span>
<span class="sd">    - `threads` (optional): number of CPU threads to use for the computation.</span>
<span class="sd">    Defaults to 1, i.e. serial computation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">par_obj</span> <span class="o">=</span> <span class="n">par_obj</span> <span class="ow">or</span> <span class="n">flavio</span><span class="o">.</span><span class="n">default_parameters</span>
    <span class="n">par_central_all</span> <span class="o">=</span> <span class="n">par_obj</span><span class="o">.</span><span class="n">get_central_all</span><span class="p">()</span>
    <span class="n">par_random_all</span> <span class="o">=</span> <span class="n">par_obj</span><span class="o">.</span><span class="n">get_random_all</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">par_random_some</span><span class="p">(</span><span class="n">par_random</span><span class="p">,</span> <span class="n">par_central</span><span class="p">):</span>
        <span class="c1"># take the central values for the parameters not to be varied (N times)</span>
        <span class="n">par1</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">par_central</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">par_vary</span><span class="p">}</span>
        <span class="c1"># take the random values for the parameters to be varied</span>
        <span class="n">par2</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">par_random</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">par_vary</span><span class="p">}</span>
        <span class="n">par1</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">par2</span><span class="p">)</span>  <span class="c1"># merge them</span>
        <span class="k">return</span> <span class="n">par1</span>

    <span class="k">if</span> <span class="n">par_vary</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
        <span class="n">par_random</span> <span class="o">=</span> <span class="n">par_random_all</span>
        <span class="n">par_random</span> <span class="o">=</span> <span class="p">[{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">par_random</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">par_random</span> <span class="o">=</span> <span class="n">par_random_some</span><span class="p">(</span><span class="n">par_random_all</span><span class="p">,</span> <span class="n">par_central_all</span><span class="p">)</span>
        <span class="n">par_random</span> <span class="o">=</span> <span class="p">[{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">par_random</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

    <span class="n">func_map</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">_get_prediction_array_sm</span><span class="p">,</span> <span class="n">obs_list</span><span class="o">=</span><span class="n">obs_list</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">threads</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">pred_map</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">func_map</span><span class="p">,</span> <span class="n">par_random</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="n">threads</span><span class="p">)</span>
        <span class="n">pred_map</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">func_map</span><span class="p">,</span> <span class="n">par_random</span><span class="p">)</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="n">all_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">pred_map</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">all_pred</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">combine_measurements</span><span class="p">(</span><span class="n">observable</span><span class="p">,</span> <span class="n">include_measurements</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Combine all existing measurements of a particular observable.</span>

<span class="sd">    Returns a one-dimensional instance of `ProbabilityDistribution`.</span>
<span class="sd">    Correlations with other obersables are ignored.</span>

<span class="sd">    Parameters:</span>

<span class="sd">    - `observable`: observable name</span>
<span class="sd">    - `include_measurements`: iterable of measurement names to be included</span>
<span class="sd">      (default: all)</span>

<span class="sd">    Observable arguments have to be specified as keyword arguments, e.g.</span>
<span class="sd">    `combine_measurements(&#39;&lt;dBR/dq2&gt;(B+-&gt;Kmumu)&#39;, q2min=1, q2max=6)`.</span>

<span class="sd">    Note that this function returns inconsistent results (and a corresponding</span>
<span class="sd">    warning is issued) if an observable is constrained by more than one</span>
<span class="sd">    multivariate measurement.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="n">observable</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">Observable</span><span class="p">[</span><span class="n">observable</span><span class="p">]</span><span class="o">.</span><span class="n">arguments</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="p">(</span><span class="n">observable</span><span class="p">,</span> <span class="p">)</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">)</span>
    <span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">_n_multivariate</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># number of multivariate constraints</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">flavio</span><span class="o">.</span><span class="n">Measurement</span><span class="o">.</span><span class="n">instances</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Pseudo-measurement&#39;</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="n">include_measurements</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">include_measurements</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="n">obs</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">all_parameters</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">num</span><span class="p">,</span> <span class="n">constraint</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="n">obs</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">constraint</span><span class="o">.</span><span class="n">central_value</span><span class="p">):</span>
            <span class="n">_n_multivariate</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c1"># for multivariate PDFs, reduce to 1D PDF</span>
            <span class="n">exclude</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">constraint</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
                             <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">num</span><span class="p">])</span>  <span class="c1"># exclude all i but num</span>
            <span class="n">constraint1d</span> <span class="o">=</span> <span class="n">constraint</span><span class="o">.</span><span class="n">reduce_dimension</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">)</span>
            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constraint1d</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_n_multivariate</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">((</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> of the measurements of &#39;</span><span class="si">{}</span><span class="s2">&#39; are multivariate. &quot;</span>
                       <span class="s2">&quot;This can lead to inconsistent results as the other &quot;</span>
                       <span class="s2">&quot;observables are profiled over. &quot;</span>
                       <span class="s2">&quot;To be consistent, you should perform a multivariate &quot;</span>
                       <span class="s2">&quot;combination that is not yet supported by `combine_measurements`.&quot;</span>
                       <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_n_multivariate</span><span class="p">,</span> <span class="n">obs</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">constraints</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No experimental measurements found for this observable.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">constraints</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">constraints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">flavio</span><span class="o">.</span><span class="n">statistics</span><span class="o">.</span><span class="n">probability</span><span class="o">.</span><span class="n">combine_distributions</span><span class="p">(</span><span class="n">constraints</span><span class="p">)</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">

    <h2 class="section-title" id="header-functions">Functions</h2>
      
  <div class="item">
    <div class="name def" id="flavio.functions.combine_measurements">
    <p>def <span class="ident">combine_measurements</span>(</p><p>observable, include_measurements=None, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Combine all existing measurements of a particular observable.</p>
<p>Returns a one-dimensional instance of <code>ProbabilityDistribution</code>.
Correlations with other obersables are ignored.</p>
<p>Parameters:</p>
<ul>
<li><code>observable</code>: observable name</li>
<li><code>include_measurements</code>: iterable of measurement names to be included
  (default: all)</li>
</ul>
<p>Observable arguments have to be specified as keyword arguments, e.g.
<code>combine_measurements('&lt;dBR/dq2&gt;(B+-&gt;Kmumu)', q2min=1, q2max=6)</code>.</p>
<p>Note that this function returns inconsistent results (and a corresponding
warning is issued) if an observable is constrained by more than one
multivariate measurement.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.combine_measurements', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.combine_measurements" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">combine_measurements</span><span class="p">(</span><span class="n">observable</span><span class="p">,</span> <span class="n">include_measurements</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Combine all existing measurements of a particular observable.</span>

<span class="sd">    Returns a one-dimensional instance of `ProbabilityDistribution`.</span>
<span class="sd">    Correlations with other obersables are ignored.</span>

<span class="sd">    Parameters:</span>

<span class="sd">    - `observable`: observable name</span>
<span class="sd">    - `include_measurements`: iterable of measurement names to be included</span>
<span class="sd">      (default: all)</span>

<span class="sd">    Observable arguments have to be specified as keyword arguments, e.g.</span>
<span class="sd">    `combine_measurements(&#39;&lt;dBR/dq2&gt;(B+-&gt;Kmumu)&#39;, q2min=1, q2max=6)`.</span>

<span class="sd">    Note that this function returns inconsistent results (and a corresponding</span>
<span class="sd">    warning is issued) if an observable is constrained by more than one</span>
<span class="sd">    multivariate measurement.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="n">observable</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">Observable</span><span class="p">[</span><span class="n">observable</span><span class="p">]</span><span class="o">.</span><span class="n">arguments</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="p">(</span><span class="n">observable</span><span class="p">,</span> <span class="p">)</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">)</span>
    <span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">_n_multivariate</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># number of multivariate constraints</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">flavio</span><span class="o">.</span><span class="n">Measurement</span><span class="o">.</span><span class="n">instances</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Pseudo-measurement&#39;</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="n">include_measurements</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">include_measurements</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="n">obs</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">all_parameters</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">num</span><span class="p">,</span> <span class="n">constraint</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="n">obs</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">constraint</span><span class="o">.</span><span class="n">central_value</span><span class="p">):</span>
            <span class="n">_n_multivariate</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c1"># for multivariate PDFs, reduce to 1D PDF</span>
            <span class="n">exclude</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">constraint</span><span class="o">.</span><span class="n">central_value</span><span class="p">)</span>
                             <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">num</span><span class="p">])</span>  <span class="c1"># exclude all i but num</span>
            <span class="n">constraint1d</span> <span class="o">=</span> <span class="n">constraint</span><span class="o">.</span><span class="n">reduce_dimension</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">)</span>
            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constraint1d</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_n_multivariate</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">((</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> of the measurements of &#39;</span><span class="si">{}</span><span class="s2">&#39; are multivariate. &quot;</span>
                       <span class="s2">&quot;This can lead to inconsistent results as the other &quot;</span>
                       <span class="s2">&quot;observables are profiled over. &quot;</span>
                       <span class="s2">&quot;To be consistent, you should perform a multivariate &quot;</span>
                       <span class="s2">&quot;combination that is not yet supported by `combine_measurements`.&quot;</span>
                       <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_n_multivariate</span><span class="p">,</span> <span class="n">obs</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">constraints</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No experimental measurements found for this observable.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">constraints</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">constraints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">flavio</span><span class="o">.</span><span class="n">statistics</span><span class="o">.</span><span class="n">probability</span><span class="o">.</span><span class="n">combine_distributions</span><span class="p">(</span><span class="n">constraints</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="flavio.functions.get_dependent_parameters_sm">
    <p>def <span class="ident">get_dependent_parameters_sm</span>(</p><p>obs_name, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the set of parameters the SM prediction of the observable depends on.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.get_dependent_parameters_sm', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.get_dependent_parameters_sm" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dependent_parameters_sm</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the set of parameters the SM prediction of the observable depends on.&quot;&quot;&quot;</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">Observable</span><span class="p">[</span><span class="n">obs_name</span><span class="p">]</span>
    <span class="n">wc_sm</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">eft</span><span class="o">.</span><span class="n">_wc_sm</span>
    <span class="n">par_central</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">default_parameters</span><span class="o">.</span><span class="n">get_central_all</span><span class="p">()</span>
    <span class="n">apar_central</span> <span class="o">=</span> <span class="n">AwareDict</span><span class="p">(</span><span class="n">par_central</span><span class="p">)</span>
    <span class="n">obs</span><span class="o">.</span><span class="n">prediction_par</span><span class="p">(</span><span class="n">apar_central</span><span class="p">,</span> <span class="n">wc_sm</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># return all observed keys except the ones that don&#39;t actually correspond</span>
    <span class="c1"># to existing parameter names (this might happen by user functions modifying</span>
    <span class="c1"># the dictionaries)</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">apar_central</span><span class="o">.</span><span class="n">akeys</span>
            <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">flavio</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">instances</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="flavio.functions.get_dependent_wcs">
    <p>def <span class="ident">get_dependent_wcs</span>(</p><p>obs_name, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the EFT, basis, scale, and sector of Wilson coefficients
the NP prediction of the observable depends on.</p>
<p>Returns a set of tuples of the form
<code>(scale, eft, basis, sectors)</code>,
where sectors is a tuple of WCxf sectors or 'all'.</p>
<p>Note that this function simply checks the arguments with which the
<code>match_run</code> method of the underlying <code>wilson.Wilson</code> instance is called.
Thus it is only guaranteed that the Wilson coefficients the observable
actually depends on are contained in these sectors.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.get_dependent_wcs', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.get_dependent_wcs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dependent_wcs</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the EFT, basis, scale, and sector of Wilson coefficients</span>
<span class="sd">    the NP prediction of the observable depends on.</span>

<span class="sd">    Returns a set of tuples of the form</span>
<span class="sd">    `(scale, eft, basis, sectors)`,</span>
<span class="sd">    where sectors is a tuple of WCxf sectors or &#39;all&#39;.</span>

<span class="sd">    Note that this function simply checks the arguments with which the</span>
<span class="sd">    `match_run` method of the underlying `wilson.Wilson` instance is called.</span>
<span class="sd">    Thus it is only guaranteed that the Wilson coefficients the observable</span>
<span class="sd">    actually depends on are contained in these sectors.&quot;&quot;&quot;</span>
    <span class="n">awc</span> <span class="o">=</span> <span class="n">AwareWilson</span><span class="p">()</span>
    <span class="c1"># need at least one non-zero WC to make sure match_run is called at all</span>
    <span class="n">awc</span><span class="o">.</span><span class="n">set_initial</span><span class="p">({</span><span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mf">1e-30</span><span class="p">},</span> <span class="mf">91.1876</span><span class="p">,</span> <span class="s1">&#39;SMEFT&#39;</span><span class="p">,</span> <span class="s1">&#39;Warsaw&#39;</span><span class="p">)</span>
    <span class="n">np_prediction</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="n">awc</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">awc</span><span class="o">.</span><span class="n">atuples</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="flavio.functions.np_prediction">
    <p>def <span class="ident">np_prediction</span>(</p><p>obs_name, wc_obj, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the central value of the new physics prediction of an observable.</p>
<h2>Parameters</h2>
<ul>
<li><code>obs_name</code>: name of the observable as a string</li>
<li><code>wc_obj</code>: an instance of <code>flavio.WilsonCoefficients</code></li>
</ul>
<p>Additional arguments are passed to the observable and are necessary,
depending on the observable (e.g. $q^2$-dependent observables).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.np_prediction', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.np_prediction" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">np_prediction</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="n">wc_obj</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the central value of the new physics prediction of an observable.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    - `obs_name`: name of the observable as a string</span>
<span class="sd">    - `wc_obj`: an instance of `flavio.WilsonCoefficients`</span>

<span class="sd">    Additional arguments are passed to the observable and are necessary,</span>
<span class="sd">    depending on the observable (e.g. $q^2$-dependent observables).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">Observable</span><span class="p">[</span><span class="n">obs_name</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">obs</span><span class="o">.</span><span class="n">prediction_central</span><span class="p">(</span><span class="n">flavio</span><span class="o">.</span><span class="n">default_parameters</span><span class="p">,</span> <span class="n">wc_obj</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="flavio.functions.np_uncertainty">
    <p>def <span class="ident">np_uncertainty</span>(</p><p>obs_name, wc_obj, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the uncertainty of the prediction of an observable in the presence
of new physics.</p>
<h2>Parameters</h2>
<ul>
<li><code>obs_name</code>: name of the observable as a string</li>
<li><code>wc_obj</code>: an instance of <code>flavio.WilsonCoefficients</code></li>
<li><code>N</code> (optional): number of random evaluations of the observable.
The relative accuracy of the uncertainty returned is given by $1/\sqrt{2N}$.</li>
<li><code>threads</code> (optional): if bigger than one, number of threads for parallel
computation of the uncertainty.</li>
</ul>
<p>Additional arguments are passed to the observable and are necessary,
depending on the observable (e.g. $q^2$-dependent observables).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.np_uncertainty', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.np_uncertainty" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">np_uncertainty</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="n">wc_obj</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the uncertainty of the prediction of an observable in the presence</span>
<span class="sd">    of new physics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    - `obs_name`: name of the observable as a string</span>
<span class="sd">    - `wc_obj`: an instance of `flavio.WilsonCoefficients`</span>
<span class="sd">    - `N` (optional): number of random evaluations of the observable.</span>
<span class="sd">    The relative accuracy of the uncertainty returned is given by $1/\sqrt{2N}$.</span>
<span class="sd">    - `threads` (optional): if bigger than one, number of threads for parallel</span>
<span class="sd">    computation of the uncertainty.</span>

<span class="sd">    Additional arguments are passed to the observable and are necessary,</span>
<span class="sd">    depending on the observable (e.g. $q^2$-dependent observables).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">par_random</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">default_parameters</span><span class="o">.</span><span class="n">get_random_all</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
    <span class="n">par_random</span> <span class="o">=</span> <span class="p">[{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">par_random</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">threads</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># not parallel</span>
        <span class="n">all_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">_obs_prediction_par</span><span class="p">(</span><span class="n">par</span><span class="p">,</span> <span class="n">obs_name</span><span class="p">,</span> <span class="n">wc_obj</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">par_random</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># parallel</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="n">threads</span><span class="p">)</span>
        <span class="c1"># convert args to kwargs</span>
        <span class="n">_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">obs_args</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">Observable</span><span class="p">[</span><span class="n">obs_name</span><span class="p">]</span><span class="o">.</span><span class="n">arguments</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
            <span class="n">_kwargs</span><span class="p">[</span><span class="n">obs_args</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">a</span>
        <span class="n">all_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                        <span class="n">partial</span><span class="p">(</span><span class="n">_obs_prediction_par</span><span class="p">,</span>
                        <span class="n">obs_name</span><span class="o">=</span><span class="n">obs_name</span><span class="p">,</span> <span class="n">wc_obj</span><span class="o">=</span><span class="n">wc_obj</span><span class="p">,</span> <span class="o">**</span><span class="n">_kwargs</span><span class="p">),</span>
                        <span class="n">par_random</span><span class="p">))</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">all_pred</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="flavio.functions.sm_covariance">
    <p>def <span class="ident">sm_covariance</span>(</p><p>obs_list, N=100, par_vary=&#39;all&#39;, par_obj=None, threads=1, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the covariance matrix of the Standard Model predictions for a
list of observables.</p>
<h2>Parameters</h2>
<ul>
<li><code>obs_list</code>: a list of observables that should be given either as a string
name (for observables that do not depend on any arguments) or as a tuple
of a string and values for the arguements the observable depends on (e.g.
the values of <code>q2min</code> and <code>q2max</code> for a binned observable)</li>
<li><code>N</code> (optional): number of random evaluations of the observables.
The relative accuracy of the uncertainties returned is given
by $1/\sqrt{2N}$.</li>
<li><code>par_vary</code> (optional): a list of parameters to vary. Defaults to 'all', i.e. all
parameters are varied according to their probability distributions.</li>
<li><code>par_obj</code> (optional): an instance of ParameterConstraints, defaults to
flavio.default_parameters.</li>
<li><code>threads</code> (optional): number of CPU threads to use for the computation.
Defaults to 1, i.e. serial computation.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.sm_covariance', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.sm_covariance" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">sm_covariance</span><span class="p">(</span><span class="n">obs_list</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">par_vary</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">par_obj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get the covariance matrix of the Standard Model predictions for a</span>
<span class="sd">    list of observables.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    - `obs_list`: a list of observables that should be given either as a string</span>
<span class="sd">    name (for observables that do not depend on any arguments) or as a tuple</span>
<span class="sd">    of a string and values for the arguements the observable depends on (e.g.</span>
<span class="sd">    the values of `q2min` and `q2max` for a binned observable)</span>
<span class="sd">    - `N` (optional): number of random evaluations of the observables.</span>
<span class="sd">    The relative accuracy of the uncertainties returned is given</span>
<span class="sd">    by $1/\sqrt{2N}$.</span>
<span class="sd">    - `par_vary` (optional): a list of parameters to vary. Defaults to &#39;all&#39;, i.e. all</span>
<span class="sd">    parameters are varied according to their probability distributions.</span>
<span class="sd">    - `par_obj` (optional): an instance of ParameterConstraints, defaults to</span>
<span class="sd">    flavio.default_parameters.</span>
<span class="sd">    - `threads` (optional): number of CPU threads to use for the computation.</span>
<span class="sd">    Defaults to 1, i.e. serial computation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">par_obj</span> <span class="o">=</span> <span class="n">par_obj</span> <span class="ow">or</span> <span class="n">flavio</span><span class="o">.</span><span class="n">default_parameters</span>
    <span class="n">par_central_all</span> <span class="o">=</span> <span class="n">par_obj</span><span class="o">.</span><span class="n">get_central_all</span><span class="p">()</span>
    <span class="n">par_random_all</span> <span class="o">=</span> <span class="n">par_obj</span><span class="o">.</span><span class="n">get_random_all</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">par_random_some</span><span class="p">(</span><span class="n">par_random</span><span class="p">,</span> <span class="n">par_central</span><span class="p">):</span>
        <span class="c1"># take the central values for the parameters not to be varied (N times)</span>
        <span class="n">par1</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">par_central</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">par_vary</span><span class="p">}</span>
        <span class="c1"># take the random values for the parameters to be varied</span>
        <span class="n">par2</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">par_random</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">par_vary</span><span class="p">}</span>
        <span class="n">par1</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">par2</span><span class="p">)</span>  <span class="c1"># merge them</span>
        <span class="k">return</span> <span class="n">par1</span>

    <span class="k">if</span> <span class="n">par_vary</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
        <span class="n">par_random</span> <span class="o">=</span> <span class="n">par_random_all</span>
        <span class="n">par_random</span> <span class="o">=</span> <span class="p">[{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">par_random</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">par_random</span> <span class="o">=</span> <span class="n">par_random_some</span><span class="p">(</span><span class="n">par_random_all</span><span class="p">,</span> <span class="n">par_central_all</span><span class="p">)</span>
        <span class="n">par_random</span> <span class="o">=</span> <span class="p">[{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">par_random</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

    <span class="n">func_map</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">_get_prediction_array_sm</span><span class="p">,</span> <span class="n">obs_list</span><span class="o">=</span><span class="n">obs_list</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">threads</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">pred_map</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">func_map</span><span class="p">,</span> <span class="n">par_random</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="n">threads</span><span class="p">)</span>
        <span class="n">pred_map</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">func_map</span><span class="p">,</span> <span class="n">par_random</span><span class="p">)</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="n">all_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">pred_map</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">all_pred</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="flavio.functions.sm_error_budget">
    <p>def <span class="ident">sm_error_budget</span>(</p><p>obs_name, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the <em>relative</em> uncertainty of the Standard Model prediction due to
variation of individual observables.</p>
<h2>Parameters</h2>
<ul>
<li><code>obs_name</code>: name of the observable as a string</li>
<li><code>N</code> (optional): number of random evaluations of the observable.
The relative accuracy of the uncertainties returned is given by $1/\sqrt{2N}$.</li>
</ul>
<p>Additional arguments are passed to the observable and are necessary,
depending on the observable (e.g. $q^2$-dependent observables).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.sm_error_budget', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.sm_error_budget" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">sm_error_budget</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the *relative* uncertainty of the Standard Model prediction due to</span>
<span class="sd">    variation of individual observables.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    - `obs_name`: name of the observable as a string</span>
<span class="sd">    - `N` (optional): number of random evaluations of the observable.</span>
<span class="sd">    The relative accuracy of the uncertainties returned is given by $1/\sqrt{2N}$.</span>

<span class="sd">    Additional arguments are passed to the observable and are necessary,</span>
<span class="sd">    depending on the observable (e.g. $q^2$-dependent observables).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">Observable</span><span class="p">[</span><span class="n">obs_name</span><span class="p">]</span>
    <span class="n">wc_sm</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">eft</span><span class="o">.</span><span class="n">_wc_sm</span>
    <span class="n">par_central</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">default_parameters</span><span class="o">.</span><span class="n">get_central_all</span><span class="p">()</span>
    <span class="n">par_random</span> <span class="o">=</span> <span class="p">[</span><span class="n">flavio</span><span class="o">.</span><span class="n">default_parameters</span><span class="o">.</span><span class="n">get_random_all</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">pred_central</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">prediction_par</span><span class="p">(</span><span class="n">par_central</span><span class="p">,</span> <span class="n">wc_sm</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Step 1: determine the parameters the observable depends on at all.</span>
    <span class="n">dependent_par</span> <span class="o">=</span> <span class="n">get_dependent_parameters_sm</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Step 2: group parameters if correlated</span>
    <span class="n">par_constraint</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="p">:</span> <span class="nb">id</span><span class="p">(</span><span class="n">flavio</span><span class="o">.</span><span class="n">default_parameters</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">dependent_par</span><span class="p">}</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">par_constraint</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">v</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">dependent_par_lists</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="c1"># Step 3: for each of the (groups of) dependent parameters, determine the error</span>
    <span class="c1"># analogous to the sm_uncertainty function. Normalize to the central</span>
    <span class="c1"># prediction (so relative errors are returned)</span>
    <span class="n">individual_errors</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">def</span> <span class="nf">make_par_random</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">par_random</span><span class="p">):</span>
        <span class="n">par_tmp</span> <span class="o">=</span> <span class="n">par_central</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">par_tmp</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">par_random</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">par_tmp</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">dependent_par_lists</span><span class="p">:</span>
        <span class="n">par_random_p</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_par_random</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">pr</span><span class="p">)</span> <span class="k">for</span> <span class="n">pr</span> <span class="ow">in</span> <span class="n">par_random</span><span class="p">]</span>
        <span class="n">all_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="n">obs</span><span class="o">.</span><span class="n">prediction_par</span><span class="p">(</span><span class="n">par</span><span class="p">,</span> <span class="n">wc_sm</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">par_random_p</span>
        <span class="p">])</span>
        <span class="c1"># for the dictionary key, use the list element if there is only 1,</span>
        <span class="c1"># otherwise use a tuple (which is hashable)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">individual_errors</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">all_pred</span><span class="p">)</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">pred_central</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">individual_errors</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="flavio.functions.sm_prediction">
    <p>def <span class="ident">sm_prediction</span>(</p><p>obs_name, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the central value of the Standard Model prediction of an observable.</p>
<h2>Parameters</h2>
<ul>
<li><code>obs_name</code>: name of the observable as a string</li>
</ul>
<p>Additional arguments are passed to the observable and are necessary,
depending on the observable (e.g. $q^2$-dependent observables).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.sm_prediction', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.sm_prediction" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">sm_prediction</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the central value of the Standard Model prediction of an observable.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    - `obs_name`: name of the observable as a string</span>

<span class="sd">    Additional arguments are passed to the observable and are necessary,</span>
<span class="sd">    depending on the observable (e.g. $q^2$-dependent observables).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">Observable</span><span class="p">[</span><span class="n">obs_name</span><span class="p">]</span>
    <span class="n">wc_sm</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">eft</span><span class="o">.</span><span class="n">_wc_sm</span>
    <span class="k">return</span> <span class="n">obs</span><span class="o">.</span><span class="n">prediction_central</span><span class="p">(</span><span class="n">flavio</span><span class="o">.</span><span class="n">default_parameters</span><span class="p">,</span> <span class="n">wc_sm</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="flavio.functions.sm_uncertainty">
    <p>def <span class="ident">sm_uncertainty</span>(</p><p>obs_name, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the uncertainty of the Standard Model prediction of an observable.</p>
<h2>Parameters</h2>
<ul>
<li><code>obs_name</code>: name of the observable as a string</li>
<li><code>N</code> (optional): number of random evaluations of the observable.
The relative accuracy of the uncertainty returned is given by $1/\sqrt{2N}$.</li>
<li><code>threads</code> (optional): if bigger than one, number of threads for parallel
computation of the uncertainty.</li>
</ul>
<p>Additional arguments are passed to the observable and are necessary,
depending on the observable (e.g. $q^2$-dependent observables).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.sm_uncertainty', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.sm_uncertainty" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">sm_uncertainty</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the uncertainty of the Standard Model prediction of an observable.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    - `obs_name`: name of the observable as a string</span>
<span class="sd">    - `N` (optional): number of random evaluations of the observable.</span>
<span class="sd">    The relative accuracy of the uncertainty returned is given by $1/\sqrt{2N}$.</span>
<span class="sd">    - `threads` (optional): if bigger than one, number of threads for parallel</span>
<span class="sd">    computation of the uncertainty.</span>

<span class="sd">    Additional arguments are passed to the observable and are necessary,</span>
<span class="sd">    depending on the observable (e.g. $q^2$-dependent observables).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wc_sm</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">eft</span><span class="o">.</span><span class="n">_wc_sm</span>
    <span class="k">return</span> <span class="n">np_uncertainty</span><span class="p">(</span><span class="n">obs_name</span><span class="p">,</span> <span class="n">wc_sm</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="n">threads</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  

    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="flavio.functions.AwareDict" class="name">class <span class="ident">AwareDict</span></p>
      
  
    <div class="desc"><p>Generalization of dictionary that adds the key to the
set <code>akeys</code> upon getting an item.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.AwareDict', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.AwareDict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">AwareDict</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generalization of dictionary that adds the key to the</span>
<span class="sd">    set `akeys` upon getting an item.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the instance.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">akeys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="n">d</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get an item, adding the key to the `pcalled` set.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">akeys</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cp</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
        <span class="n">cp</span><span class="o">.</span><span class="n">akeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">akeys</span>
        <span class="k">return</span> <span class="n">cp</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.functions.AwareDict">AwareDict</a></li>
          <li>builtins.dict</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.functions.AwareDict.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, d)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.AwareDict.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.AwareDict.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize the instance.&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">akeys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="n">d</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.functions.AwareDict.copy">
    <p>def <span class="ident">copy</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>D.copy() -&gt; a shallow copy of D</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.AwareDict.copy', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.AwareDict.copy" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.functions.AwareDict.akeys" class="name">var <span class="ident">akeys</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.functions.AwareDict.d" class="name">var <span class="ident">d</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="flavio.functions.AwareWilson" class="name">class <span class="ident">AwareWilson</span></p>
      
  
    <div class="desc"><p>Subclass of <code>flavio.WilsonCoefficients</code> that adds the arguments of calls
to its <code>match_run</code>  method to <code>atuples</code> attribute.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.AwareWilson', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.AwareWilson" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">AwareWilson</span><span class="p">(</span><span class="n">flavio</span><span class="o">.</span><span class="n">WilsonCoefficients</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Subclass of `flavio.WilsonCoefficients` that adds the arguments of calls</span>
<span class="sd">    to its `match_run`  method to `atuples` attribute.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atuples</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">match_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">eft</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">sectors</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atuples</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">scale</span><span class="p">,</span> <span class="n">eft</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">sectors</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">match_run</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">eft</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">sectors</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#flavio.functions.AwareWilson">AwareWilson</a></li>
          <li>flavio.physics.eft.WilsonCoefficients</li>
          <li>wilson.classes.Wilson</li>
          <li>wilson.classes.ConfigurableClass</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.functions.AwareWilson.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize the <code>Wilson</code> class.</p>
<p>Parameters:</p>
<ul>
<li><code>wcdict</code>: dictionary of Wilson coefficient values at the input scale.
  The keys must exist as Wilson coefficients in the WCxf basis file.
  The values must be real or complex numbers (not dictionaries with key
  'Re'/'Im'!)</li>
<li><code>scale</code>: input scale in GeV</li>
<li><code>eft</code>: input EFT</li>
<li><code>basis</code>: input basis</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.AwareWilson.__init__', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.AwareWilson.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">atuples</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.functions.AwareWilson.clear_cache">
    <p>def <span class="ident">clear_cache</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.AwareWilson.clear_cache', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.AwareWilson.clear_cache" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">clear_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.functions.AwareWilson.get_option">
    <p>def <span class="ident">get_option</span>(</p><p>self, key)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the current value of the option <code>key</code> (string).</p>
<p>Instance method, only refers to current instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.AwareWilson.get_option', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.AwareWilson.get_option" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_option</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the current value of the option `key` (string).</span>
<span class="sd">    Instance method, only refers to current instance.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_options</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.functions.AwareWilson.get_wc">
    <p>def <span class="ident">get_wc</span>(</p><p>self, sector, scale, par, eft=&#39;WET&#39;, basis=&#39;flavio&#39;, nf_out=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the values of the Wilson coefficients belonging to a specific
sector (e.g. <code>bsmumu</code>) at a given scale.</p>
<p>Returns a dictionary of WC values.</p>
<p>Parameters:</p>
<ul>
<li>sector: string name of the sector as defined in the WCxf EFT instance</li>
<li>scale: $\overline{    ext{MS}}$ renormalization scale</li>
<li>par: dictionary of parameters</li>
<li>eft: name of the EFT at the output scale</li>
<li>basis: name of the output basis</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.AwareWilson.get_wc', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.AwareWilson.get_wc" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_wc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sector</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">par</span><span class="p">,</span> <span class="n">eft</span><span class="o">=</span><span class="s1">&#39;WET&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;flavio&#39;</span><span class="p">,</span> <span class="n">nf_out</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the values of the Wilson coefficients belonging to a specific</span>
<span class="sd">    sector (e.g. `bsmumu`) at a given scale.</span>
<span class="sd">    Returns a dictionary of WC values.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - sector: string name of the sector as defined in the WCxf EFT instance</span>
<span class="sd">    - scale: $\overline{\text{MS}}$ renormalization scale</span>
<span class="sd">    - par: dictionary of parameters</span>
<span class="sd">    - eft: name of the EFT at the output scale</span>
<span class="sd">    - basis: name of the output basis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wcxf_basis</span> <span class="o">=</span> <span class="n">wcxf</span><span class="o">.</span><span class="n">Basis</span><span class="p">[</span><span class="n">eft</span><span class="p">,</span> <span class="n">basis</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">sector</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="n">wcxf_basis</span><span class="o">.</span><span class="n">all_wcs</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># translate from legacy flavio to wcxf sector if necessary</span>
        <span class="n">wcxf_sector</span> <span class="o">=</span> <span class="n">sectors_flavio2wcxf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sector</span><span class="p">,</span> <span class="n">sector</span><span class="p">)</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="n">wcxf_basis</span><span class="o">.</span><span class="n">sectors</span><span class="p">[</span><span class="n">wcxf_sector</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">wc_sm</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">wc</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wc</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
        <span class="k">return</span> <span class="n">wc_sm</span>
    <span class="n">wc_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_wcxf</span><span class="p">(</span><span class="n">sector</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">par</span><span class="p">,</span> <span class="n">eft</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">nf_out</span><span class="p">)</span>
    <span class="n">wc_out_dict</span> <span class="o">=</span> <span class="n">wc_sm</span>  <span class="c1"># initialize with zeros</span>
    <span class="n">wc_out_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">wc_out</span><span class="o">.</span><span class="n">dict</span><span class="p">)</span>  <span class="c1"># overwrite non-zero entries</span>
    <span class="k">return</span> <span class="n">wc_out_dict</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.functions.AwareWilson.get_wcxf">
    <p>def <span class="ident">get_wcxf</span>(</p><p>self, sector, scale, par, eft=&#39;WET&#39;, basis=&#39;flavio&#39;, nf_out=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the values of the Wilson coefficients belonging to a specific
sector (e.g. <code>bsmumu</code>) at a given scale.</p>
<p>Returns a WCxf.WC instance.</p>
<p>Parameters:</p>
<ul>
<li>sector: string name of the sector as defined in the WCxf EFT instance</li>
<li>scale: $\overline{    ext{MS}}$ renormalization scale</li>
<li>par: dictionary of parameters</li>
<li>eft: name of the EFT at the output scale</li>
<li>basis: name of the output basis</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.AwareWilson.get_wcxf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.AwareWilson.get_wcxf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_wcxf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sector</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">par</span><span class="p">,</span> <span class="n">eft</span><span class="o">=</span><span class="s1">&#39;WET&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;flavio&#39;</span><span class="p">,</span> <span class="n">nf_out</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the values of the Wilson coefficients belonging to a specific</span>
<span class="sd">    sector (e.g. `bsmumu`) at a given scale.</span>
<span class="sd">    Returns a WCxf.WC instance.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - sector: string name of the sector as defined in the WCxf EFT instance</span>
<span class="sd">    - scale: $\overline{\text{MS}}$ renormalization scale</span>
<span class="sd">    - par: dictionary of parameters</span>
<span class="sd">    - eft: name of the EFT at the output scale</span>
<span class="sd">    - basis: name of the output basis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># nf_out is only present to preserve backwards compatibility</span>
    <span class="k">if</span> <span class="n">nf_out</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">eft</span> <span class="o">=</span> <span class="s1">&#39;WET&#39;</span>
    <span class="k">elif</span> <span class="n">nf_out</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">eft</span> <span class="o">=</span> <span class="s1">&#39;WET-4&#39;</span>
    <span class="k">elif</span> <span class="n">nf_out</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">eft</span> <span class="o">=</span> <span class="s1">&#39;WET-3&#39;</span>
    <span class="k">elif</span> <span class="n">nf_out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid value: nf_out=&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nf_out</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">sector</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
        <span class="n">mr_sectors</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># translate from legacy flavio to wcxf sector if necessary</span>
        <span class="n">wcxf_sector</span> <span class="o">=</span> <span class="n">sectors_flavio2wcxf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sector</span><span class="p">,</span> <span class="n">sector</span><span class="p">)</span>
        <span class="n">mr_sectors</span> <span class="o">=</span> <span class="p">(</span><span class="n">wcxf_sector</span><span class="p">,)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">wc</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">wcxf</span><span class="o">.</span><span class="n">WC</span><span class="p">(</span><span class="n">eft</span><span class="o">=</span><span class="n">eft</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">basis</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">{})</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_run</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">eft</span><span class="o">=</span><span class="n">eft</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">basis</span><span class="p">,</span> <span class="n">sectors</span><span class="o">=</span><span class="n">mr_sectors</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.functions.AwareWilson.match_run">
    <p>def <span class="ident">match_run</span>(</p><p>self, scale, eft, basis, sectors=&#39;all&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Run the Wilson coefficients to a different scale
(and possibly different EFT)
and return them as <code>wcxf.WC</code> instance.</p>
<p>Parameters:</p>
<ul>
<li><code>scale</code>: output scale in GeV</li>
<li><code>eft</code>: output EFT</li>
<li><code>basis</code>: output basis</li>
<li><code>sectors</code>: in the case of WET (or WET-4 or WET-3), a tuple of sector
  names can be optionally provided. In this case, only the Wilson coefficients
  from this sector(s) will be returned and all others discareded. This
  can speed up the computation significantly if only a small number of sectors
  is of interest. The sector names are defined in the WCxf basis file.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.AwareWilson.match_run', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.AwareWilson.match_run" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">match_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">eft</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">sectors</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">atuples</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">scale</span><span class="p">,</span> <span class="n">eft</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">sectors</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">match_run</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">eft</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">sectors</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.functions.AwareWilson.run_wcxf">
    <p>def <span class="ident">run_wcxf</span>(</p><p>*args, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.AwareWilson.run_wcxf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.AwareWilson.run_wcxf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">run_wcxf</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The method run_wcxf has been removed. Please use the match_run method of wilson.Wilson instead.&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.functions.AwareWilson.set_initial">
    <p>def <span class="ident">set_initial</span>(</p><p>self, wc_dict, scale, eft=&#39;WET&#39;, basis=&#39;flavio&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Set initial values of Wilson coefficients.</p>
<p>Parameters:</p>
<ul>
<li>wc_dict: dictionary where keys are Wilson coefficient name strings and
  values are Wilson coefficient NP contribution values</li>
<li>scale: $\overline{    ext{MS}}$ renormalization scale</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.AwareWilson.set_initial', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.AwareWilson.set_initial" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_initial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wc_dict</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">eft</span><span class="o">=</span><span class="s1">&#39;WET&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;flavio&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set initial values of Wilson coefficients.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - wc_dict: dictionary where keys are Wilson coefficient name strings and</span>
<span class="sd">      values are Wilson coefficient NP contribution values</span>
<span class="sd">    - scale: $\overline{\text{MS}}$ renormalization scale</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">wcdict</span><span class="o">=</span><span class="n">wc_dict</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">eft</span><span class="o">=</span><span class="n">eft</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">basis</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.functions.AwareWilson.set_initial_wcxf">
    <p>def <span class="ident">set_initial_wcxf</span>(</p><p>self, wc)</p>
    </div>
    

    
  
    <div class="desc"><p>Set initial values of Wilson coefficients from a WCxf WC instance.</p>
<p>If the instance is given in a basis other than the flavio basis,
the translation is performed automatically, if implemented in the
<code>wcxf</code> package.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.AwareWilson.set_initial_wcxf', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.AwareWilson.set_initial_wcxf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_initial_wcxf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set initial values of Wilson coefficients from a WCxf WC instance.</span>
<span class="sd">    If the instance is given in a basis other than the flavio basis,</span>
<span class="sd">    the translation is performed automatically, if implemented in the</span>
<span class="sd">    `wcxf` package.&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">wcdict</span><span class="o">=</span><span class="n">wc</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">wc</span><span class="o">.</span><span class="n">scale</span><span class="p">,</span> <span class="n">eft</span><span class="o">=</span><span class="n">wc</span><span class="o">.</span><span class="n">eft</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">wc</span><span class="o">.</span><span class="n">basis</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.functions.AwareWilson.set_option">
    <p>def <span class="ident">set_option</span>(</p><p>self, key, value)</p>
    </div>
    

    
  
    <div class="desc"><p>Set the option <code>key</code> (string) to <code>value</code>.</p>
<p>Instance method, affects only current instance.
This will clear the cache.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.AwareWilson.set_option', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.AwareWilson.set_option" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_option</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set the option `key` (string) to `value`.</span>
<span class="sd">    Instance method, affects only current instance.</span>
<span class="sd">    This will clear the cache.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_option_schema</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span><span class="p">}))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">clear_cache</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="flavio.functions.AwareWilson.atuples" class="name">var <span class="ident">atuples</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.functions.AwareWilson.get_initial_wcxf" class="name">var <span class="ident">get_initial_wcxf</span></p>
            

            
  
    <div class="desc"><p>Return a wcxf.WC instance in the flavio basis containing the initial
values of the Wilson coefficients.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.functions.AwareWilson.matching_parameters" class="name">var <span class="ident">matching_parameters</span></p>
            

            
  
    <div class="desc"><p>Parameters to be used for the SMEFT-&gt;WET matching.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="flavio.functions.AwareWilson.parameters" class="name">var <span class="ident">parameters</span></p>
            

            
  
    <div class="desc"><p>Parameters to be used for running and translation.</p></div>
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="flavio.functions.AwareWilson.from_wc">
    <p>def <span class="ident">from_wc</span>(</p><p>cls, wc)</p>
    </div>
    

    
  
    <div class="desc"><p>Return a <code>Wilson</code> instance initialized by a <code>wcxf.WC</code> instance</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.AwareWilson.from_wc', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.AwareWilson.from_wc" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_wc</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">wc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a `Wilson` instance initialized by a `wcxf.WC` instance&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">wcdict</span><span class="o">=</span><span class="n">wc</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">wc</span><span class="o">.</span><span class="n">scale</span><span class="p">,</span> <span class="n">eft</span><span class="o">=</span><span class="n">wc</span><span class="o">.</span><span class="n">eft</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">wc</span><span class="o">.</span><span class="n">basis</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.functions.AwareWilson.from_wilson">
    <p>def <span class="ident">from_wilson</span>(</p><p>cls, w, par_dict)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.AwareWilson.from_wilson', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.AwareWilson.from_wilson" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_wilson</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">par_dict</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">w</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">w</span>
    <span class="n">fwc</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
    <span class="n">fwc</span><span class="o">.</span><span class="n">set_initial_wcxf</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">wc</span><span class="p">)</span>
    <span class="n">fwc</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">_cache</span>
    <span class="n">fwc</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">_options</span>
    <span class="n">_ckm_options</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">par_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Vus&#39;</span><span class="p">,</span> <span class="s1">&#39;Vcb&#39;</span><span class="p">,</span> <span class="s1">&#39;Vub&#39;</span><span class="p">,</span> <span class="s1">&#39;delta&#39;</span><span class="p">]}</span>
    <span class="k">if</span> <span class="n">fwc</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s1">&#39;parameters&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="n">_ckm_options</span><span class="p">:</span>
        <span class="n">fwc</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;parameters&#39;</span><span class="p">,</span> <span class="n">_ckm_options</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fwc</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.functions.AwareWilson.load_wc">
    <p>def <span class="ident">load_wc</span>(</p><p>cls, stream)</p>
    </div>
    

    
  
    <div class="desc"><p>Return a <code>Wilson</code> instance initialized by a WCxf file-like object</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.AwareWilson.load_wc', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.AwareWilson.load_wc" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">load_wc</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">stream</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a `Wilson` instance initialized by a WCxf file-like object&quot;&quot;&quot;</span>
    <span class="n">wc</span> <span class="o">=</span> <span class="n">wcxf</span><span class="o">.</span><span class="n">WC</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_wc</span><span class="p">(</span><span class="n">wc</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="flavio.functions.AwareWilson.set_default_option">
    <p>def <span class="ident">set_default_option</span>(</p><p>cls, key, value)</p>
    </div>
    

    
  
    <div class="desc"><p>Class method. Set the default value of the option <code>key</code> (string)
to <code>value</code> for all future instances of the class.</p>
<p>Note that this does not affect existing instances or the instance
called from.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-flavio.functions.AwareWilson.set_default_option', this);">Show source &equiv;</a></p>
  <div id="source-flavio.functions.AwareWilson.set_default_option" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">set_default_option</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class method. Set the default value of the option `key` (string)</span>
<span class="sd">    to `value` for all future instances of the class.</span>
<span class="sd">    Note that this does not affect existing instances or the instance</span>
<span class="sd">    called from.&quot;&quot;&quot;</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">_default_options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_option_schema</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span><span class="p">}))</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>

    <script>
      renderMathInElement(document.body, options={delimiters:[
  {left: "$$", right: "$$", display: true},
  {left: "\\[", right: "\\]", display: true},
  {left: "\\(", right: "\\)", display: false},
  {left: "$", right: "$", display: false}
]});
    </script>
    <script type="text/javascript">
    $("script[type='math/tex; mode=display']").replaceWith(
      function(){
        var tex = $(this).text();
        return "<span class=\"katex-display\">" +
               katex.renderToString("\\displaystyle "+tex) +
               "</span>";
    });
    </script>

</body>
</html>
